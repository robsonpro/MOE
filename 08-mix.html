<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Robson Bruno Dutra Pereira">

<title>8&nbsp; Experimentos para Misturas – Modelagem e Otimização de Experimentos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./07-rsm.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./08-mix.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Experimentos para Misturas</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Procurar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modelagem e Otimização de Experimentos</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Dists.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Distribuições importantes à modelagem e otimização de Experimentos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-Testes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Testes de hipóteses para média de uma e duas amostras</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Planejamento totalmente aleatorizado e análise de variância para um fator</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-ANOVA_blocos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Planejamento com blocos completos aleatorizados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-fat2k.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fatorial de dois níveis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-fatunrep_frac.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Fatorial de dois níveis não replicado e fracionado</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-rsm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Metodologia de Superfície de Resposta</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-mix.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Experimentos para Misturas</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#introdução" id="toc-introdução" class="nav-link active" data-scroll-target="#introdução"><span class="header-section-number">8.1</span> Introdução</a></li>
  <li><a href="#trabalhando-com-proporções-de-componentes" id="toc-trabalhando-com-proporções-de-componentes" class="nav-link" data-scroll-target="#trabalhando-com-proporções-de-componentes"><span class="header-section-number">8.2</span> Trabalhando com proporções de componentes</a></li>
  <li><a href="#polinômios-canônicos-de-misturas" id="toc-polinômios-canônicos-de-misturas" class="nav-link" data-scroll-target="#polinômios-canônicos-de-misturas"><span class="header-section-number">8.3</span> Polinômios canônicos de misturas</a></li>
  <li><a href="#sistema-de-coordenadas-simplex" id="toc-sistema-de-coordenadas-simplex" class="nav-link" data-scroll-target="#sistema-de-coordenadas-simplex"><span class="header-section-number">8.4</span> Sistema de coordenadas simplex</a></li>
  <li><a href="#planejamento-simplex-lattice" id="toc-planejamento-simplex-lattice" class="nav-link" data-scroll-target="#planejamento-simplex-lattice"><span class="header-section-number">8.5</span> Planejamento simplex-lattice</a></li>
  <li><a href="#planejamento-simplex-centróide" id="toc-planejamento-simplex-centróide" class="nav-link" data-scroll-target="#planejamento-simplex-centróide"><span class="header-section-number">8.6</span> Planejamento simplex-centróide</a></li>
  <li><a href="#planejamento-de-vértices-extremos" id="toc-planejamento-de-vértices-extremos" class="nav-link" data-scroll-target="#planejamento-de-vértices-extremos"><span class="header-section-number">8.7</span> Planejamento de vértices extremos</a></li>
  <li><a href="#bibliografia" id="toc-bibliografia" class="nav-link" data-scroll-target="#bibliografia">Bibliografia</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Experimentos para Misturas</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor</div>
    <div class="quarto-title-meta-contents">
             <p>Robson Bruno Dutra Pereira </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introdução" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="introdução"><span class="header-section-number">8.1</span> Introdução</h2>
<p>Os planejamnetos fatoriais e de superfície de resposta possibilitam a inferência, modelagem e otimização considerando variáveis contínuas ou de processo. Tais variáveis incluem temperatura, pressão, velocidade, entre outras. Em procedimentos experimentais e processos onde deseja-se avaliar o efeito da proporção de dois ou mais componentes (reagentes ou ingredientes) existem planejamentos específicos para não somente avaliar a influência da proporção de cada componente na resposta, mas também visando obter a proporção ótima dos componentes. Tais experimentos são comuns na indústria química, farmacêutica, de alimentos, civil, entre outras. Estes experimentos são chamados de experimentos de misturas. Pretende-se neste capítulo elucidar as particularidades relacionadas a este tipo de experimento, os planejamentos disponíveis e como realizar a modelagem e otimização.</p>
<p>Neste capítulo são utilizados os pacotes <code>mixexp</code>, <code>ggtern</code>, <code>Ternary</code> e <code>NlcOptim</code>, além das funções básicas do R. Recomenda-se a instalação destes utilizando o comando <code>install.packages("&lt;nome_pacote&gt;")</code>. A instalação é realizada uma única vez, porém o pacote deve ser carregado via <code>library(&lt;nome_pacote&gt;)</code> sempre que deseja-se usar suas funções.</p>
</section>
<section id="trabalhando-com-proporções-de-componentes" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="trabalhando-com-proporções-de-componentes"><span class="header-section-number">8.2</span> Trabalhando com proporções de componentes</h2>
<p>Quando trabalhamos com experimentos de misturas tem-se as seguintes restrições:</p>
<p><span class="math display">\[
\begin{align}
&amp;0 \leq x_i \leq 1 \text{, } i=1\dots,q \\
&amp;\sum_{i=1}^q x_i =1,
\end{align}
\]</span></p>
<p>ou seja, obviamente cada um dos <span class="math inline">\(q\)</span> componentes deve ter proporção entre 0 e 1 e a soma da proporção dos <span class="math inline">\(q\)</span> componentes deve ser unitária. Pode-se inferir que <span class="math inline">\(x_j = 1 -\sum_{i \neq j}x_i\)</span>, ou seja, é possível saber a proporção de um componente caso saiba-se a proporção dos <span class="math inline">\(q-1\)</span> remanmescentes. Neste sentido, há uma redundância moderada entre as proporções dos componentes em planejamentos para misturas.</p>
</section>
<section id="polinômios-canônicos-de-misturas" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="polinômios-canônicos-de-misturas"><span class="header-section-number">8.3</span> Polinômios canônicos de misturas</h2>
<p>Nos experimentos de misturas devido as restrições relacionadas à proporção de componentes, os modelos obtidos apresentam características especiais. Seja um modelo linear exposto à seguir.</p>
<p><span class="math display">\[
\begin{align}
\hat y =&amp; \beta_0^* + \beta_1^*x_1 + \beta_2^*x_2 + \dots  + \beta_q^*x_q \\
\hat y =&amp; \beta_0^* + \sum_{i=1}^q \beta_i^*x_i\\
\end{align}
\]</span></p>
<p>Sabendo que <span class="math inline">\(\sum_{i=1}^q x_i =1\)</span>, pode-se fazer o seguinte:</p>
<p><span class="math display">\[
\begin{align}
\hat y =&amp; \beta_0^*\underbrace{\sum_{i=1}^q x_i =1}_1 + \sum_{i=1}^q \beta_i^*x_i \\
\hat y =&amp; \sum_{i=1}^q\underbrace{(\beta_0^* + \beta_i^*)}_{\beta_i}x_i\\
\hat y =&amp; \sum_{i=1}^q \beta_ix_i.
\end{align}
\]</span></p>
<p>Pode-se observar que devido a restrição de soma unitária das proporções o modelo linear pode ser representado sem a constante ou, pode-se dizer que devido a redundância nas proporções dos componentes, o coeficiente <span class="math inline">\(\beta_i\)</span> consiste não somente no efeito linear, mas na constante ou intercepto no vértice <span class="math inline">\(i\)</span>, <span class="math inline">\(i=1,\dots,q\)</span>.</p>
<p>Seja um modelo de segunda ordem completo, conforme segue.</p>
<p><span id="eq-pol1"><span class="math display">\[
\hat y = \beta_0^* + \sum_{i=1}^q \beta_i^* x_i + \sum_{i=1}^q \beta_{ii}^* x_i^2 + \sum_{i &lt; }\sum_j \beta_{ij}^* x_i x_j
\tag{8.1}\]</span></span></p>
<p>Usando <span class="math inline">\(\sum_{i=1}^q x_i =1\)</span> e <span class="math inline">\(x_i^2 = x_i\underbrace{(1 -\sum_{x \neq q}x_i)}_{x_i}\)</span>, obtém-se:</p>
<p><span id="eq-pol2"><span class="math display">\[
\hat y = \sum_{i=1}^q \beta_i x_i + \sum_{i &lt; }\sum_j \beta_{ij} x_i x_j,
\tag{8.2}\]</span></span></p>
<p>onde <span class="math inline">\(\beta_i = \beta_0^* + \beta_j^* + \beta_{jj}^*\)</span> e <span class="math inline">\(\beta_{ij} = \beta_{ij}^* - \beta_{ii}^* - \beta_{jj}^*\)</span>. Logo, dada a redundância nas proporções, um modelo de segunda ordem completo pode ser rezumido a um modelo com termos lineares e de interação. Entretanto, deve-se atentar que em tal modelo o termo linear abrange também a constante e o termo quadrático, enquanto o termo de interação é função dos termos de interação originais e quadráticos.</p>
<p>Em modelos de misturas a multicolineariedade entre os componentes ocasionada pela restrição de soma unitária pode inflar <span class="math inline">\(R^2\)</span> e dar uma impressão errada da capacidade de previsão do modelo. Logo, o coeficiente de determinação múltipla deve ser corrigido considerando o número de termos no modelo conforme <span class="quarto-unresolved-ref">?eq-r2corr</span>, onde <span class="math inline">\(p\)</span> é o número de termos no modelo.</p>
<p><span class="math display">\[
R^2_{corr} = 1 - \biggl(\frac{(1-R^2)(N-1)}{N-p-1} \biggr)
\]</span></p>
</section>
<section id="sistema-de-coordenadas-simplex" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="sistema-de-coordenadas-simplex"><span class="header-section-number">8.4</span> Sistema de coordenadas simplex</h2>
<p>Considerando as restrições relacionadas à proporção de componentes em uma mistura, é importante entender o sistema de coordenadas simplex, utilizado em experimentos para misturas. A <a href="#fig-simplex" class="quarto-xref">Figura&nbsp;<span>8.1</span></a> ilustra o sistema de coordenadas simplex para <span class="math inline">\(q=3\)</span> componentes. O sistema de coordenadas neste caso consiste em um triângulo equilátero com cada um dos vértices representando a proporção máxima de um dos componentes, ou seja, no vértice superior tem-se proporção máxima de <span class="math inline">\(x_1\)</span>, isto é, <span class="math inline">\(x_1=1\)</span> e <span class="math inline">\(x_2=x_3=0\)</span>. No vértice da esquerda tem-se proporção máxima de <span class="math inline">\(x_2\)</span>, enquanto no vértice da direita tem-se proporção máxima de <span class="math inline">\(x_3\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-simplex" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-simplex-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="08-mix_files/figure-html/fig-simplex-1.png" class="img-fluid figure-img" width="499">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simplex-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;8.1: Sistema de coordenadas simplex
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <a href="#fig-simplexpts" class="quarto-xref">Figura&nbsp;<span>8.2</span></a> plota três pontos distintos no sistema de coorenadas simplex para <span class="math inline">\(q=3\)</span>. Seja <span class="math inline">\(\mathbf x = (x_1,x_2,\dots,x_3)\)</span>. Neste caso foram plotados os pontos <span class="math inline">\((0,6;0,2;0,2)\)</span> em vermelho, <span class="math inline">\((0,3;0,6;0,1)\)</span> em azul e <span class="math inline">\((0,4;0,3;0,3)\)</span> em verde. Neste gráfico os vértices e linhas de grade estão identificados em porcentagem.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-simplexpts" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-simplexpts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="08-mix_files/figure-html/fig-simplexpts-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simplexpts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;8.2: Exemplos de misturas no sistema de coordenadas simplex
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="planejamento-simplex-lattice" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="planejamento-simplex-lattice"><span class="header-section-number">8.5</span> Planejamento simplex-lattice</h2>
<p>Um planejamento muito usual para misturas é o planejamento simplex-lattice ou rede simplex. Um planejamento simplex-lattice com <span class="math inline">\(q\)</span> componentes e grau <span class="math inline">\(m\)</span> pode ser denotado SLD(<span class="math inline">\(q\)</span>,<span class="math inline">\(m\)</span>), onde <span class="math inline">\(m\)</span> consiste no grau do polinômio de misturas a ser obtido. Neste planejamento o número total de experimentos para uma réplica pode ser calculado conforme segue:</p>
<p><span class="math display">\[
N=\binom {q+m-1}{m}=\frac{(q+m-1)!}{m!(q-1)!}.
\]</span></p>
<p>Um SLD(3,1) apresentará N = 3 experimentos, sendo representado conforme <a href="#fig-simplex" class="quarto-xref">Figura&nbsp;<span>8.1</span></a>, enquanto um SLD(3,2) apresentará N = 6 experimentos, conforme <a href="#fig-sld32" class="quarto-xref">Figura&nbsp;<span>8.3</span></a>. Os pontos nos vérticies são chamados de misturas puras, enquanto os pontos nas arestas são chamados de misturas binárias. Enquanto um SLD(3,1) permite a obtenção de um modelo na forma da <a href="#eq-pol1" class="quarto-xref">Equação&nbsp;<span>8.1</span></a>, um SLD(3,2) permite a obtenção de modelo na forma da <a href="#eq-pol2" class="quarto-xref">Equação&nbsp;<span>8.2</span></a>. A Tabela <a href="#tbl-sld32" class="quarto-xref">Tabela&nbsp;<span>8.1</span></a> apresenta um SLD(3,2).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-sld32" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sld32-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="08-mix_files/figure-html/fig-sld32-1.png" class="img-fluid figure-img" width="499">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sld32-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;8.3: Planejamento SLD(3,2)
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div id="tbl-sld32" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sld32-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;8.1: Planejamento SLD(3,2)
</figcaption>
<div aria-describedby="tbl-sld32-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">x1</th>
<th style="text-align: right;">x2</th>
<th style="text-align: right;">x3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>É importante observar também que em um planejamento simplex-lattice o grau é o contrário do espaçamento <span class="math inline">\(\delta\)</span> entre os pontos no espaço simplex ou, de forma análoga, <span class="math inline">\(\delta = 1/m\)</span>. Logo, para <span class="math inline">\(m=2\)</span>, <span class="math inline">\(delta = 1/2\)</span>, o que fica claro na <a href="#fig-sld32" class="quarto-xref">Figura&nbsp;<span>8.3</span></a>, uma vez que o comprimento da aresta é unitário. Para finalizar, a <a href="#fig-sld33" class="quarto-xref">Figura&nbsp;<span>8.4</span></a> ilustra um SLD(3,3). Pode-se observar que neste caso N = 10 e <span class="math inline">\(\delta = 1/3\)</span>. O ponto que consiste em proporção de 1/3 para todos os três componentes é chamado de mistura ternária.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-sld33" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sld33-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="08-mix_files/figure-html/fig-sld33-1.png" class="img-fluid figure-img" width="499">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sld33-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;8.4: Planejamento SLD(3,3)
</figcaption>
</figure>
</div>
</div>
</div>
<div id="exm-expsld" class="theorem example">
<p><span class="theorem-title"><strong>Exemplo 8.1</strong></span> Seja um experimento de misturas onde deseja-se otimizar a proporção de fibras naturais como reforço em um compósito. Foram utilizados três tipos de fibra: sisal (x1), juta (x2) e coco (x3). Foi utilizado um planejamento SLD(3,2). A resposta avaliada foi a tensão específica de ruptura e foram realizadas três réplicas.</p>
</div>
<p>A <a href="#tbl-sld32fibras" class="quarto-xref">Tabela&nbsp;<span>8.2</span></a> expõe o planejamento SLD(3,2) com a resposta. O código abaixo é usado para obter tal planejamento. O pacote <code>mixexp</code> é sugerido para análise de experimentos de msituras e o comando <code>SLD</code> é usado para obter um planejamento simplex-lattice.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simplex lattice com q = 3, m = 2</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>plan.simplex <span class="ot">&lt;-</span> <span class="fu">SLD</span>(<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plan.simplex</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Desenho do planejamento</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># DesignPoints(plan.simplex)</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># planejamento foi replicado tres vezes</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>plan.simplex <span class="ot">&lt;-</span> <span class="fu">rbind</span>(plan.simplex,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                      plan.simplex,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                      plan.simplex)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># resposta</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">28.56</span>, <span class="fl">21.73</span>, <span class="fl">26.38</span>, <span class="fl">33.71</span>, <span class="fl">24.22</span>, <span class="fl">22.93</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>       <span class="fl">29.58</span>, <span class="fl">20.98</span>, <span class="fl">25.9</span>, <span class="fl">32.98</span>, <span class="fl">23.98</span>, <span class="fl">21.79</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>       <span class="fl">29.26</span>, <span class="fl">21.23</span>, <span class="fl">26.65</span>, <span class="dv">34</span>, <span class="fl">23.15</span>, <span class="fl">22.17</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>plan.simplex<span class="sc">$</span>SBS <span class="ot">&lt;-</span> y</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div id="tbl-sld32fibras" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sld32fibras-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;8.2: Planejamento SLD(3,2) para o experimento de fibras naturais
</figcaption>
<div aria-describedby="tbl-sld32fibras-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x1</th>
<th style="text-align: right;">x2</th>
<th style="text-align: right;">x3</th>
<th style="text-align: right;">SBS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">28.56</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">21.73</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">26.38</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">33.71</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">24.22</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">22.93</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">29.58</td>
</tr>
<tr class="even">
<td style="text-align: left;">21</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">20.98</td>
</tr>
<tr class="odd">
<td style="text-align: left;">31</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">25.90</td>
</tr>
<tr class="even">
<td style="text-align: left;">41</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">32.98</td>
</tr>
<tr class="odd">
<td style="text-align: left;">51</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">23.98</td>
</tr>
<tr class="even">
<td style="text-align: left;">61</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">21.79</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">29.26</td>
</tr>
<tr class="even">
<td style="text-align: left;">22</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">21.23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">32</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">26.65</td>
</tr>
<tr class="even">
<td style="text-align: left;">42</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">34.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">52</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">23.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">62</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">22.17</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A análise a seguir com o comando <code>MixModel</code> permite a obtenção do modelo completo. Observa-se que apenas o termo <span class="math inline">\(x_2x_3\)</span> não foi significativo e que o ajuste foi excelente. Caso seja usado <code>model = 1</code>, será obtido um modelo com apenas os termos lineares.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>res.comp <span class="ot">&lt;-</span> <span class="fu">MixModel</span>(<span class="at">frame =</span> plan.simplex,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">response =</span> <span class="st">"SBS"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">mixcomps =</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">model =</span> <span class="dv">2</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     
      coefficients   Std.err    t.value         Prob
x1        29.13333 0.2877756 101.236276 0.000000e+00
x2        26.31000 0.2877756  91.425392 0.000000e+00
x3        22.29667 0.2877756  77.479342 0.000000e+00
x2:x1    -25.63333 1.4098069 -18.182159 4.230261e-10
x3:x1     31.39333 1.4098069  22.267825 3.966427e-11
x2:x3     -2.08000 1.4098069  -1.475379 1.658606e-01
     
Residual standard error:  0.498442  on  12 degrees of freedom 
Corrected Multiple R-squared:  0.9908558</code></pre>
</div>
</div>
<p>Caso seja desejado especificar um modelo distinto, por exemplo sem o coeficiente não significativo, pode-se usar o comando <code>lm</code>. É importante suprimir a constante neste caso, com <code>-1</code> na fórmula.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo reduzido</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>res.red <span class="ot">&lt;-</span> <span class="fu">lm</span>(SBS <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x1<span class="sc">*</span>x2 <span class="sc">+</span> x1<span class="sc">*</span>x3,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> plan.simplex)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res.red)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = SBS ~ -1 + x1 + x2 + x3 + x1 * x2 + x1 * x3, data = plan.simplex)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.98000 -0.30917  0.06833  0.37333  0.80667 

Coefficients:
      Estimate Std. Error t value Pr(&gt;|t|)    
x1     29.1333     0.3005   96.94  &lt; 2e-16 ***
x2     26.1367     0.2743   95.27  &lt; 2e-16 ***
x3     22.1233     0.2743   80.64  &lt; 2e-16 ***
x1:x2 -25.2867     1.4516  -17.42 2.15e-10 ***
x1:x3  31.7400     1.4516   21.86 1.23e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5205 on 13 degrees of freedom
Multiple R-squared:  0.9997,    Adjusted R-squared:  0.9996 
F-statistic:  9266 on 5 and 13 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>A <a href="#fig-mixcont" class="quarto-xref">Figura&nbsp;<span>8.5</span></a> ilustra o gráfico de contorno para o modelo reduzido. Observa-se que uma proporção próxima de 0,6 de fibra de sisal e uma proporção próxima de 0,4 para fibra de coco maximiza a resistência do compósito. O gráfico foi obtido via comando <code>TernaryPlot</code> da biblioteca <code>Ternary</code>, porém poderia ser obtido via <code>ModelPlot</code> da biblioteca <code>mixexp</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># contour plot</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ModelPlot(model = res.red,</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#           dimensions = list(x1 = "x1", </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                             x2 = "x2",</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                             x3 = "x3"),</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#           contour = T,</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#           fill = T,</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#           axislabs = c("sisal", "juta", "coco"),</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#           color.palette = cm.colors,</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#           colorkey = T)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ternary)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">rep</span>(<span class="fl">0.2</span>, <span class="dv">4</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">TernaryPlot</span>(<span class="at">alab =</span> <span class="st">"sisal"</span>, <span class="at">blab =</span> <span class="st">"juta"</span>, <span class="at">clab =</span> <span class="st">"coco"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>FunctionToContour <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, c) {</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  yhat <span class="ot">&lt;-</span> <span class="fu">predict</span>(res.red, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x1=</span>a,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">x2=</span>b,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">x3=</span>c))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(yhat)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 29.133*sisal + 26.1367*juta + 22.1233*coco - </span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   25.2867*x1*x2 + 31.7400*x1*x3</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Add contour lines</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>values <span class="ot">&lt;-</span> <span class="fu">TernaryContour</span>(FunctionToContour, </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>                         <span class="co"># resolution = 36L, </span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">filled =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>zRange <span class="ot">&lt;-</span> <span class="fu">range</span>(values<span class="sc">$</span>z, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Continuous legend for colour scale</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>PlotTools<span class="sc">::</span><span class="fu">SpectrumLegend</span>(</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"topleft"</span>,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">round</span>(<span class="fu">seq</span>(zRange[<span class="dv">1</span>], zRange[<span class="dv">2</span>], <span class="at">length.out =</span> <span class="dv">4</span>), <span class="dv">3</span>),</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> <span class="fu">hcl.colors</span>(<span class="dv">265</span>, <span class="at">palette =</span> <span class="st">"viridis"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>),</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">"n"</span>,    <span class="co"># No framing box</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">inset =</span> <span class="fl">0.02</span>,</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">xpd =</span> <span class="cn">NA</span>      <span class="co"># Do not clip at edge of figure</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mixcont" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mixcont-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="08-mix_files/figure-html/fig-mixcont-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mixcont-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;8.5: Gráfico de contorno para o exprimento de misturas de fibras naturais
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <a href="#fig-mixeff" class="quarto-xref">Figura&nbsp;<span>8.6</span></a> expõe o gráfico de efeitos para o experimento de misturas de fibras naturais. Observa-se que o eixo x apresenta-se em desvio do centróide que seria o centro do sistema de coordenadas simplex. Aumentando a proporção de <span class="math inline">\(x_1\)</span> aumenta a resistência mecânica do compósito. Aumentando a proporção de <span class="math inline">\(x_2\)</span> até em torno de pouco menos que 0,2 a mais que o centróide aumenta a resistência mecânica. Já para <span class="math inline">\(x_2\)</span> a redução deste maximiza a resistência do material. Obviamente, deve-se pensar que aumentar um componente implica em reduzir ao menos um dos demais. O comando <code>ModelEff</code> tem duas opções Piepel ou Cox em <code>dir=1</code> ou <code>dir=2</code>, respectivamente. Para mais detalhes ver Cornell (2011).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafico de efeitos</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ModelEff</span>(<span class="at">nfac =</span> <span class="dv">3</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">mod =</span> <span class="dv">2</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">dir =</span> <span class="dv">2</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">nproc =</span> <span class="dv">0</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">ufunc =</span> res.comp)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mixeff" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mixeff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="08-mix_files/figure-html/fig-mixeff-1.png" class="img-fluid figure-img" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mixeff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;8.6: Gráfico de efeitos para o exprimento de misturas de fibras naturais
</figcaption>
</figure>
</div>
</div>
</div>
<p>Apesar de neste caso o gráfico de contorno exposto na <a href="#fig-mixcont" class="quarto-xref">Figura&nbsp;<span>8.5</span></a> auxiliar na definição das proporções ótimas, na maioria dos casos, especialmente onde <span class="math inline">\(q \geq 4\)</span>, é importante realizar a otimização restrita, conforme <a href="#eq-mixopt" class="quarto-xref">Equação&nbsp;<span>8.3</span></a>. Neste procedimento deseja-se minimizar o modelo polinomial de misturas sujeito as restrições de proporção e soma unitária das proporções. A maioria dos pacotes de otimização são implementados para minimização, de forma que, caso seja desejado a maximização da função, conforme o exemplo de misturas de fibras, pode-se minimizar o negativo e depois multiplicar o resultado obtido por menos 1.</p>
<p><span id="eq-mixopt"><span class="math display">\[
\begin{align}
\min_{\mathbf x} &amp; \{\hat y = \sum_{i=1}^q \beta_i x_i + \sum_{i &lt; j} \beta_{ij} x_i x_j\} \\
\textrm{s.t.: } &amp; 0 \leq x_i \leq 1 \text{, } i = 1,\dots,q \\
                &amp; \sum_{i=1}^q x_i =1 \\
\end{align}
\tag{8.3}\]</span></span></p>
<p>Para otimização de modelos polinomiais de misturas quadráticos pode-se usar métodos de programação não-linear, como a programação sequencial quadrática. O pacote <code>NlcOptim</code> tem a função <code>solnl</code> que considera este método. A seguir expõe-se a implementação do procedimento para otimização. Deve-se defirnir a função objetivo. Neste caso sugere-se usar o artifício de colocar a função <code>predict</code> disponível para modelos <code>lm</code> em uma função via <code>function</code>. Deve-se definir a restrição igualdade (<code>ceq</code>) nula, na forma <span class="math inline">\(\sum x_i - 1\)</span>. Já as proporções são definidas via limites inferiores (<em>lower bound</em> - <code>lb</code>) e superiores (<em>upper bound</em> - <code>ub</code>) em 0 e 1, respectivamente, para todos os componentes da mistura.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NlcOptim)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="do">### Otimizacao nao linear restrita</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Funcao objetivo</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  y_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(res.red, </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> x[<span class="dv">1</span>],</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">x2 =</span> x[<span class="dv">2</span>],</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">x3 =</span> x[<span class="dv">3</span>]))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span>y_hat)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># restricao de espaco experimental</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>cons_eq <span class="ot">&lt;-</span> <span class="cf">function</span>(x){ </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> x[<span class="dv">1</span>] <span class="sc">+</span> x[<span class="dv">2</span>] <span class="sc">+</span> x[<span class="dv">3</span>] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">ceq =</span> g, <span class="at">c =</span> <span class="cn">NULL</span>))</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co"># x inicial</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Teste funcao objetivo e restricao</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co"># obj(x0)</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co"># cons_eq(x0)</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="co"># otimizacao</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>Opt <span class="ot">&lt;-</span> <span class="fu">solnl</span>(<span class="at">X =</span> x0,</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">objfun =</span> obj,</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">confun =</span> cons_eq,</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">lb =</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>), </span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">ub =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A seguir expõe-se o código para se obter as proporções ótimas dos componentes. Sugere-se 0,61 de fibra de sisal e 0,39 de fibra de coco.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proporcoes otimas</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>Opt<span class="sc">$</span>par</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              [,1]
[1,]  6.104285e-01
[2,] -6.384098e-13
[3,]  3.895715e-01</code></pre>
</div>
</div>
<p>Por fim, obtém-se o valor ótimo previsto da resposta conforme segue. Neste caso a mistura ótima de fibras possibilitaria a obtenção de um compósito com tensão específica de ruptura de 33,95 MPa.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># resposta otima</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span>Opt<span class="sc">$</span>fn</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
33.95039 </code></pre>
</div>
</div>
<p>Para modelos de ordem maior sugere-se usar algoritmo genético ou outro método metaheurístico populacional, de forma a viabilizar uma busca não dependente do gradiente, uma vez que ainda serão considerados modelos de ordem maior que os quadráticos, dificultando a otimização via métodos não lineares.</p>
</section>
<section id="planejamento-simplex-centróide" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="planejamento-simplex-centróide"><span class="header-section-number">8.6</span> Planejamento simplex-centróide</h2>
<p>Um planejamento simplex-centróide é outra opção interessante para experimentos de misturas. Este planejamento pode ser denotado por SCD(<span class="math inline">\(q\)</span>), onde <span class="math inline">\(q\)</span> consiste ao mesmo tempo no número de componentes e na ordem do modelo possível de ser obtido. Um planejamento simplex centróide de ordem <span class="math inline">\(q\)</span> apresentará:</p>
<ul>
<li><p><span class="math inline">\(\binom {q}{1}\)</span> misturas puras;</p></li>
<li><p><span class="math inline">\(\binom {q}{2}\)</span> misturas binárias;</p></li>
<li><p><span class="math inline">\(\binom {q}{3}\)</span> misturas ternárias;</p></li>
<li><p><span class="math inline">\(\vdots\)</span></p></li>
<li><p><span class="math inline">\(\binom {q}{q} = 1\)</span> mistura de ordem <span class="math inline">\(q\)</span>.</p></li>
</ul>
<p>Logo, um planejamento simplex-centróide apresentará <span class="math inline">\(N=2^q-1\)</span> experimentos. A <a href="#fig-scd3" class="quarto-xref">Figura&nbsp;<span>8.7</span></a> ilustra um planejamento simplex-centróide para <span class="math inline">\(q=3\)</span>, SCD(3). Pode-se observar que ele contém 7 pontos, 3 misturas puras, que são os experimentos com proporção unitária de cada componente ilustrados nos vértices do planejamento, 2 misturas binárias que são combinações dois a dois com metade de cada um dos componentes envolvidos ilustrados no meio das arestas e uma mistura ternária que apresenta um terço de cada um dos três componentes, sendo ilustrada no centro do planejamento. O planejamento é exposto integralmente na <a href="#tbl-scd3" class="quarto-xref">Tabela&nbsp;<span>8.3</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-scd3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scd3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="08-mix_files/figure-html/fig-scd3-1.png" class="img-fluid figure-img" width="499">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scd3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;8.7: Planejamento SCD(3)
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div id="tbl-scd3" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-scd3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;8.3: Planejamento SCD(3)
</figcaption>
<div aria-describedby="tbl-scd3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">x1</th>
<th style="text-align: right;">x2</th>
<th style="text-align: right;">x3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.0000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.5000000</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.5000000</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.3333333</td>
<td style="text-align: right;">0.3333333</td>
<td style="text-align: right;">0.3333333</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A <a href="#eq-polscd" class="quarto-xref">Equação&nbsp;<span>8.4</span></a> apresenta o polinômio geral que pode ser obtido via SCD(<span class="math inline">\(q\)</span>). Por exemplo, para <span class="math inline">\(q=2\)</span>, só é possível obter um modelo de segunda ordem. Já para <span class="math inline">\(q=3\)</span> é possível obter o modelo exibido antes das reticências, enquanto para <span class="math inline">\(q\geq4\)</span> mais termos são adicionados, um para cada componente adicional considerado.</p>
<p><span id="eq-polscd"><span class="math display">\[
\hat y = \sum_{i=1}^q \beta_i x_i + \sum_{i &lt; }\sum_j \beta_{ij} x_i x_j +  \sum_{i &lt; }\sum_j\sum_l \beta_{ijl}x_ix_jx_l + \dots
\tag{8.4}\]</span></span></p>
<div id="exm-expsld" class="theorem example">
<p><span class="theorem-title"><strong>Exemplo 8.2</strong></span> Seja um experimento de mistura para obter um biodiesel a base de óleo vegetal e gordura animal. Os componentes da mistura são óleo de soja, sebo bovino e gordura de aves. A resposta é o período de indução no ensaio, de forma que um valor maior resulta em maior resistência à oxidação. Foi utilizado um SCD(3) para o estudo.</p>
</div>
<p>A <a href="#tbl-scd3biodiesel" class="quarto-xref">Tabela&nbsp;<span>8.4</span></a> expõe o planejamento SCD(3) com a resposta. O código abaixo é usado para obter tal planejamento. O comando <code>SCD</code> é usado para obter o planejamento.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simplex centroide, q = 3</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>plan.centroide <span class="ot">&lt;-</span> <span class="fu">SCD</span>(<span class="dv">3</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># replicando ponto central</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>plan.centroide <span class="ot">&lt;-</span> <span class="fu">rbind</span>(plan.centroide,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                        plan.centroide[<span class="dv">7</span>,],</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                        plan.centroide[<span class="dv">7</span>,],</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                        plan.centroide[<span class="dv">7</span>,])</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co"># desenho planejamento</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># DesignPoints(plan.centroide)</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Resposta</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>IP <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">3.76</span>, <span class="fl">9.57</span>, <span class="fl">9.77</span>, <span class="fl">8.19</span>, <span class="fl">7.92</span>, <span class="fl">12.92</span>,</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>        <span class="fl">10.04</span>, <span class="fl">9.27</span>, <span class="fl">10.07</span>, <span class="fl">9.35</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co"># adicionando resposta ao planejamento</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>plan.centroide<span class="sc">$</span>y <span class="ot">&lt;-</span> IP</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div id="tbl-scd3biodiesel" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-scd3biodiesel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;8.4: Planejamento SCD(3) para o experimento de biodiesel
</figcaption>
<div aria-describedby="tbl-scd3biodiesel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x1</th>
<th style="text-align: right;">x2</th>
<th style="text-align: right;">x3</th>
<th style="text-align: right;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">3.76</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">9.57</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">9.77</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">8.19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">7.92</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">12.92</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: right;">0.3333333</td>
<td style="text-align: right;">0.3333333</td>
<td style="text-align: right;">0.3333333</td>
<td style="text-align: right;">10.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">71</td>
<td style="text-align: right;">0.3333333</td>
<td style="text-align: right;">0.3333333</td>
<td style="text-align: right;">0.3333333</td>
<td style="text-align: right;">9.27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">72</td>
<td style="text-align: right;">0.3333333</td>
<td style="text-align: right;">0.3333333</td>
<td style="text-align: right;">0.3333333</td>
<td style="text-align: right;">10.07</td>
</tr>
<tr class="even">
<td style="text-align: left;">73</td>
<td style="text-align: right;">0.3333333</td>
<td style="text-align: right;">0.3333333</td>
<td style="text-align: right;">0.3333333</td>
<td style="text-align: right;">9.35</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A seguir expõe-se a sintaxe para modelagem e o modelo cúbico obtido. Os três termos lineares foram signifcativos além do termo de segunda ordem <span class="math inline">\(x_2x_3\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>res.centroide <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> (x1<span class="sc">+</span>x2<span class="sc">+</span>x3)<span class="sc">^</span><span class="dv">3</span>, plan.centroide)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res.centroide)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ -1 + (x1 + x2 + x3)^3, data = plan.centroide)

Residuals:
         1          2          3          4          5          6          7 
-2.776e-17  1.388e-17 -1.388e-17 -1.628e-17 -7.786e-18 -2.637e-17  3.575e-01 
        71         72         73 
-4.125e-01  3.875e-01 -3.325e-01 

Coefficients:
         Estimate Std. Error t value Pr(&gt;|t|)    
x1         3.7600     0.4315   8.713 0.003182 ** 
x2         9.5700     0.4315  22.176 0.000201 ***
x3         9.7700     0.4315  22.640 0.000189 ***
x1:x2      6.1000     2.1141   2.885 0.063250 .  
x1:x3      4.6200     2.1141   2.185 0.116764    
x2:x3     13.0000     2.1141   6.149 0.008652 ** 
x1:x2:x3 -17.6325    10.9278  -1.614 0.205028    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4315 on 3 degrees of freedom
Multiple R-squared:  0.9994,    Adjusted R-squared:  0.9979 
F-statistic: 669.6 on 7 and 3 DF,  p-value: 8.779e-05</code></pre>
</div>
</div>
<p>Para obter o mesmo modelo via <code>MixModel</code> é importante definir o modelo com o argumento <code>model = 4</code>, sendo este o quarto tipo de modelo definido pelo autor do pacote para a função, não tendo relação com a ordem do modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># res.cent &lt;- MixModel(frame = plan.centroide,</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                      response = "y",</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                      mixcomps = c("x1", "x2", "x3"),</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                      model = 4)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A <a href="#fig-mixcont2" class="quarto-xref">Figura&nbsp;<span>8.8</span></a> expõe o gráfico de contorno para o experimento de biodiesel obtida com sintaxe exibida abaixo. Observa-se que aproximadamente metade de sebo bovino e metade de gordura de aves na mistura acarreta no biodiesel com maior resistência à corrosão.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">rep</span>(<span class="fl">0.2</span>, <span class="dv">4</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TernaryPlot</span>(<span class="st">"x1"</span>,<span class="st">"x2"</span>,<span class="st">"x3"</span>, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="at">alab =</span> <span class="st">"óleo de soja"</span>, </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="at">blab =</span> <span class="st">"sebo bovino"</span>, </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="at">clab =</span> <span class="st">"gordura de aves"</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>FunctionToContour <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, c) {</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  yhat <span class="ot">&lt;-</span> <span class="fu">predict</span>(res.centroide, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x1=</span>a,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">x2=</span>b,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">x3=</span>c))</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(yhat)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Add contour lines</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>values <span class="ot">&lt;-</span> <span class="fu">TernaryContour</span>(FunctionToContour, </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>                         <span class="co"># resolution = 36L, </span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">filled =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>zRange <span class="ot">&lt;-</span> <span class="fu">range</span>(values<span class="sc">$</span>z, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Continuous legend for colour scale</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>PlotTools<span class="sc">::</span><span class="fu">SpectrumLegend</span>(</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"topleft"</span>,</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">round</span>(<span class="fu">seq</span>(zRange[<span class="dv">1</span>], zRange[<span class="dv">2</span>], <span class="at">length.out =</span> <span class="dv">4</span>), <span class="dv">3</span>),</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> <span class="fu">hcl.colors</span>(<span class="dv">265</span>, <span class="at">palette =</span> <span class="st">"viridis"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>),</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">"n"</span>,    <span class="co"># No framing box</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">inset =</span> <span class="fl">0.02</span>,</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">xpd =</span> <span class="cn">NA</span>      <span class="co"># Do not clip at edge of figure</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mixcont2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mixcont2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="08-mix_files/figure-html/fig-mixcont2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mixcont2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;8.8: Gráfico de contorno para o experimento de biodiesel
</figcaption>
</figure>
</div>
</div>
</div>
<p>O código a seguir é utilizado para otimização. Pode-se confirmar que <span class="math inline">\(x_2 = 0,492\)</span> e <span class="math inline">\(x_3 = 0,508\)</span> são as proporções ótimas dos componentes e 12,92 seria o valor ótimo da resposta prevista.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Funcao objetivo</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  y_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(res.centroide,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> x[<span class="dv">1</span>],</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">x2 =</span> x[<span class="dv">2</span>],</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">x3 =</span> x[<span class="dv">3</span>]))</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span>y_hat) <span class="co"># maximizacao</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># restricao</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>cons_eq <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> x[<span class="dv">1</span>]<span class="sc">+</span>x[<span class="dv">2</span>]<span class="sc">+</span>x[<span class="dv">3</span>]<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">ceq =</span> g, <span class="at">c =</span> <span class="cn">NULL</span>))</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co"># x inicial</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Otimizacao</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>Opt <span class="ot">&lt;-</span> <span class="fu">solnl</span>(<span class="at">X =</span> x0,</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">objfun =</span> obj,</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">confun =</span> cons_eq,</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">lb =</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>),</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">ub =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="co"># proporcoes otimas</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>Opt<span class="sc">$</span>par</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              [,1]
[1,] -6.758037e-16
[2,]  4.923077e-01
[3,]  5.076923e-01</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resposta</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span>Opt<span class="sc">$</span>fn</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
12.92077 </code></pre>
</div>
</div>
</section>
<section id="planejamento-de-vértices-extremos" class="level2" data-number="8.7">
<h2 data-number="8.7" class="anchored" data-anchor-id="planejamento-de-vértices-extremos"><span class="header-section-number">8.7</span> Planejamento de vértices extremos</h2>
<p>Em muitos experimentos de misturas não é possível realizar misturas puras, ou de outra forma, para o experimento dar certo é necessário que todos componentes estejam envolvidos na mistura. Por exemplo, para fazer massa artesanal é necessário farinha, ovos, água e sal. Não seria viável uma massa sem farinha. Para fazer reboco sugere-se usar argamassa, cal, cimento e aditivo. A ausência de um dos componentes pode deixar o reboco mais fraco ou com consistência inadequada para aplicação. Obviamente que nestes exemplos os profssionais da área já sabem a composição ótima da mistura. Porém, em casos onde deseja-se trabalhar experimentos de mistura com restrições nos componentes, deve-se usar o planejamento de vértices extremos.</p>
<p>O planejamento de vértices extremos pode ser usado quando um ou mais componentes apresentam limites nas proporções diferentes de 0 e/ou 1, isto é:</p>
<p><span class="math display">\[
l_i \leq x_i \leq u_i \text{, } i=1,\dots,q,
\]</span></p>
<p>com <span class="math inline">\(l_i &gt;0\)</span> e <span class="math inline">\(u_i &lt; 1\)</span>. Um primeiro caso do planejamento de vértices extremos seria aquele com limite inferior apenas, <span class="math inline">\(l_i \leq x_i \leq 1\)</span>, <span class="math inline">\(i=1,\dots,q\)</span>. Por exemplo, suponha um experimento de misturas com as seguintes restrições:</p>
<p><span class="math display">\[
\begin{cases}
x_1 \geq 0,3\\
x_2 \geq 0,4\\
x_3 \geq 0,1.
\end{cases}                                                     
\]</span></p>
<p>A <a href="#fig-extver1" class="quarto-xref">Figura&nbsp;<span>8.9</span></a> ilustra tais restrições no espaço simplex, com <span class="math inline">\(x_1 \geq 0,3\)</span> em vermelho, <span class="math inline">\(x_2 \geq 0,4\)</span> em azul e <span class="math inline">\(x_3 \geq 0,1\)</span> em verde. Observe que neste tipo de experimento a região continua consistindo em um triângulo equilátero - para <span class="math inline">\(q=3\)</span>, logo, em uma região simplex. Porém, os vértices não são mais misturas puras. Na imagem observa-se que o vértice em laranja consiste em <span class="math inline">\((0,5;0,4;0,1)\)</span>, enquanto o vértice em roxo consiste em <span class="math inline">\((0,3;0,6;0,1)\)</span> e o vértice em verde consiste em <span class="math inline">\((0,3;0,4;0,3)\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-extver1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-extver1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="08-mix_files/figure-html/fig-extver1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-extver1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;8.9: Região restrita no planejamento de misturas com <span class="math inline">\(x_1 \geq 0,3\)</span>, <span class="math inline">\(x_2 \geq 0,4\)</span> e <span class="math inline">\(x_1 \geq 0,1\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<p>É possível descrever os componentes de forma codificada como pseudo componentes, de forma que os novos vértices seriam misturas puras neste simplex codificado. Usando a <a href="#eq-pseudocomp" class="quarto-xref">Equação&nbsp;<span>8.5</span></a> obtém-se a proporção do pseudo-componente.</p>
<p><span id="eq-pseudocomp"><span class="math display">\[
X_i = \frac{x_i-l_i}{1-\sum_{i=1}^q l_i}
\tag{8.5}\]</span></span></p>
<p>Quando o experimento apresenta apenas limites superiores, <span class="math inline">\(0 \leq x_i \leq u_i\)</span>, <span class="math inline">\(i=1,\dots,q\)</span>, há dois casos possíveis. Seja um experimento de misturas com as seguintes restrições:</p>
<p><span class="math display">\[
\begin{cases}
x_1 \leq 0,4\\
x_2 \leq 0,5\\
x_3 \leq 0,3.
\end{cases}                                                     
\]</span></p>
<p>A <a href="#fig-extver2" class="quarto-xref">Figura&nbsp;<span>8.10</span></a> ilustra tal caso. Pode-se observar que a região restrita consiste em um simplex invertido. Observa-se neste caso a restrição <span class="math inline">\(x_1 \leq 0,4\)</span> em vermelho, <span class="math inline">\(x_2 \leq 0,5\)</span> em azul e <span class="math inline">\(x_3 \leq 0,3\)</span> em verde. São gerados os vértices <span class="math inline">\((0,2;0,5;0,3)\)</span> em verde, <span class="math inline">\((0,4;0,5;0,1)\)</span> em roxo e <span class="math inline">\((0,4;0,3;0,3)\)</span> em laranja. Para saber se um experimento de misturas apresentará região simplex invertida, basta fazer <span class="math inline">\(\sum u_i - min\{u_i\}\)</span>. Caso o resultado seja menor que 1, tem-se um simplex invertido. Para o exemplo, <span class="math inline">\(0,4+0,5+0,3-0,3 = 0,9\)</span>. Logo, confirma-se o observado na Figura.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-extver2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-extver2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="08-mix_files/figure-html/fig-extver2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-extver2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;8.10: Região restrita no planejamento de misturas com <span class="math inline">\(x_1 \leq 0,4\)</span>, <span class="math inline">\(x_2 \leq 0,5\)</span> e <span class="math inline">\(x_1 \leq 0,3\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Seja um segundo caso com apenas limites superiores, conforme segue:</p>
<p><span class="math display">\[
\begin{cases}
x_1 \leq 0,7\\
x_2 \leq 0,5\\
x_3 \leq 0,8.
\end{cases}                                                     
\]</span></p>
<p>A <a href="#fig-extver3" class="quarto-xref">Figura&nbsp;<span>8.11</span></a> ilustra tal região restrita. Pode-se observar que neste caso a região não é um simplex. Sugere-se ao leitor identificar as restrições definidas em cores distintas e também os vértices gerados. Observa-se que neste caso foram gerados seis vértices. Sempre que <span class="math inline">\(\sum u_i - min\{u_i\} &gt; 1\)</span>, tem-se uma região experimental não triangular e o número de vértices dependerá das restrições.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-extver3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-extver3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="08-mix_files/figure-html/fig-extver3-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-extver3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;8.11: Região restrita no planejamento de misturas com <span class="math inline">\(x_1 \leq 0,7\)</span>, <span class="math inline">\(x_2 \leq 0,5\)</span> e <span class="math inline">\(x_1 \leq 0,8\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<p>O planejamento de vértices extremos sempre considera, além dos pontos nos vértices, os quais dependem das restrições, um ponto central ou centróide que também dependerá das restrições e da região gerada. Para casos nos quais deseja-se modelos de ordem maior, pode-se considerar também pontos intermediários nas arestas geradas segundo as restrições. Deve-se recordar que a ordem do polinômio de misturas depende do número de pontos. Para modelos de segunda ordem na forma da <a href="#eq-pol2" class="quarto-xref">Equação&nbsp;<span>8.2</span></a> é necessário no mínimo <span class="math inline">\(q + q(q-1)/2\)</span> experimentos. A <a href="#fig-extverplan" class="quarto-xref">Figura&nbsp;<span>8.12</span></a> ilustra o planejamento com as restrições do último exemplo. Neste caso o centróide gerado consiste em <span class="math inline">\((0,35;0,25;0,4)\)</span> e o planejamento fica com <span class="math inline">\(N=7\)</span> experimentos. O número de experimentos dependerá das restrições e se são considerados ou não os pontos intermediários nas arestas. Obviamente há casos onde são considerados limites inferiores e superiores dos componentes.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-extverplan" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-extverplan-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="08-mix_files/figure-html/fig-extverplan-1.png" class="img-fluid figure-img" width="499">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-extverplan-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;8.12: Planejamento de vértices extremos com restrições <span class="math inline">\(x_1 \leq 0,7\)</span>, <span class="math inline">\(x_2 \leq 0,5\)</span> e <span class="math inline">\(x_1 \leq 0,8\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<div id="exm-extver" class="theorem example">
<p><span class="theorem-title"><strong>Exemplo 8.3</strong></span> Seja um experimento de mistura para o desenvolvimento de filmes de amido de mandioca e quitosana. Além de amido (<span class="math inline">\(x_1\)</span>) e quitosana (<span class="math inline">\(x_2\)</span>), há na mistura glicerol (<span class="math inline">\(x_3\)</span>). São consideradas as seguintes restrições: <span class="math inline">\(0,7 \leq x_1 \leq 0,82\)</span>, <span class="math inline">\(0 \leq x_2 \leq 0,05\)</span> e <span class="math inline">\(0,18 \leq x_3 \leq 0,25\)</span>. A resposta medida é o módulo de Young.</p>
</div>
<p>A <a href="#tbl-xvert" class="quarto-xref">Tabela&nbsp;<span>8.5</span></a> expõe o planejamento com a resposta. O código abaixo é usado para obter tal planejamento com o comando <code>Xvert</code> do pacote <code>mixexp</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">Xvert</span>(<span class="at">nfac =</span> <span class="dv">3</span>, </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">lc =</span> <span class="fu">c</span>(<span class="fl">0.70</span>, <span class="fl">0.00</span>, <span class="fl">0.18</span>),</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">uc =</span> <span class="fu">c</span>(<span class="fl">0.82</span>, <span class="fl">0.05</span>, <span class="fl">0.25</span>), </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">ndm =</span> <span class="dv">1</span>, <span class="at">plot =</span> F)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">rbind</span>(design, design[<span class="dv">9</span>,], design[<span class="dv">9</span>,])</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Resposta</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>ym <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.45</span>, <span class="fl">0.85</span>, <span class="fl">2.54</span>, <span class="fl">1.08</span>, <span class="fl">1.97</span>, <span class="fl">2.06</span>, <span class="fl">2.71</span>, <span class="fl">0.99</span>, <span class="fl">1.33</span>, <span class="fl">1.38</span>, <span class="fl">1.53</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>design<span class="sc">$</span>y <span class="ot">&lt;-</span> ym</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div id="tbl-xvert" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-xvert-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;8.5: Planejamento de vértices extremos para o experimento de filmes de amido de mandioca e quitosana
</figcaption>
<div aria-describedby="tbl-xvert-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x1</th>
<th style="text-align: right;">x2</th>
<th style="text-align: right;">x3</th>
<th style="text-align: right;">dimen</th>
<th style="text-align: right;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.820</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.180</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2.45</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.700</td>
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.85</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.770</td>
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">0.180</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2.54</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.750</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">0.785</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.215</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.97</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">0.735</td>
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">0.215</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: right;">0.795</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.180</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.71</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: right;">0.725</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.250</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.99</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: right;">0.760</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.215</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.33</td>
</tr>
<tr class="even">
<td style="text-align: left;">91</td>
<td style="text-align: right;">0.760</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.215</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.38</td>
</tr>
<tr class="odd">
<td style="text-align: left;">92</td>
<td style="text-align: right;">0.760</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.215</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1.53</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A seguir expõe-se a sintaxe para modelagem e resultado obtido. Seguiu-se o modelo considerado pelos autores do trabalho com apenas dois termos de segunda ordem. Entretanto, apenas os termos lineares de <span class="math inline">\(x_1\)</span> e <span class="math inline">\(x_3\)</span> foram significativos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>res.xvert <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> (x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3)<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> x1<span class="sc">:</span>x3, design)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res.xvert)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ -1 + (x1 + x2 + x3)^2 - x1:x3, data = design)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.2580 -0.1267 -0.0580  0.1677  0.3253 

Coefficients:
      Estimate Std. Error t value Pr(&gt;|t|)    
x1       6.236      1.008   6.189 0.000819 ***
x2     385.799    233.487   1.652 0.149553    
x3     -14.240      3.643  -3.909 0.007904 ** 
x1:x2 -379.200    243.612  -1.557 0.170576    
x2:x3 -470.628    282.828  -1.664 0.147167    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2514 on 6 degrees of freedom
Multiple R-squared:  0.9897,    Adjusted R-squared:  0.9811 
F-statistic: 115.2 on 5 and 6 DF,  p-value: 7.102e-06</code></pre>
</div>
</div>
<p>A <a href="#fig-contxvert" class="quarto-xref">Figura&nbsp;<span>8.13</span></a> expõe o gráfico de contorno do modelo obtido com código abaixo. Este foi plotado em pseudo componentes para facilitar a visualização.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ModelPlot</span>(<span class="at">model =</span> res.xvert,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">dimensions =</span> <span class="fu">list</span>(<span class="at">x1 =</span> <span class="st">"x1"</span>,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x2 =</span> <span class="st">"x2"</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x3 =</span> <span class="st">"x3"</span>),</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">constraints =</span> T,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">lims =</span> <span class="fu">c</span>(<span class="fl">0.70</span>, <span class="fl">0.82</span>, <span class="fl">0.00</span>, <span class="fl">0.05</span>, <span class="fl">0.18</span>, <span class="fl">0.25</span>),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">pseudo =</span> T,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">contour =</span> T, </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> T,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">color.palette =</span> terrain.colors,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">colorkey =</span> T,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">axislab.offset =</span> <span class="fl">0.1</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-contxvert" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-contxvert-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="08-mix_files/figure-html/fig-contxvert-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-contxvert-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;8.13: Gráfico de contorno para o experimento de filmes de amido de mandioca e quitosana
</figcaption>
</figure>
</div>
</div>
</div>
<p>A seguir expõe-se a sintaxe para otimização com o resultado obtido. Neste caso considerou-se a minimização do módulo de Young para obter filmes mais flexíveis. Sugere-se <span class="math inline">\((0.72, 0.03, 0.25)\)</span> para obter <span class="math inline">\(\hat y = 0,783\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Funcao objetivo</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  y_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(res.xvert,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> x[<span class="dv">1</span>],</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">x2 =</span> x[<span class="dv">2</span>],</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">x3 =</span> x[<span class="dv">3</span>]))</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y_hat) <span class="co"># min</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># restricao</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>cons_eq <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> x[<span class="dv">1</span>]<span class="sc">+</span>x[<span class="dv">2</span>]<span class="sc">+</span>x[<span class="dv">3</span>]<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">ceq =</span> g, <span class="at">c =</span> <span class="cn">NULL</span>))</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="co"># x inicial</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.76</span>,<span class="fl">0.025</span>,<span class="fl">0.215</span>)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Otimizacao</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>Opt <span class="ot">&lt;-</span> <span class="fu">solnl</span>(<span class="at">X =</span> x0,</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">objfun =</span> obj,</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">confun =</span> cons_eq,</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">lb =</span> <span class="fu">c</span>(<span class="fl">0.7</span>,<span class="dv">0</span>,<span class="fl">0.18</span>),</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">ub =</span> <span class="fu">c</span>(<span class="fl">0.82</span>,<span class="fl">0.05</span>,<span class="fl">0.25</span>))</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a><span class="co"># proporcoes otimas</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>Opt<span class="sc">$</span>par</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
[1,] 0.72034106
[2,] 0.02965894
[3,] 0.25000000</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>        1 
0.7831026 </code></pre>
</div>
</div>
</section>
<section id="bibliografia" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="bibliografia">Bibliografia</h2>
<p>CORNELL, John A. <em>A primer on experiments with mixtures</em>. John Wiley &amp; Sons, 2011.</p>
<p>CORNELL, John A. <em>Experiments with mixtures: designs, models, and the analysis of mixture data</em>. Wiley-interscience, 2002. 3rd edition.</p>
<p>DAS, Dipayan; MUKHOPADHYAY, Samrat; KAUR, Harpreet. Optimization of fiber composition in natural fiber-reinforced composites using a simplex lattice design. <em>Journal of composite materials</em>, v. 46, n.&nbsp;26, p.&nbsp;3311-3319, 2012.</p>
<p>ORIVES, Juliane Resges et al.&nbsp;Multiresponse optimisation on biodiesel obtained through a ternary mixture of vegetable oil and animal fat: Simplex-centroid mixture design application. <em>Energy Conversion and Management</em>, v. 79, p.&nbsp;398-404, 2014.</p>
<p>PELISSARI, Franciele M. et al.&nbsp;Constrained mixture design applied to the development of cassava starch–chitosan blown films. <em>Journal of Food Engineering</em>, v. 108, n.&nbsp;2, p.&nbsp;262-267, 2012.</p>
<p>SCHEFFÉ, Henry. Experiments with mixtures. <em>Journal of the Royal Statistical Society: Series B (Methodological)</em>, v. 20, n.&nbsp;2, p.&nbsp;344-360, 1958.</p>
<p>SCHEFFE, Henry. The simplex‐centroid design for experiments with mixtures. <em>Journal of the Royal Statistical Society: Series B (Methodological)</em>, v. 25, n.&nbsp;2, p.&nbsp;235-251, 1963.</p>
<p>SNEE, Ronald D. Experimental designs for quadratic models in constrained mixture spaces. <em>Technometrics</em>, v. 17, n.&nbsp;2, p.&nbsp;149-159, 1975.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./07-rsm.html" class="pagination-link" aria-label="Metodologia de Superfície de Resposta">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Metodologia de Superfície de Resposta</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>
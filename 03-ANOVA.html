<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Robson Bruno Dutra Pereira">

<title>3&nbsp; Planejamento totalmente aleatorizado e análise de variância para um fator – Modelagem e Otimização de Experimentos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-ANOVA_blocos.html" rel="next">
<link href="./02-Testes.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-ANOVA.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Planejamento totalmente aleatorizado e análise de variância para um fator</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Procurar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modelagem e Otimização de Experimentos</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Dists.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Distribuições importantes à modelagem e otimização de Experimentos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-Testes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Testes de hipóteses para média de uma e duas amostras</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-ANOVA.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Planejamento totalmente aleatorizado e análise de variância para um fator</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-ANOVA_blocos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Planejamento com blocos completos aleatorizados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-fat2k.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fatorial de dois níveis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-fatunrep_frac.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Economia na experimentação e busca de região de curvatura via Fatorial 2^k</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-rsm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Metodologia de Superfície de Resposta</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-mix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Experimentos para Misturas</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#introdução" id="toc-introdução" class="nav-link active" data-scroll-target="#introdução"><span class="header-section-number">3.1</span> Introdução</a></li>
  <li><a href="#análise-de-variância-para-um-fator" id="toc-análise-de-variância-para-um-fator" class="nav-link" data-scroll-target="#análise-de-variância-para-um-fator"><span class="header-section-number">3.2</span> Análise de variância para um fator</a>
  <ul class="collapse">
  <li><a href="#testes-de-comparações-múltiplas" id="toc-testes-de-comparações-múltiplas" class="nav-link" data-scroll-target="#testes-de-comparações-múltiplas"><span class="header-section-number">3.2.1</span> Testes de comparações múltiplas</a></li>
  <li><a href="#poder-do-teste-na-anova" id="toc-poder-do-teste-na-anova" class="nav-link" data-scroll-target="#poder-do-teste-na-anova"><span class="header-section-number">3.2.2</span> Poder do teste na ANOVA</a></li>
  </ul></li>
  <li><a href="#bibliografia" id="toc-bibliografia" class="nav-link" data-scroll-target="#bibliografia">Bibliografia</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Planejamento totalmente aleatorizado e análise de variância para um fator</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor</div>
    <div class="quarto-title-meta-contents">
             <p>Robson Bruno Dutra Pereira </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introdução" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="introdução"><span class="header-section-number">3.1</span> Introdução</h2>
<p>Quando deseja-se testar a diferença entre médias para três ou mais amostras ou tratamentos, deve-se utilizar a análise de variância (ANOVA). A presença de três ou mais tratamentos é comum em diversos estudos experimentais, tornando a análise de variância umas das técnicas mais importantes em inferência estatística. Este tipo de estudo é geralmente planejado usando o planejamento totalmente aleatorizado.</p>
<p>Existem diversos tipos de ANOVA, considerando o número de fatores em avaliação, efeitos fixos ou aleatórios, etc. Neste primeiro momento será abordada a ANOVA para um fator ou ANOVA de uma via (<em>one-way</em>) com modelo de efeitos fixos.</p>
<p>Neste capítulo são utilizados os pacotes <code>dplyr</code> e <code>ggpplot2</code>, além das funções básicas do R. Recomenda-se a instalação destes utilizando o comando <code>install.packages("&lt;nome_pacote&gt;")</code>. A instalação é realizada uma única vez, porém o pacote deve ser carregado via <code>library(&lt;nome_pacote&gt;)</code> sempre que deseja-se usar suas funções.</p>
</section>
<section id="análise-de-variância-para-um-fator" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="análise-de-variância-para-um-fator"><span class="header-section-number">3.2</span> Análise de variância para um fator</h2>
<p>Seja o conjunto geral de dados resumido na <a href="#tbl-anovadata" class="quarto-xref">Tabela&nbsp;<span>3.1</span></a>. Neste conjunto tem-se <span class="math inline">\(a\)</span> tratamentos de interesse e <span class="math inline">\(n\)</span> observações ou replicações experimentais em cada tratamento. De forma geral, cada observação pode ser denotada como <span class="math inline">\(y_{ij}\)</span>, com <span class="math inline">\(i = 1, ..., a\)</span> e <span class="math inline">\(j = 1, ..., n\)</span>.</p>
<div id="tbl-anovadata" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anovadata-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;3.1: Dados de um experimento com <span class="math inline">\(a\)</span> tratamentos e <span class="math inline">\(n\)</span> observações em cada tratamento
</figcaption>
<div aria-describedby="tbl-anovadata-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Tratamentos</th>
<th>Observações</th>
<th>Somas</th>
<th>Médias</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><span class="math inline">\(y_{11}\)</span>, <span class="math inline">\(y_{12}\)</span>, …, <span class="math inline">\(y_{1n}\)</span></td>
<td><span class="math inline">\(y_{1.} = \sum_{j=1}^{n}{y_{1j}}\)</span></td>
<td><span class="math inline">\(\bar{y}_{1.} = y_{1.}/n\)</span></td>
</tr>
<tr class="even">
<td>2</td>
<td><span class="math inline">\(y_{21}\)</span>, <span class="math inline">\(y_{22}\)</span>, …, <span class="math inline">\(y_{2n}\)</span></td>
<td><span class="math inline">\(y_{2.} = \sum_{j=1}^{n}{y_{2j}}\)</span></td>
<td><span class="math inline">\(\bar{y}_{2.} = y_{2.}/n\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="even">
<td>a</td>
<td><span class="math inline">\(y_{a1}\)</span>, <span class="math inline">\(y_{a2}\)</span>, …, <span class="math inline">\(y_{an}\)</span></td>
<td><span class="math inline">\(y_{a.} = \sum_{j=1}^{n}{y_{aj}}\)</span></td>
<td><span class="math inline">\(\bar{y}_{a.} = y_{a.}/n\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Ainda na <a href="#tbl-anovadata" class="quarto-xref">Tabela&nbsp;<span>3.1</span></a> é importante obter os totais e as médias de cada tratamento, <span class="math inline">\(y_{i.}\)</span> e <span class="math inline">\(\bar{y}_{i.}\)</span>, <span class="math inline">\(i = 1, ..., a\)</span>, para facilitar os cálculos necessários à análise.</p>
<p>Cada observação experimental <span class="math inline">\(y_{ij}\)</span> pode ser discriminada conforme o modelo apresentado na <a href="#eq-anovamodel" class="quarto-xref">Equação&nbsp;<span>3.1</span></a>, o modelo de efeitos fixos da ANOVA. Neste modelo a média geral ou grande média denotada <span class="math inline">\(\mu\)</span> e calculada conforme a <a href="#eq-medg" class="quarto-xref">Equação&nbsp;<span>3.2</span></a>. O efeito de cada tratamento <span class="math inline">\(\alpha_{i}\)</span> consiste na diferença entre médias do tratamento e a média geral, <span class="math inline">\(i = 1, ..., a\)</span>, segundo <a href="#eq-eftrat" class="quarto-xref">Equação&nbsp;<span>3.3</span></a>. Por fim, o termo de erro <span class="math inline">\(\varepsilon_{ij}\)</span> consiste na diferença entre cada observação e a média dentro do seu tratamento, <span class="math inline">\(i = 1, ..., a\)</span>, <span class="math inline">\(j = 1, ..., n\)</span>, conforme <a href="#eq-erroanova" class="quarto-xref">Equação&nbsp;<span>3.4</span></a>. Sobre o termo de erro residem as hipóteses de que este seja normalmente e independentemente distribuído com média nula e variância <span class="math inline">\(\sigma^2_\varepsilon\)</span>, ou seja, <span class="math inline">\(\varepsilon_{ij} \sim N(0,\sigma^2_\varepsilon)\)</span>.</p>
<p>A média logicamente pode variar de tratamento para tratamento, sendo esta hipotética variação testada estatísticamente. Já a variância dentro dos tratamentos é assumida constante.</p>
<p><span id="eq-anovamodel"><span class="math display">\[
y_{ij} = \mu + \alpha_{i} + \varepsilon_{ij}
\tag{3.1}\]</span></span> <span id="eq-medg"><span class="math display">\[
\mu = \bar{y}_{..} = \frac{
\displaystyle\sum_{i=1}^{a}
\displaystyle\sum_{j=1}^{n}{y_{ij}}}{an}
\tag{3.2}\]</span></span> <span id="eq-eftrat"><span class="math display">\[
\alpha_{i} = \bar{y}_{i.} - \bar{y}_{..}
\tag{3.3}\]</span></span> <span id="eq-erroanova"><span class="math display">\[
\varepsilon_{ij} = y_{ij} - \bar{y}_{i.}
\tag{3.4}\]</span></span></p>
<p>Este modelo é chamado de modelo de efeitos fixos, com cada efeito dentro dos tratamentos a ser estimado fixo porém desconhecido. Este tipo de modelo é o mais comum na análise de variância, sendo utilizado quando deseja-se conhecer apenas o efeito dos tratamentos considerados. No caso onde se selecionam de forma aleatória <span class="math inline">\(a\)</span> tratamentos de uma ampla população, desejando-se conhecer o efeito para toda população de origem, deve-se utilizar um modelo de efeitos aleatórios.</p>
<p>As hipóteses testadas na análise de variância são relacionadas aos efeito dos tratamentos e de forma análoga à média destes. A hipótese nula consiste na nulidade dos efeitos, enquanto a hipótese alternativa sugere que ao menos um dos efeitos é não nulo ou, de outra forma, ao menos uma média dos tratamentos é distinta dos demais. As hipóteses são formuladas à seguir.</p>
<p><span class="math display">\[
H_0: \alpha_1= \alpha_2 = ... = \alpha_a = 0
\]</span> <span class="math display">\[
H_0: \alpha_i \ne 0, \text{para ao menos um } i
\]</span></p>
<p>A análise de variância é um teste para diferença entre médias baseado no particionamento da soma dos quadrados total, na soma dos quadrados entre tratamentos e na soma dos quadrados dentro dos tratamentos, conforme <a href="#eq-vartotal" class="quarto-xref">Equação&nbsp;<span>3.6</span></a>. A variância total das observações experimentais da <a href="#tbl-anovadata" class="quarto-xref">Tabela&nbsp;<span>3.1</span></a> é expressa conforme Equação <a href="#eq-vartotal" class="quarto-xref">Equação&nbsp;<span>3.6</span></a>. O numerador do cálculo, <span class="math inline">\(SS_T\)</span>, é a soma dos quadrados total, enquanto o denominador, <span class="math inline">\(DF_T\)</span>, consiste nos graus de liberdade total.</p>
<p><span id="eq-sigmatotal"><span class="math display">\[
s_T^2 = s_{Entre}^2 + s_{Dentro}^2
\tag{3.5}\]</span></span> <span id="eq-vartotal"><span class="math display">\[
s_T^2 = \frac{SS_T}{DF_T} =  \frac{\displaystyle\sum_{i=1}^{a}
\displaystyle\sum_{j=1}^{n}({y_{ij}-\bar{y}_{..}})^2}{an-1}
\tag{3.6}\]</span></span></p>
<p>Tomando a soma dos quadrados total, <span class="math inline">\(SS_T\)</span>, é possível particioná-la na soma dos quadrados entre os tratamentos, <span class="math inline">\(SS_{Trat}\)</span>, e na soma dos quadrados dentro dos tratamentos, <span class="math inline">\(SS_{Erro}\)</span>, conforme a <a href="#eq-identanova" class="quarto-xref">Equação&nbsp;<span>3.7</span></a>. Pode-se observar que a soma dos quadrados dos tratamentos e a soma dos quadrados dos erros são as somas dos quadrados dos efeitos expostos nas <a href="#eq-eftrat" class="quarto-xref">Equação&nbsp;<span>3.3</span></a> e <a href="#eq-erroanova" class="quarto-xref">Equação&nbsp;<span>3.4</span></a>, respectivamente. Na <a href="#tbl-anovadata" class="quarto-xref">Tabela&nbsp;<span>3.1</span></a> estas quantidades estão relacionados à variabilidade entre as linhas e dentro das linhas.</p>
<p><span id="eq-identanova"><span class="math display">\[
\underbrace{\displaystyle\sum_{i=1}^{a}
\displaystyle\sum_{j=1}^{n}({y_{ij}-\bar{y}_{..}})^2}_{SS_T}=
\underbrace{n\displaystyle\sum_{i=1}^{a}
({\bar{y}_{i.}-\bar{y}_{..}})^2}_{SS_{Trat}}+
\underbrace{\displaystyle\sum_{i=1}^{a}
\displaystyle\sum_{j=1}^{n}({y_{ij}-\bar{y}_{i.}})^2}_{SS_{Erro}}
\tag{3.7}\]</span></span></p>
<p>Os graus de liberdade dos tratamentos estão relacionados ao número de tratamentos em estudo, <span class="math inline">\(DF_{Trat} = a-1\)</span>. Tomando a razão entre a soma dos quadrados e os graus de liberdade dos tratamentos, conforme <a href="#eq-mstrat" class="quarto-xref">Equação&nbsp;<span>3.8</span></a> tem-se a média dos quadrados dos tratamentos, <span class="math inline">\(MS_{Trat}\)</span>. Esta medida é a estimativa da variância entre os tratamentos, <span class="math inline">\(\sigma_{Trat}^2=MS_{Trat}\)</span>. Quanto maior esta medida, maior a diferença entre médias dos tratamentos. Entretanto, esta diferença deve ser avaliada relativamente à variância dentro dos tratamentos, isto é, em relação à variância experimental.</p>
<p><span id="eq-mstrat"><span class="math display">\[
MS_{Trat} =  \frac{n\displaystyle\sum_{i=1}^{a}
({\bar{y}_{i.}-\bar{y}_{..}})^2}{a-1}
\tag{3.8}\]</span></span></p>
<p>Os graus de liberdade dos erros devem ser avaliados com mais cuidado. Para o i-ésimo tratamento a i-ésima variância é calculada conforme a <a href="#eq-ivar" class="quarto-xref">Equação&nbsp;<span>3.9</span></a>. Combinando todas as variâncias dos <span class="math inline">\(a\)</span> tratamentos, tem-se o resultado da <a href="05-fat2k.html#eq-mse" class="quarto-xref">Equação&nbsp;<span>5.8</span></a>. A média dos quadrados dos erros, <span class="math inline">\(MS_E\)</span>, é a estimativa da variância experimental na ANOVA, <span class="math inline">\(\sigma_\varepsilon^2=MS_E\)</span>. As médias dos quadrados são distribuídas pela distribuição <span class="math inline">\(\chi^2\)</span>, por constarem de somas de desvios quadráticos em relação à média, isto é, soma dos quadrados de quantidades distribuídas pela normal-padrão <span class="math inline">\(Z\)</span>.</p>
<p><span id="eq-ivar"><span class="math display">\[
s_i^2 =  \frac{\displaystyle\sum_{j=1}^{n}({y_{ij}-\bar{y}_{i.}})^2}{n-1}
\tag{3.9}\]</span></span> <span id="eq-mse"><span class="math display">\[
MS_E =  \frac{\displaystyle\sum_{i=1}^{a}\displaystyle\sum_{j=1}^{n}({y_{ij}-\bar{y}_{i.}})^2}{a(n-1)}
\tag{3.10}\]</span></span></p>
<p>A estatística do teste ANOVA, <span class="math inline">\(F_0\)</span>, é calculada conforme <a href="#eq-fanova" class="quarto-xref">Equação&nbsp;<span>3.11</span></a>, como a razão entre as médias dos quadrados dos tratamentos e dos erros. Quanto maior esta razão, maior a diferença entre os efeitos, relativamente ao erro experimental. Como esta quantidade consiste na razão entre médias dos quadrados, isto é, entre estimativas de variâncias ela é distribuída pela distribuição <span class="math inline">\(F\)</span>, <span class="math inline">\(F_0 \sim F_{(a-1,a(n-1))}\)</span>. A hipótese <span class="math inline">\(H_0\)</span> de nulidade e igualdade dos efeitos é rejeitada se <span class="math inline">\(F_0 &gt; F_{(\alpha,a-1,a(n-1))}\)</span>. A <a href="#tbl-resanova" class="quarto-xref">Tabela&nbsp;<span>3.2</span></a> resume os cálculos da ANOVA. Geralmente os resultados obtidos via ANOVA são apresentados neste formato.</p>
<p><span id="eq-fanova"><span class="math display">\[
F_0 =  \frac{MS_{Trat}}{MS_{Erro}}
\tag{3.11}\]</span></span></p>
<div id="tbl-resanova" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-resanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;3.2: Tabela resumo ANOVA
</figcaption>
<div aria-describedby="tbl-resanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Fonte</th>
<th>DF</th>
<th>SS</th>
<th>MS</th>
<th><span class="math inline">\(F_0\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tratamentos</td>
<td><span class="math inline">\(a-1\)</span></td>
<td><span class="math inline">\(SS_{Trat}\)</span></td>
<td><span class="math inline">\(SS_{Trat}/(a-1)\)</span></td>
<td><span class="math inline">\(F_0 = MS_{Trat}/MS_{Erro}\)</span></td>
</tr>
<tr class="even">
<td>Erro</td>
<td><span class="math inline">\(a(n-1)\)</span></td>
<td><span class="math inline">\(SS_{Erro}\)</span></td>
<td><span class="math inline">\(SS_{Erro}/[a(n-1)]\)</span></td>
<td>-</td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(an - 1\)</span></td>
<td><span class="math inline">\(SS_{T}\)</span></td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Existem algumas medidas de ajuste usadas para averiguar a efetividade do modelo obtido via ANOVA. O coeficiente de determinação simples <span class="math inline">\(R^2\)</span> é calculado conforme a <a href="#eq-R2" class="quarto-xref">Equação&nbsp;<span>3.12</span></a>, como a razão entre a soma dos quadrados dos tratamentos e a soma dos quadrados total. Esta medida deve ser usada com cautela, por não levar em consideração o número de graus de liberdade do modelo. neste sentido, o coeficiente de determinação ajustado <span class="math inline">\(R_{aj}^2\)</span> é obtido conforme a <a href="#eq-R2aj" class="quarto-xref">Equação&nbsp;<span>3.13</span></a>, sendo uma medida mais adequada para mensurar a variabilidade dos dados explicado pelo modelo ANOVA.</p>
<p><span id="eq-R2"><span class="math display">\[
R^2 = \frac{SS_{Trat}}{SS_T}
\tag{3.12}\]</span></span> <span id="eq-R2aj"><span class="math display">\[
R_{aj}^2 = 1 - \frac{MS_{Trat}}{SS_T/(an-1)}
\tag{3.13}\]</span></span></p>
<p>A ANOVA para um fator considerando três ou mais tratamentos é comumente chamada de ANOVA de uma via. Para conduzir este tipo de análise, deve-se utilizar o chamado planejamento totalmente aleatorizado ou delineamento inteiramente casualizado. Neste planejamento todas as <span class="math inline">\(N = an\)</span> observações experimentais são conduzidas em ordem e alocação de materiais totalmente aleatória. A aleatorização auxilia na garantia das hipóteses de normalidade e independência dos resíduos. Ao aleatorizar os experimentos garante-se que fontes externas incontroláveis de variação, chamadas de variáveis de ruídos, tenham interferência mínima ou ao menos tenham efeito diluído de forma aleatória nos resultados experimentais. As replicações viabilizam a estimativa do erro experimental. Sem a replicação não é possível testar a significância dos efeitos avaliados, visto que estes são sempre avaliados relativamente ao erro experimental.</p>
<div id="exm-anova1" class="theorem example">
<p><span class="theorem-title"><strong>Exemplo 3.1 (Efeito do método de resfriamento na microdureza da zirconia)</strong></span> Um estudo foi realizado para o efeito do método de resfriamento na microdureza da porcelana de zircônia para próteses dentárias. Três métodos de resfriamento foram testados. lento: as amostras são deixadas dentro do forno fechado e desligado até atingirem a temperatura ambiente; normal: as amostras são removidas e resfriadas à temperatura ambiente; e rápido: as amostras são imediatamente removidas do forno após o tempo de espera e jateadas por ar comprimido. Os resultados são apresentados na <a href="#tbl-plananova" class="quarto-xref">Tabela&nbsp;<span>3.3</span></a>.</p>
</div>
<div class="cell">
<div id="tbl-plananova" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-plananova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;3.3: Planejamento totalmente aleatorizado para microdureza HV em [GPa] em função do método de resfriamento de cerâmicas de zirconia
</figcaption>
<div aria-describedby="tbl-plananova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">ordem</th>
<th style="text-align: left;">cooling</th>
<th style="text-align: right;">hardness</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: left;">slow</td>
<td style="text-align: right;">5.34</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: left;">slow</td>
<td style="text-align: right;">5.43</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12</td>
<td style="text-align: left;">slow</td>
<td style="text-align: right;">5.42</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: left;">slow</td>
<td style="text-align: right;">5.40</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">slow</td>
<td style="text-align: right;">5.38</td>
</tr>
<tr class="even">
<td style="text-align: right;">15</td>
<td style="text-align: left;">normal</td>
<td style="text-align: right;">5.20</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: left;">normal</td>
<td style="text-align: right;">5.22</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: left;">normal</td>
<td style="text-align: right;">5.15</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td style="text-align: left;">normal</td>
<td style="text-align: right;">5.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: left;">normal</td>
<td style="text-align: right;">5.24</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: left;">fast</td>
<td style="text-align: right;">5.20</td>
</tr>
<tr class="even">
<td style="text-align: right;">11</td>
<td style="text-align: left;">fast</td>
<td style="text-align: right;">5.15</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">fast</td>
<td style="text-align: right;">5.19</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">fast</td>
<td style="text-align: right;">5.17</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">fast</td>
<td style="text-align: right;">5.18</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Para obter este planejamento pode-se utilizar o código à seguir no R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Valores experimentais de dureza</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>hardness <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.34</span>, <span class="fl">5.43</span>, <span class="fl">5.42</span>, <span class="fl">5.40</span>, <span class="fl">5.38</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>              <span class="fl">5.20</span>, <span class="fl">5.22</span>, <span class="fl">5.15</span>, <span class="fl">5.25</span>, <span class="fl">5.24</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>              <span class="fl">5.20</span>, <span class="fl">5.15</span>, <span class="fl">5.19</span>, <span class="fl">5.17</span>, <span class="fl">5.18</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordem de condução dos ensaios</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>) <span class="co"># para "controlar" a aleatorização</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># seq é utilizado para obter uma sequencia</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># sample com o argumento replace = FALSE para aleatorização</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>random <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="at">size =</span> <span class="dv">15</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Definindo tratamentos</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>cooling <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"slow"</span>,<span class="st">"normal"</span>,<span class="st">"fast"</span>),<span class="at">each=</span><span class="dv">5</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Tratamentos como fatores</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>cooling <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(cooling)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># reunindo os dados em um data.frame</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>plan <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(random, cooling, hardness)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para realizar a análise é utilizado o comando <code>aov()</code>. Pelos resultados, como <span class="math inline">\(F_0 = 62,84 &gt; 3,89 = F_{(0,05;2;12)}\)</span>, ou como <span class="math inline">\(p-value = 4,38 \times 10^{-7} &lt; 0,05 = \alpha\)</span>, rejeita-se <span class="math inline">\(H_0\)</span>. Deste modo, há ao menos um dos tratamentos com efeito diferente, de forma que há influência do tipo de resfriamento na microdureza. A estatística de ajuste <span class="math inline">\(R_{aj}^2=0,898\)</span>, garante que a maior parte da variabilidade dos dados é explicada pelo efeito dos tratamentos e não pelo erro experimental.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA para dureza em função do resfriamento</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>res.anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(hardness <span class="sc">~</span> cooling, <span class="at">data =</span> plan)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res.anova)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df  Sum Sq Mean Sq F value   Pr(&gt;F)    
cooling      2 0.13489 0.06745   62.84 4.38e-07 ***
Residuals   12 0.01288 0.00107                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#F para  0,05 de significância</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>F_critico <span class="ot">&lt;-</span> <span class="fu">qf</span>(.<span class="dv">95</span>, <span class="at">df1=</span><span class="dv">2</span>, <span class="at">df2=</span><span class="dv">12</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>F_critico</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.885294</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo linear associado à ANOVA</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Importante para obter as medidas de ajuste - R^2</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(hardness <span class="sc">~</span> cooling, <span class="at">data =</span> plan)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm1)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = hardness ~ cooling, data = plan)

Residuals:
   Min     1Q Median     3Q    Max 
-0.062 -0.013  0.006  0.024  0.038 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    5.17800    0.01465 353.411  &lt; 2e-16 ***
coolingnormal  0.03400    0.02072   1.641    0.127    
coolingslow    0.21600    0.02072  10.425 2.28e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.03276 on 12 degrees of freedom
Multiple R-squared:  0.9128,    Adjusted R-squared:  0.8983 
F-statistic: 62.84 on 2 and 12 DF,  p-value: 4.384e-07</code></pre>
</div>
</div>
<p>A <a href="#fig-Fcritico" class="quarto-xref">Figura&nbsp;<span>3.1</span></a> ilustra a região crítica do teste, com regão de rejeição de <span class="math inline">\(H_0\)</span> destacada em vermelho.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-Fcritico" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Fcritico-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-ANOVA_files/figure-html/fig-Fcritico-1.png" class="img-fluid figure-img" width="288">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Fcritico-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;3.1: Região crítica ANOVA, <span class="math inline">\(\alpha = 0,05, DF1 = 2, DF2 = 12\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Para testar as pressuposições de normalidade e homocedasticidade pode-se utilizar os blocos de código à seguir. Para ambos os testes obteve-se <span class="math inline">\(p-value &gt; \alpha\)</span>, não havendo indícios para rejeição da hipótese nula <span class="math inline">\(H_0\)</span>, implicando na normalidade dos resíduos e na igualdade de variâncias dos tratamentos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraindo resíduos</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>residuos <span class="ot">&lt;-</span> res.anova<span class="sc">$</span>residuals</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Teste de normalidade dos resíduos</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(residuos)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuos
W = 0.92867, p-value = 0.2607</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Teste de homocedasticidade</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(hardness <span class="sc">~</span> cooling, <span class="at">data =</span> plan)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  hardness by cooling
Bartlett's K-squared = 1.831, df = 2, p-value = 0.4003</code></pre>
</div>
</div>
<p>A <a href="#fig-resianova" class="quarto-xref">Figura&nbsp;<span>3.2</span></a>, obtida com sintaxe à seguir, ilustra alguns gráficos dos resíduos que auxiliam na visualização das pressuposições da ANOVA. O gráfico superior esquerdo plota os resíduos <span class="math inline">\(\varepsilon_{ij}\)</span> em relação aos valores previstos ou ajustados (<em>fitted</em>), <span class="math inline">\(\hat{y}_i=\mu+\alpha_i=\bar{y}_{i.}\)</span>. Um padrão de aleatoriedade, sem crescimento ou decrescimento de <span class="math inline">\(\varepsilon_{ij}\)</span> em função de <span class="math inline">\(\hat{y}_i\)</span> deve ser observado. Para o caso estudado não há indícios de dependência entre resíduos e valores ajustados. O gráfico superior direito é o gráfico quantil-quantil que plota os resíduos ordenados em função dos quantis teóricos da normal padrão. Quanto mais próximo da reta, melhor os resíduos se ajustam à distribuição normal. O gráfico inferior esquerdo plota a raiz quadrada dos resíduos padronizados em função dos valores ajustados. Este é um auxílio para ver, além da independência entre resíduos e ajustados, a homocedasticidade. No caso estudado, já confirmado estatísticamente, visualiza-se a homogeneidade da raiz dos resíduos padronizados em relação às médias dos tratamentos. O último gráfico, plotado no canto inferior direito, plota os resíduos em função dos níveis (tratamentos) experimentais. Deve-se averiguar por este gráfico a homogeneidade e independência dos resíduos em função dos níveis, além da possível presença de <em>outliers</em>, isto é, de valores discrepantes. Em caso de um ajuste baixo, isto é, um <span class="math inline">\(R_{aj}^2\)</span> insuficiente, alguns experimentos com resíduos extremos destacados neste gráfico poderiam ser repetidos. No caso estudado não seria necessário.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># painel de 2 linhas e 2 colunas de gráficos</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># gráficos dos resíduos </span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res.anova)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-resianova" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-resianova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-ANOVA_files/figure-html/fig-resianova-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-resianova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;3.2: Gráficos de resíduos para ANOVA, dureza ~ resfriamento
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <a href="#fig-bpanova" class="quarto-xref">Figura&nbsp;<span>3.3</span></a> apresenta gráficos de caixa ou <em>box-plot</em> da dureza em função do tipo de resfriamento, com código relacionado à seguir. O resfriamento lento garante maior microdureza da cerâmica.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Box-plot</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plan, <span class="fu">aes</span>(<span class="at">x =</span> cooling, <span class="at">y =</span> hardness, <span class="at">color =</span> cooling)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adicionar boxplot</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adicionar pontos com jitter para visualizar distribuição dos dados</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adicionar títulos aos eixos</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Resfriamento"</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Dureza [GPa]"</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remover legenda que seria redundante</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bpanova" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bpanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-ANOVA_files/figure-html/fig-bpanova-1.png" class="img-fluid figure-img" width="288">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bpanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;3.3: Boxplot para dureza em função do método de resfriamento
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <a href="#fig-efeitosanova" class="quarto-xref">Figura&nbsp;<span>3.4</span></a> apresenta gráficos de médias com intervalos de confiança. Ao rejeitar a hipótese nula através da ANOVA, o analista apenas constata que há ao menos um efeito distinto dos demais, em conformidade com a hipótese alternativa <span class="math inline">\(H_1\)</span>. Entretanto, pode ser desejado investigar as diferenças específicas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Primeiro, vamos calcular a média e o intervalo de confiança para cada grupo</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> plan <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cooling) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_hardness =</span> <span class="fu">mean</span>(hardness),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cálculo do intervalo de confiança de 95%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_lower =</span> mean_hardness <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="fu">n</span>()<span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sd</span>(hardness)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_upper =</span> mean_hardness <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="fu">n</span>()<span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sd</span>(hardness)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>())</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Agora criar o gráfico com ggplot2</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adicionar os pontos individuais com jitter</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> plan, </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> cooling, <span class="at">y =</span> hardness), </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adicionar linha conectando as médias</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> resumo, </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> cooling, <span class="at">y =</span> mean_hardness, <span class="at">group =</span> <span class="dv">1</span>), </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adicionar pontos para as médias</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> resumo, </span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> cooling, <span class="at">y =</span> mean_hardness), </span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adicionar barras de erro para o intervalo de confiança</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> resumo, </span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> cooling, </span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin =</span> ci_lower, </span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> ci_upper),</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adicionar títulos aos eixos</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Resfriamento"</span>,</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Dureza [GPa]"</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-efeitosanova" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-efeitosanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-ANOVA_files/figure-html/fig-efeitosanova-1.png" class="img-fluid figure-img" width="288">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-efeitosanova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;3.4: Gráfico de médias (ou de efeitos) para a dureza em função do método de resfriamento
</figcaption>
</figure>
</div>
</div>
</div>
<section id="testes-de-comparações-múltiplas" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="testes-de-comparações-múltiplas"><span class="header-section-number">3.2.1</span> Testes de comparações múltiplas</h3>
<p>Posteriormente à ANOVA pode-se utilizar de testes de comparação de médias, ou de comparações múltiplas para testar as diferenças específicas. Nestes tipo de teste todas as comparações aos pares são realizadas entre as médias dos <span class="math inline">\(a\)</span> tratamentos testados na ANOVA. A hipótese nula de cada comparação é sempre <span class="math inline">\(H_0:\mu_i = \mu_j\)</span>. Um teste bastante utilizado é o teste de Tukey HSD (<em>honestly significant difference</em>), por apresentar um bom controle da probabilidade de erro do tipo I. Entretanto, este teste é conhecido por apresentar alta probabilidade de erro do tipo II (baixo poder do teste). Outras opções disponíveis para comparações múltiplas como os testes de Duncan, teste t, teste de Newman-Keuls, teste t-bayesiano, entre outros.</p>
<p>O código à seguir pode ser utilizado para realizar o teste de Tukey. Pode-se confirmar que o resfriamento lento é diferente do resfriamento normal e do resfriamento rápido, enquanto estes dois não são estatísticamente diferentes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Teste de Tukey</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(res.anova)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = hardness ~ cooling, data = plan)

$cooling
             diff        lwr       upr     p adj
normal-fast 0.034 -0.0212791 0.0892791 0.2670508
slow-fast   0.216  0.1607209 0.2712791 0.0000006
slow-normal 0.182  0.1267209 0.2372791 0.0000040</code></pre>
</div>
</div>
</section>
<section id="poder-do-teste-na-anova" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="poder-do-teste-na-anova"><span class="header-section-number">3.2.2</span> Poder do teste na ANOVA</h3>
<p>É possível obter o poder do teste para ANOVA com o comando <code>power.anova.test</code>, conforme sintaxe à seguir. Pode-se observar que o poder foi unitário, o que já era esperado, uma vez que rejeitou-se a hipótese nula pela ANOVA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Power and sample size ANOVA</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">power.anova.test</span>(<span class="at">groups =</span> <span class="dv">3</span>, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">n =</span> <span class="dv">5</span>, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">between.var =</span> <span class="fl">0.06745</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">within.var =</span> <span class="fl">0.00107</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sig.level =</span> <span class="fl">0.05</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Balanced one-way analysis of variance power calculation 

         groups = 3
              n = 5
    between.var = 0.06745
     within.var = 0.00107
      sig.level = 0.05
          power = 1

NOTE: n is number in each group</code></pre>
</div>
</div>
<p>Caso o experimentador deseje encontrar o número de réplicas adequado para um determinado poder do teste antes de planejar seu experimento, deve-se ter uma estimativa de <span class="math inline">\(SS_{Trat}\)</span> e <span class="math inline">\(SS_{Erro}\)</span>, o que geralmente é difícil de conseguir, especialmente quando não se tem conhecimento da variabilidade acerca dos tratamentos em estudo.</p>
</section>
</section>
<section id="bibliografia" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="bibliografia">Bibliografia</h2>
<p>ANDERSON, Kenneth E. Computation of by Analysis of Variance. <em>The American Statistician</em>, v. 15, n.&nbsp;2, p.&nbsp;18-19, 1961.</p>
<p>ALMEIDA JUNIOR, Antonio Alves de et al.&nbsp;Effect of the cooling rate on the properties of veneer porcelain for zirconia dental prosthesis. <em>Materials Research</em>, v. 20, n.&nbsp;5, p.&nbsp;1418-1424, 2017.</p>
<p>BOX, George EP et al.&nbsp;Some theorems on quadratic forms applied in the study of analysis of variance problems, I. Effect of inequality of variance in the one-way classification. <em>The annals of mathematical statistics</em>, v. 25, n.&nbsp;2, p.&nbsp;290-302, 1954.</p>
<p>BUSSAB, Wilton de Oliveira; MORETTIN, Pedro Alberto. <em>Estatística básica</em>. 2009.</p>
<p>CASELLA, George; BERGER, Roger L. <em>Statistical inference</em>. Pacific Grove, CA: Duxbury, 2002.</p>
<p>COCHRAN, William G. The distribution of quadratic forms in a normal system, with applications to the analysis of covariance. In: <em>Mathematical Proceedings of the Cambridge Philosophical Society</em>. Cambridge University Press, 1934. p.&nbsp;178-191.</p>
<p>CRUMP, S. Lee. The estimation of variance components in analysis of variance. <em>Biometrics Bulletin</em>, v. 2, n.&nbsp;1, p.&nbsp;7-11, 1946.</p>
<p>DANIELS, Henry E. The estimation of components of variance. <em>Supplement to the Journal of the Royal Statistical Society</em>, v. 6, n.&nbsp;2, p.&nbsp;186-197, 1939.</p>
<p>EISENHART, Churchill. The assumptions underlying the analysis of variance. <em>Biometrics</em>, v. 3, n.&nbsp;1, p.&nbsp;1-21, 1947.</p>
<p>FISHER, Ronald Aylmer et al.&nbsp;<em>Statistical methods for research workers. Statistical methods for research workers</em>, 5th Ed, 1934.</p>
<p>GURLAND, John; MCCULLOUGH, Roger S. Testing equality of means after a preliminary test of equality of variances. <em>Biometrika</em>, v. 49, n.&nbsp;3-4, p.&nbsp;403-417, 1962.</p>
<p>HALD, Anders. <em>A history of parametric statistical inference from Bernoulli to Fisher</em>, 1713-1935. Springer Science &amp; Business Media, 2008.</p>
<p>KEMPTHORNE, Oscar. The randomization theory of experimental inference. <em>Journal of the American Statistical Association</em>, v. 50, n.&nbsp;271, p.&nbsp;946-967, 1955.</p>
<p>MONTGOMERY, Douglas C. <em>Design and analysis of experiments</em>. John wiley &amp; sons, 2013.</p>
<p>MONTGOMERY, Douglas C.; RUNGER, George C. <em>Applied statistics and probability for engineers</em>. John Wiley &amp; Sons, 2011.</p>
<p>PLACKETT, R. L. Models in the analysis of variance. <em>Journal of the Royal Statistical Society: Series B (Methodological)</em>, v. 22, n.&nbsp;2, p.&nbsp;195-209, 1960.</p>
<p>SEARLE, Shayle R. Topics in variance component estimation. <em>Biometrics</em>, v. 27, n.&nbsp;1, p.&nbsp;1-76, 1971.</p>
<p>SHAO, Yiqin et al.&nbsp;Interfacial strength and debonding mechanism between aerogel-spun carbon nanotube yarn and polyphenylene sulfide. <em>Composites Part A: Applied Science and Manufacturing</em>, v. 88, p.&nbsp;98-105, 2016.</p>
<p>SCHEFFE, Henry et al.&nbsp;Alternative models for the analysis of variance. <em>The Annals of Mathematical Statistics</em>, v. 27, n.&nbsp;2, p.&nbsp;251-271, 1956.</p>
<p>SNEDECOR, George W.; COCHRAN, Witiiam G. <em>Statistical methods</em>, 8thEdn. Ames: Iowa State Univ. Press Iowa, 1967.</p>
<p>TUKEY, John W. Comparing individual means in the analysis of variance. <em>Biometrics</em>, p.&nbsp;99-114, 1949.</p>
<p>WASSERMAN, Larry. <em>All of statistics: a concise course in statistical inference</em>. Springer Science &amp; Business Media, 2013.</p>
<p>ZUEV, Konstantin. <em>Statistical Inference</em>. 2018.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-Testes.html" class="pagination-link" aria-label="Testes de hipóteses para média de uma e duas amostras">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Testes de hipóteses para média de uma e duas amostras</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-ANOVA_blocos.html" class="pagination-link" aria-label="Planejamento com blocos completos aleatorizados">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Planejamento com blocos completos aleatorizados</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>
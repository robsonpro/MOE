<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Robson Bruno Dutra Pereira">

<title>4&nbsp; Planejamento com blocos completos aleatorizados – Modelagem e Otimização de Experimentos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05-fat2k.html" rel="next">
<link href="./03-ANOVA.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./04-ANOVA_blocos.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Planejamento com blocos completos aleatorizados</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Procurar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modelagem e Otimização de Experimentos</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Dists.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Distribuições importantes à modelagem e otimização de Experimentos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-Testes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Testes de hipóteses para média de uma e duas amostras</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Planejamento totalmente aleatorizado e análise de variância para um fator</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-ANOVA_blocos.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Planejamento com blocos completos aleatorizados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-fat2k.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fatorial de dois níveis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-fatunrep_frac.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Economia na experimentação e busca de região de curvatura via Fatorial 2^k</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#introdução" id="toc-introdução" class="nav-link active" data-scroll-target="#introdução"><span class="header-section-number">4.1</span> Introdução</a></li>
  <li><a href="#formas-de-tratar-variáveis-de-ruído-e-blocagem" id="toc-formas-de-tratar-variáveis-de-ruído-e-blocagem" class="nav-link" data-scroll-target="#formas-de-tratar-variáveis-de-ruído-e-blocagem"><span class="header-section-number">4.2</span> Formas de tratar variáveis de ruído e blocagem</a>
  <ul class="collapse">
  <li><a href="#teste-de-comparações-múltiplas" id="toc-teste-de-comparações-múltiplas" class="nav-link" data-scroll-target="#teste-de-comparações-múltiplas"><span class="header-section-number">4.2.1</span> Teste de comparações múltiplas</a></li>
  </ul></li>
  <li><a href="#bibliografia" id="toc-bibliografia" class="nav-link" data-scroll-target="#bibliografia">Bibliografia</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Planejamento com blocos completos aleatorizados</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor</div>
    <div class="quarto-title-meta-contents">
             <p>Robson Bruno Dutra Pereira </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introdução" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="introdução"><span class="header-section-number">4.1</span> Introdução</h2>
<p>Em diversos processos industriais e experimentais a presença de variáveis de fontes diversas às quais são inevitáveis, porém não interessam diretamente ao processo ou estudo, pode afetar o desempenho do processo e/ou as características de qualidade ou respostas medidas. Tais variáveis são comumente ditas de ruído e podem estar relacionadas a fatores ambientais, máquina, matéria-prima, entre outras. A aleatorização, conforme já explicado é uma premissa do planejamento de experimentos que auxilia na diluição da variabilidade adivinda de tais fatores em todas as corridas experimentais. Porém, em situações onde existem variáveis de ruído que são conhecidas e podem ser controladas, a blocagem é a técnica mais adequada para retirar do erro experimental a variância devido a tais variáveis.</p>
<p>O planejamento totalmente aleatorizado com blocos completos aleatorizados pode ser usado em casos onde deseja-se estudar um fator com a possibilidade de alocar cada replicação em cada nível da variável blocada.</p>
<p>Neste capítulo é utilizado o pacote <code>ggpplot2</code>, além das funções básicas do R. Recomenda-se a instalação destes utilizando o comando <code>install.packages("&lt;nome_pacote&gt;")</code>. Sempre que aparecer nos blocos de código R propostos o comando <code>library(&lt;nome_pacote&gt;)</code> para carregar um determinado pacote, antes este deve ser instalado.</p>
</section>
<section id="formas-de-tratar-variáveis-de-ruído-e-blocagem" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="formas-de-tratar-variáveis-de-ruído-e-blocagem"><span class="header-section-number">4.2</span> Formas de tratar variáveis de ruído e blocagem</h2>
<p>Existem diversas formas de tratar variáveis ou fatores de ruído. O tratamento a ser aplicado depende do nosso conhecimento sobre a variável e da nossa capacidade de controlá-la e/ou medí-la. Em muitas situações é possível eliminar a variável de ruído. Por exemplo em um ambiente fabril ou laboratorial onde a temperatura ambiente influencia na variabilidade do processo e, consequentemente, do produto, caso seja possível controlar a temperatura, de forma que esta permaneça constante durante o horizonte de tempo de produção ou experimentação, este ruído terá seu efeito minimizado ou eliminado. Em muitos casos, entretanto, não é factível a eliminação do efeito da variável de ruído. A <a href="#tbl-ruido" class="quarto-xref">Tabela&nbsp;<span>4.1</span></a> resume alguns tratamentos possíveis às variáveis de ruído. Quando a variável de ruído é desconhecida a aleatorização é a única forma de garantir que seu erro não se confunda ou não enviese o efeito de interesse no estudo. Quando a variável de ruído é conhecida, porém não mensurável ou não controlável, a análise de covariância (ANCOVA) pode ser empregada. Por fim, caso a variável de ruído seja conhecida e pode ser controlada, a blocagem é a técnica adequada para remover sua variabilidade do erro aleatório.</p>
<div id="tbl-ruido" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ruido-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;4.1: Tratamento de variáveis de ruído
</figcaption>
<div aria-describedby="tbl-ruido-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Variável de ruído</th>
<th>Desconhecida</th>
<th>Conhecida</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Não mensurável</td>
<td>Aleatorização</td>
<td>ANCOVA</td>
</tr>
<tr class="even">
<td>Controlada</td>
<td>-</td>
<td>Blocagem</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Existem diveros exemplos de variáveis de ruído presentes em processos industriais e experimentais que podem ser blocadas. Por exemplo, considere o caso onde deseja-se testar o efeito de distintas composições de concreto para aplicação estrutural e não há cimento (ou outra matária-prima) suficiente de um mesmo lote para fazer todas replicações das composições (ou tratamentos) de interesse. O ideal neste caso seria realizar uma replicação com todas as composições fabricadas de forma aleatória com cimento de um lote A, outra replicação com todas as composições fabricadas de forma aleatória com cimento de um lote B e assim sucessivamente. A intenção neste caso seria se precaver de uma possível variabilidade adivinda da diferença entre lotes de cimento. Pode ser que o fabricante garanta o atendimento das especificações do produto e, portanto, mínima variabilidade entre lotes, porém até mesmo o tempo de armazenamento, pode ser fonte de variabilidade neste tipo de produto. O ideal seria usar para todo o rpocedimento o mesmo lote, mas se não é possível a técnica de blocagem será útil para retirar do erro experimental a variabilidade da matéria-prima. A <a href="#fig-blocoscimento" class="quarto-xref">Figura&nbsp;<span>4.1</span></a> ilustra tal delineamento considerando 4 composições de concreto (tratamentos), 3 lotes de matéria-prima e, portanto, 3 réplicas. Os 4 tratamentos devem ser conduzidos de forma aleatória dentro dos blocos.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-blocoscimento" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-blocoscimento-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04-ANOVA_blocos_files/figure-html/fig-blocoscimento-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-blocoscimento-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;4.1: Delineamento em blocos completos para o experimento de concreto
</figcaption>
</figure>
</div>
</div>
</div>
<p>Outros exemplos de variáveis passívas de blocagem incluem cultivares (área de cultivo), operador/medidor, máquina/equipamento, turno, entre outras. Em alguns casos a blocagem é necessária por indisponibilidade de recursos de uma mesma fonte, em outros para minimizar o tempo de execução dos experimentos, seja em ambiente científico ou industrial.</p>
<div id="exm-anovabl1" class="theorem example">
<p><span class="theorem-title"><strong>Exemplo 4.1 (Determinação do tamanho de nanopartículas de óxido de zinco com distintos métodos de medição)</strong></span> Um estudo investiga vários métodos teóricos e experimentais para determinar o tamanho de nanopartículas de óxido de zinco (ZnO NPs) e analisa suas características usando espectroscopia UV-Vis. A pesquisa começa com a síntese verde de três amostras de ZnO NPs, utilizando três agentes redutores diferentes: biomassa do fungo Aspergillus niger (AN), folhas de Aloe barbadensis Mill (ABM) e folhas de Ocimum tenuiflorum (OT), com sulfato de zinco como precursor, através do método de precipitação. São aplicados diferentes métodos de medição tamanho das nanopartículas: Aproximação de Massa Efetiva (EMA), Equação de Brus (BE), Modelo de Banda Hiperbólica (HBM), Expressão de Meulenkamp (ME), Modelo de Ligação Forte (TBM) e uma versão simplificada da EMA (SEMA). Os resultados são apresentados na <a href="#tbl-blzno" class="quarto-xref">Tabela&nbsp;<span>4.2</span></a>, com código para obtê-lo explicitado a seguir.</p>
</div>
<div id="tbl-blzno" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-blzno-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;4.2: Planejamento com blocos completos totalmente aleatorizados para o estudo do tamanho de nanopartículas de óxido de zinco com distintos métodos de medição
</figcaption>
<div aria-describedby="tbl-blzno-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code anchored" id="tbl-blzno"><pre class="sourceCode r cell code-with-copy"><code class="sourceCode r"><span id="tbl-blzno-1"><a href="#tbl-blzno-1" aria-hidden="true" tabindex="-1"></a>ZnoAN<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.7</span>,<span class="fl">2.7</span>,<span class="fl">2.1</span>,<span class="fl">2.0</span>,<span class="fl">4.6</span>)</span>
<span id="tbl-blzno-2"><a href="#tbl-blzno-2" aria-hidden="true" tabindex="-1"></a>ZnoABM<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.2</span>,<span class="fl">5.1</span>,<span class="fl">3.8</span>,<span class="fl">4.5</span>,<span class="fl">9.5</span>)</span>
<span id="tbl-blzno-3"><a href="#tbl-blzno-3" aria-hidden="true" tabindex="-1"></a>ZnoANOT<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.1</span>,<span class="fl">7.7</span>,<span class="fl">5.2</span>,<span class="fl">7.2</span>,<span class="fl">15.7</span>)</span>
<span id="tbl-blzno-4"><a href="#tbl-blzno-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="tbl-blzno-5"><a href="#tbl-blzno-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co">#número de tratamentos (níveis)</span></span>
<span id="tbl-blzno-6"><a href="#tbl-blzno-6" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">length</span>(ZnoAN) <span class="co">#número de blocos</span></span>
<span id="tbl-blzno-7"><a href="#tbl-blzno-7" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> a<span class="sc">*</span>b <span class="co">#número de experimentos</span></span>
<span id="tbl-blzno-8"><a href="#tbl-blzno-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="tbl-blzno-9"><a href="#tbl-blzno-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="tbl-blzno-10"><a href="#tbl-blzno-10" aria-hidden="true" tabindex="-1"></a>Ordem <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">replicate</span>(<span class="dv">5</span>, <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">size =</span> a, <span class="at">replace =</span> <span class="cn">FALSE</span>), <span class="at">simplify =</span> <span class="cn">FALSE</span>))</span>
<span id="tbl-blzno-11"><a href="#tbl-blzno-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="tbl-blzno-12"><a href="#tbl-blzno-12" aria-hidden="true" tabindex="-1"></a>metodo <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"BE"</span>, <span class="st">"SEMA"</span>, <span class="st">"ME"</span>, <span class="st">"TBM"</span>, <span class="st">"HBM"</span>), <span class="at">each =</span> <span class="dv">3</span>))</span>
<span id="tbl-blzno-13"><a href="#tbl-blzno-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="tbl-blzno-14"><a href="#tbl-blzno-14" aria-hidden="true" tabindex="-1"></a>ReducingAgents <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"ZnoAN"</span>,<span class="st">"ZnoABM"</span>,<span class="st">"ZnoANOT"</span>), <span class="dv">5</span>)</span>
<span id="tbl-blzno-15"><a href="#tbl-blzno-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="tbl-blzno-16"><a href="#tbl-blzno-16" aria-hidden="true" tabindex="-1"></a>Agente <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(ReducingAgents) </span>
<span id="tbl-blzno-17"><a href="#tbl-blzno-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="tbl-blzno-18"><a href="#tbl-blzno-18" aria-hidden="true" tabindex="-1"></a>Particle_size <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(ZnoAN,ZnoABM,ZnoANOT),</span>
<span id="tbl-blzno-19"><a href="#tbl-blzno-19" aria-hidden="true" tabindex="-1"></a>                        <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span> <span class="dv">5</span>, <span class="at">byrow=</span>T) <span class="co"># resposta</span></span>
<span id="tbl-blzno-20"><a href="#tbl-blzno-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="tbl-blzno-21"><a href="#tbl-blzno-21" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Particle_size) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BE"</span>, <span class="st">"SEMA"</span>, <span class="st">"ME"</span>, <span class="st">"TBM"</span>, <span class="st">"HBM"</span>)</span>
<span id="tbl-blzno-22"><a href="#tbl-blzno-22" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Particle_size) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ZnoAN"</span>, <span class="st">"ZnoABM"</span>, <span class="st">"ZnoANOT"</span>) </span>
<span id="tbl-blzno-23"><a href="#tbl-blzno-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="tbl-blzno-24"><a href="#tbl-blzno-24" aria-hidden="true" tabindex="-1"></a>Bloco <span class="ot">&lt;-</span> metodo</span>
<span id="tbl-blzno-25"><a href="#tbl-blzno-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="tbl-blzno-26"><a href="#tbl-blzno-26" aria-hidden="true" tabindex="-1"></a>Tamanho <span class="ot">&lt;-</span> <span class="fu">c</span>(Particle_size)</span>
<span id="tbl-blzno-27"><a href="#tbl-blzno-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="tbl-blzno-28"><a href="#tbl-blzno-28" aria-hidden="true" tabindex="-1"></a>planejamento <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Ordem,Agente,Bloco,Tamanho)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<p>Seja o conjunto geral de dados resumido na <a href="#tbl-databloc" class="quarto-xref">Tabela&nbsp;<span>4.3</span></a>. Neste conjunto tem-se <span class="math inline">\(a\)</span> tratamentos de interesse e <span class="math inline">\(b\)</span> blocos. De forma geral, cada observação pode ser denotada como <span class="math inline">\(y_{ij}\)</span>, com <span class="math inline">\(i = 1, ..., a\)</span> e <span class="math inline">\(j = 1, ..., b\)</span>.</p>
<div id="tbl-databloc" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-databloc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;4.3: Dados de um experimento com <span class="math inline">\(a\)</span> tratamentos e <span class="math inline">\(b\)</span> blocos
</figcaption>
<div aria-describedby="tbl-databloc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Tratamentos</th>
<th>Bloco 1</th>
<th>Bloco 2</th>
<th>…</th>
<th>Bloco b</th>
<th>Somas</th>
<th>Médias</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><span class="math inline">\(y_{11}\)</span></td>
<td><span class="math inline">\(y_{12}\)</span></td>
<td>…</td>
<td><span class="math inline">\(y_{1b}\)</span></td>
<td><span class="math inline">\(y_{1.} = \sum_{j=1}^{b}{y_{1j}}\)</span></td>
<td><span class="math inline">\(\bar{y}_{1.} = y_{1.}/b\)</span></td>
</tr>
<tr class="even">
<td>2</td>
<td><span class="math inline">\(y_{21}\)</span></td>
<td><span class="math inline">\(y_{22}\)</span></td>
<td>…</td>
<td><span class="math inline">\(y_{2b}\)</span></td>
<td><span class="math inline">\(y_{2.} = \sum_{j=1}^{b}{y_{2j}}\)</span></td>
<td><span class="math inline">\(\bar{y}_{2.} = y_{2.}/b\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\ddots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="even">
<td>a</td>
<td><span class="math inline">\(y_{a1}\)</span></td>
<td><span class="math inline">\(y_{a2}\)</span></td>
<td>…</td>
<td><span class="math inline">\(y_{ab}\)</span></td>
<td><span class="math inline">\(y_{a.} = \sum_{j=1}^{b}{y_{aj}}\)</span></td>
<td><span class="math inline">\(\bar{y}_{a.} = y_{a.}/b\)</span></td>
</tr>
<tr class="odd">
<td><strong>Somas</strong></td>
<td><span class="math inline">\(y_{.1} = \sum_{i=1}^{a}{y_{i1}}\)</span></td>
<td><span class="math inline">\(y_{.2} = \sum_{i=1}^{a}{y_{i2}}\)</span></td>
<td>…</td>
<td><span class="math inline">\(y_{.b} = \sum_{i=1}^{a}{y_{ib}}\)</span></td>
<td><span class="math inline">\(y_{..} = \sum_{i=1}^{a}\sum_{j=1}^{b}{y_{ij}}\)</span></td>
<td></td>
</tr>
<tr class="even">
<td><strong>Médias</strong></td>
<td><span class="math inline">\(\bar{y}_{.1} = y_{.1}/a\)</span></td>
<td><span class="math inline">\(\bar{y}_{.2} = y_{.2}/a\)</span></td>
<td>…</td>
<td><span class="math inline">\(\bar{y}_{.b} = y_{.b}/a\)</span></td>
<td></td>
<td><span class="math inline">\(\bar{y}_{..} = y_{..}/(a \times b)\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Para um delineamento em blocos completos ao acaso o modelo de efeitos para uma observação <span class="math inline">\(y_{ij}\)</span> é exposto na <a href="#eq-blmodel" class="quarto-xref">Equação&nbsp;<span>4.1</span></a>.</p>
<p><span id="eq-blmodel"><span class="math display">\[
y_{ij} = \mu + \tau_i + \beta_j + \varepsilon_{ij}
\tag{4.1}\]</span></span></p>
<p>Onde:</p>
<ul>
<li><span class="math inline">\(y_{ij}\)</span> é a observação da variável resposta referente ao tratamento <span class="math inline">\(i\)</span> no bloco <span class="math inline">\(j\)</span>;</li>
<li><span class="math inline">\(\mu\)</span> é a média geral (constante comum a todas as observações);</li>
<li><span class="math inline">\(\tau_i\)</span> é o efeito do tratamento <span class="math inline">\(i\)</span>, isto é: <span class="math inline">\(\tau_i = \bar{y}_{i.} - \bar{y}_{..}\)</span>;</li>
<li><span class="math inline">\(\beta_j\)</span> é o efeito do bloco <span class="math inline">\(j\)</span>, isto é: <span class="math inline">\(\beta_j = \bar{y}_{.j} - \bar{y}_{..}\)</span>;</li>
<li><span class="math inline">\(\varepsilon_{ij}\)</span> é o erro experimental associado à observação <span class="math inline">\(y_{ij}\)</span>, assumido como independente e normalmente distribuído com média zero e variância constante <span class="math inline">\(\sigma^2\)</span>;</li>
</ul>
<p>Adicionalmente, assume-se que: <span class="math inline">\(\varepsilon_{ij} \sim N(0, \sigma^2)\)</span>, <span class="math inline">\(\sum_{i=1}^{a} \tau_i = 0\)</span> e <span class="math inline">\(\sum_{j=1}^{b} \beta_j = 0\)</span>.</p>
<p>As hipóteses testadas na análise de variância no delineamento em blocos casualizados consideram os efeitos dos tratamentos e dos blocos. A hipótese nula para os tratamentos é a de que todos os efeitos são nulos, enquanto a hipótese alternativa sugere que ao menos um dos efeitos é diferente. Analogamente, assume-se que os blocos têm efeito aleatório e controlam a variabilidade do experimento. As hipóteses para os tratamentos são formuladas da seguinte forma:</p>
<p><span class="math display">\[
H_0: \alpha_1= \alpha_2 = \cdots = \alpha_a = 0
\]</span> <span class="math display">\[
H_1: \alpha_i \ne 0, \text{ para ao menos um } i
\]</span></p>
<p>A análise de variância em é baseada no particionamento da soma dos quadrados total em três componentes: soma dos quadrados entre tratamentos (<span class="math inline">\(SS_{Trat}\)</span>), entre blocos (<span class="math inline">\(SS_{Bloco}\)</span>) e dentro dos tratamentos e blocos (erro) (<span class="math inline">\(SS_{Erro}\)</span>), conforme a <a href="#eq-identanova-dbc" class="quarto-xref">Equação&nbsp;<span>4.2</span></a>.</p>
<p><span id="eq-identanova-dbc"><span class="math display">\[
\underbrace{\sum_{i=1}^{a} \sum_{j=1}^{b} (y_{ij} - \bar{y}_{..})^2}_{SS_T}
=
\underbrace{b \sum_{i=1}^{a} (\bar{y}_{i.} - \bar{y}_{..})^2}_{SS_{Trat}}
+
\underbrace{a \sum_{j=1}^{b} (\bar{y}_{.j} - \bar{y}_{..})^2}_{SS_{Bloco}}
+
\underbrace{\sum_{i=1}^{a} \sum_{j=1}^{b} (y_{ij} - \bar{y}_{i.} - \bar{y}_{.j} + \bar{y}_{..})^2}_{SS_{Erro}}
\tag{4.2}\]</span></span></p>
<p>Os graus de liberdade de cada fonte de variação são:</p>
<ul>
<li>Tratamentos: <span class="math inline">\(DF_{Trat} = a - 1\)</span></li>
<li>Blocos: <span class="math inline">\(DF_{Bloco} = b - 1\)</span></li>
<li>Erro: <span class="math inline">\(DF_{Erro} = (a - 1)(b - 1)\)</span></li>
<li>Total: <span class="math inline">\(DF_T = ab - 1\)</span></li>
</ul>
<p>As médias dos quadrados são obtidas pela razão entre a soma dos quadrados e os respectivos graus de liberdade:</p>
<p><span class="math display">\[
MS_{Trat} = \frac{SS_{Trat}}{a - 1}, \quad
MS_{Bloco} = \frac{SS_{Bloco}}{b - 1}, \quad
MS_{Erro} = \frac{SS_{Erro}}{(a - 1)(b - 1)}
\]</span></p>
<p>A estatística do teste F para os tratamentos é dada por:</p>
<p><span class="math display">\[
F_0 = \frac{MS_{Trat}}{MS_{Erro}} \sim F_{(a-1; (a-1)(b-1))}
\]</span></p>
<p>A hipótese <span class="math inline">\(H_0\)</span> é rejeitada se <span class="math inline">\(F_0 &gt; F_{(\alpha; a-1, (a-1)(b-1))}\)</span>. A <a href="#tbl-anova-dbc" class="quarto-xref">Tabela&nbsp;<span>4.4</span></a> resume os cálculos da ANOVA para o DBC.</p>
<div id="tbl-anova-dbc" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-dbc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;4.4: Tabela resumo ANOVA para o planejamento com blocos completos aleatorizados
</figcaption>
<div aria-describedby="tbl-anova-dbc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Fonte</th>
<th>DF</th>
<th>SS</th>
<th>MS</th>
<th><span class="math inline">\(F_0\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tratamentos</td>
<td><span class="math inline">\(a - 1\)</span></td>
<td><span class="math inline">\(SS_{Trat}\)</span></td>
<td><span class="math inline">\(MS_{Trat}\)</span></td>
<td><span class="math inline">\(F_0 = MS_{Trat}/MS_{Erro}\)</span></td>
</tr>
<tr class="even">
<td>Blocos</td>
<td><span class="math inline">\(b - 1\)</span></td>
<td><span class="math inline">\(SS_{Bloco}\)</span></td>
<td><span class="math inline">\(MS_{Bloco}\)</span></td>
<td>–</td>
</tr>
<tr class="odd">
<td>Erro</td>
<td><span class="math inline">\((a - 1)(b - 1)\)</span></td>
<td><span class="math inline">\(SS_{Erro}\)</span></td>
<td><span class="math inline">\(MS_{Erro}\)</span></td>
<td>–</td>
</tr>
<tr class="even">
<td>Total</td>
<td><span class="math inline">\(ab - 1\)</span></td>
<td><span class="math inline">\(SS_T\)</span></td>
<td>–</td>
<td>–</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Para realizar a análise é utilizado o comando <code>aov()</code>. Pelos resultados, como <span class="math inline">\(F_0 = 12,057 &gt; 4.45897 = F_{(0,05;2;8)}\)</span>, ou como <span class="math inline">\(p-value = 0.00385 &lt; 0,05 = \alpha\)</span>, rejeita-se <span class="math inline">\(H_0\)</span>. Deste modo, há ao menos um dos tratamentos com efeito diferente, de forma que há influência do tipo de agente redutor no tamanho da partícula. É importante notar também que o efeito do método de medição, que consiste neste caso na variável blocada, foi estatísticamente significativo, deixando claro a diferença entre tais métodos e, portanto, a necessidade de blocar tal fonte de variabilidade.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value  Pr(&gt;F)   
Agente       2  71.85   35.92  12.057 0.00385 **
Bloco        4  78.37   19.59   6.576 0.01203 * 
Residuals    8  23.83    2.98                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.45897</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = modelo_anova)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.68000 -0.27667 -0.01333  0.22000  3.06000 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)     3.9467     1.1791   3.347  0.01012 * 
AgenteZnoAN    -2.6000     1.0917  -2.382  0.04443 * 
AgenteZnoANOT   2.7600     1.0917   2.528  0.03535 * 
BlocoHBM        5.9333     1.4093   4.210  0.00296 **
BlocoME        -0.3000     1.4093  -0.213  0.83676   
BlocoSEMA       1.1667     1.4093   0.828  0.43178   
BlocoTBM        0.5667     1.4093   0.402  0.69815   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.726 on 8 degrees of freedom
Multiple R-squared:  0.8631,    Adjusted R-squared:  0.7604 
F-statistic: 8.403 on 6 and 8 DF,  p-value: 0.004185</code></pre>
</div>
</div>
<p>As medidas de ajuste usadas para averiguar a efetividade do modelo obtido via ANOVA no caso blocado são as mesmas, porém devem considerar a variabilidade relativa ao bloco. O coeficiente de determinação simples, <span class="math inline">\(R^2\)</span>, é calculado conforme a <a href="#eq-R2dbc" class="quarto-xref">Equação&nbsp;<span>4.3</span></a>, como a razão entre a soma dos quadrados explicada pelo modelo (tratamentos e blocos) e a soma dos quadrados total. Esta medida quantifica a proporção da variabilidade total explicada pelo modelo, mas deve ser usada com cautela, pois não considera o número de parâmetros incluídos.</p>
<p><span id="eq-R2dbc"><span class="math display">\[
R^2 = \frac{SS_{Trat} + SS_{Bloco}}{SS_T}
\tag{4.3}\]</span></span></p>
<p>O coeficiente de determinação ajustado, <span class="math inline">\(R_{aj}^2\)</span>, é apresentado na <a href="#eq-R2ajdbc" class="quarto-xref">Equação&nbsp;<span>4.4</span></a>. Ele considera os graus de liberdade associados ao modelo e ao erro, penalizando a adição de efeitos que não contribuam de forma significativa para a explicação da variabilidade dos dados. É, portanto, uma métrica mais robusta para avaliar a qualidade do ajuste no contexto da ANOVA com blocos.</p>
<p><span id="eq-R2ajdbc"><span class="math display">\[
R_{aj}^2 = 1 - \frac{MS_{Erro}}{SS_T/(ab - 1)}
\tag{4.4}\]</span></span></p>
<p>Para o <a href="#exm-anovabl1" class="quarto-xref">Exemplo&nbsp;<span>4.1</span></a>, a estatística de ajuste <span class="math inline">\(R_{aj}^2=76,04\%\)</span>, garante que a maior parte da variabilidade dos dados é explicada pelo efeito dos tratamentos e dos blocos e não pelo erro experimental.</p>
<p>A <a href="#fig-resianovabl" class="quarto-xref">Figura&nbsp;<span>4.2</span></a> ilustra alguns gráficos dos resíduos que auxiliam na visualização das pressuposições da ANOVA.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-resianovabl" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-resianovabl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04-ANOVA_blocos_files/figure-html/fig-resianovabl-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-resianovabl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;4.2: Gráficos de resíduos para ANOVA com blocos
</figcaption>
</figure>
</div>
</div>
</div>
<p>O teste de normalidade de Shapiro-Wilk é realizado conforme segue. Não há indícios para rejeição da hipótese de normalidade dos resíduos.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  modelo_anova$residuals
W = 0.92293, p-value = 0.2134</code></pre>
</div>
</div>
<p>A <a href="#fig-efeitosanovabl" class="quarto-xref">Figura&nbsp;<span>4.3</span></a> ilustra um gráfico de efeitos dos tratamentos e blocos. A idéia deste gráfico é não somente demonstrar o efeito do agente redutor, mas também do método de medição. Pode-se observar que o agente ZnOAN resulta no menor tamanho de partícula, seguido do ZnOABM e do ZnOANOT. Ademais, fica claro que o método de medição HBM apresenta maior resultado de tamanho de partícula.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(planejamento, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> Tamanho, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> Agente,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> Bloco)) <span class="sc">+</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">linetype =</span> Bloco, <span class="at">color =</span> Bloco)) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> Bloco, <span class="at">color =</span> Bloco)) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Tamanho de partícula (nm)"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span> <span class="st">"Agente redutor"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Método"</span>, <span class="at">linetype =</span> <span class="st">"Método"</span>, <span class="at">shape =</span> <span class="st">"Método"</span>) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-efeitosanovabl" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-efeitosanovabl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04-ANOVA_blocos_files/figure-html/fig-efeitosanovabl-1.png" class="img-fluid figure-img" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-efeitosanovabl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;4.3: Gráfico de efeitos para o tamanho de partícula em função do tipo de agente redutor e do método de medição
</figcaption>
</figure>
</div>
</div>
</div>
<p>Um gráfico de médias dos tratamentos pode ser apresentado conforme <a href="#fig-mediaanovabl" class="quarto-xref">Figura&nbsp;<span>4.4</span></a>, com código exposto à seguir.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(planejamento <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">group_by</span>(Agente) <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">summarise</span>(<span class="at">Tamanho =</span> <span class="fu">mean</span>(Tamanho)), </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> Tamanho, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> Agente, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Tamanho de partícula (nm)"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span> <span class="st">"Agente redutor"</span>) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mediaanovabl" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mediaanovabl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04-ANOVA_blocos_files/figure-html/fig-mediaanovabl-1.png" class="img-fluid figure-img" width="288">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mediaanovabl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;4.4: Gráfico de média para o tamanho de partícula em função do tipo de agente redutor
</figcaption>
</figure>
</div>
</div>
</div>
<section id="teste-de-comparações-múltiplas" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="teste-de-comparações-múltiplas"><span class="header-section-number">4.2.1</span> Teste de comparações múltiplas</h3>
<p>O código à seguir pode ser utilizado para realizar o teste de Tukey para o caso do planejamento com blocos completos aleatorizados. Pode-se confirmar que há diferença apenas entre os métodos de redução ZnOANOT e ZnOAN.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = Tamanho ~ Agente + Bloco, data = planejamento)

$Agente
                diff        lwr       upr     p adj
ZnoAN-ZnoABM   -2.60 -5.7193731 0.5193731 0.1005971
ZnoANOT-ZnoABM  2.76 -0.3593731 5.8793731 0.0811522
ZnoANOT-ZnoAN   5.36  2.2406269 8.4793731 0.0029844

$Bloco
               diff        lwr        upr     p adj
HBM-BE    5.9333333   1.064437 10.8022298 0.0182795
ME-BE    -0.3000000  -5.168896  4.5688965 0.9994366
SEMA-BE   1.1666667  -3.702230  6.0355631 0.9146298
TBM-BE    0.5666667  -4.302230  5.4355631 0.9933755
ME-HBM   -6.2333333 -11.102230 -1.3644369 0.0139017
SEMA-HBM -4.7666667  -9.635563  0.1022298 0.0551913
TBM-HBM  -5.3666667 -10.235563 -0.4977702 0.0310483
SEMA-ME   1.4666667  -3.402230  6.3355631 0.8303422
TBM-ME    0.8666667  -4.002230  5.7355631 0.9685578
TBM-SEMA -0.6000000  -5.468896  4.2688965 0.9917826</code></pre>
</div>
</div>
</section>
</section>
<section id="bibliografia" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="bibliografia">Bibliografia</h2>
<p>BUSSAB, Wilton de Oliveira; MORETTIN, Pedro Alberto. <em>Estatística básica</em>. 2009.</p>
<p>COCHRAN, William G.; COX, Gertrude M. <em>Experimental designs</em>. John Wiley &amp; Sons, 1957</p>
<p>FISHER, R. A. The arrangement of field experiments. <em>Journal of the Ministry of Agriculture of Great Britain</em>, 33, 503-513, 1926.</p>
<p>FISHER, Ronald Aylmer et al.&nbsp;<em>Statistical methods for research workers</em>. 5th Ed, 1934.</p>
<p>KEMPTHORNE, Oscar. The randomization theory of experimental inference. <em>Journal of the American Statistical Association</em>, v. 50, n.&nbsp;271, p.&nbsp;946-967, 1955.</p>
<p>MONTGOMERY, Douglas C. <em>Design and analysis of experiments</em>. John wiley &amp; sons, 2013.</p>
<p>SNEDECOR, George W.; COCHRAN, William G. <em>Statistical methods</em>. 8th Edn. Ames: Iowa State Univ. Press Iowa, 1967.</p>
<p>STEEL, R. G. D. and TORRIE, J. H. <em>Principles and procedures of statistics</em>. A biometrical approach, 2nd Edition, McGraw-Hill Book Company, New York, 1980.</p>
<p>YATES, Frank. <em>The design and analysis of factorial experiments</em>. Technical Communication no. 35, Imperial Bureau of Soil Science, 1937.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03-ANOVA.html" class="pagination-link" aria-label="Planejamento totalmente aleatorizado e análise de variância para um fator">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Planejamento totalmente aleatorizado e análise de variância para um fator</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05-fat2k.html" class="pagination-link" aria-label="Fatorial de dois níveis">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fatorial de dois níveis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>
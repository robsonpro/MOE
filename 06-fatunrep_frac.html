<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Robson Bruno Dutra Pereira">

<title>6&nbsp; Fatorial de dois níveis não replicado, com blocos e fracionado – Modelagem e Otimização de Experimentos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./07-rsm.html" rel="next">
<link href="./05-fat2k.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8da5b4427184b79ecddefad3d342027e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./06-fatunrep_frac.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Fatorial de dois níveis não replicado, com blocos e fracionado</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Procurar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modelagem e Otimização de Experimentos</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Dists.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Distribuições importantes à modelagem e otimização de Experimentos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-Testes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Testes de hipóteses para média de uma e duas amostras</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Planejamento totalmente aleatorizado e análise de variância para um fator</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-ANOVA_blocos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Planejamento com blocos completos aleatorizados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-fat2k.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fatorial de dois níveis replicado</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-fatunrep_frac.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Fatorial de dois níveis não replicado, com blocos e fracionado</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-rsm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Metodologia de Superfície de Resposta</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-mix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Experimentos para Misturas</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#introdução" id="toc-introdução" class="nav-link active" data-scroll-target="#introdução"><span class="header-section-number">6.1</span> Introdução</a></li>
  <li><a href="#fatorial-2k-sem-replicar" id="toc-fatorial-2k-sem-replicar" class="nav-link" data-scroll-target="#fatorial-2k-sem-replicar"><span class="header-section-number">6.2</span> Fatorial <span class="math inline">\(2^k\)</span> sem replicar</a></li>
  <li><a href="#bloco-e-confundimento-no-fatorial-2k" id="toc-bloco-e-confundimento-no-fatorial-2k" class="nav-link" data-scroll-target="#bloco-e-confundimento-no-fatorial-2k"><span class="header-section-number">6.3</span> Bloco e confundimento no fatorial <span class="math inline">\(2^k\)</span></a></li>
  <li><a href="#fatorial-fracionado-2k-p" id="toc-fatorial-fracionado-2k-p" class="nav-link" data-scroll-target="#fatorial-fracionado-2k-p"><span class="header-section-number">6.4</span> Fatorial fracionado <span class="math inline">\(2^{k-p}\)</span></a></li>
  <li><a href="#bibliografia" id="toc-bibliografia" class="nav-link" data-scroll-target="#bibliografia">Bibliografia</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Fatorial de dois níveis não replicado, com blocos e fracionado</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor</div>
    <div class="quarto-title-meta-contents">
             <p>Robson Bruno Dutra Pereira </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introdução" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="introdução"><span class="header-section-number">6.1</span> Introdução</h2>
<p>O fatorial <span class="math inline">\(2^k\)</span> é um planejamento essencial ao DOE por permitir diversas estratégias na experimentação, desde a economia experimental, a partir de planejamentos não replicados ou fracionados, blocagem de variáveis controláveis porém indesejáveis, além da busca de região de curvatura e complementação do planejamento para obtenção de modelos passíveis de otimização.</p>
<p>Neste capítulo, será apresentado o planejamento fatorial <span class="math inline">\(2^k\)</span> não replicado. Em seguida serão explicados os conceitos de blocagem. confundimento no fatorial <span class="math inline">\(2^k\)</span>. O planejamento fatorial fracionado <span class="math inline">\(2^{k-p}\)</span> é exposto a partir dos conceitos de confundimento anteriormente apresentados.</p>
<p>Neste capítulo são utilizados os pacotes <code>FrF2</code> e <code>unrepx</code>, além das funções básicas do R. Recomenda-se a instalação destes utilizando o comando <code>install.packages("&lt;nome_pacote&gt;")</code>. A instalação é realizada uma única vez, porém o pacote deve ser carregado via <code>library(&lt;nome_pacote&gt;)</code> sempre que deseja-se usar suas funções.</p>
</section>
<section id="fatorial-2k-sem-replicar" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="fatorial-2k-sem-replicar"><span class="header-section-number">6.2</span> Fatorial <span class="math inline">\(2^k\)</span> sem replicar</h2>
<p>O fatorial <span class="math inline">\(2^k\)</span> não replicado consiste em um caso particular do fatorial <span class="math inline">\(2^k\)</span> com <span class="math inline">\(n = 1\)</span>. Especialmente quando há muitos fatores <span class="math inline">\(k\)</span> de interesse a serem analisados, o fatorial <span class="math inline">\(2^k\)</span> não replicado tem sido utilizado, visto que o custo da replicação é alto. É possível obter o modelo de regressão completo, porém não é possível testar os efeitos via teste <span class="math inline">\(t\)</span> ou ANOVA, uma vez que não há graus de liberdade remanescentes para estimar o erro experimental, uma vez que o número total de experimentos é igual ao número de termos no modelo completo, <span class="math inline">\(N = 2^k = r\)</span>.</p>
<p>Existem métodos alternativos para estimar o erro experimental considerando os efeitos mais esparços, isto é, os efeitos de menor magnitude. Estes métodos se baseiam no princípio da esparcidade dos efeitos que garantem que poucos efeitos apresentam magnitude não desprezível, enquanto a maior parte dos efeitos investigados é esparça. Outra possibilidade de estimativa do erro experimental pode ser realizada a partir da redução hierárquica do modelo e, deste modo, testar a significância dos efeitos de menor ordem. Geralmente, os efeitos de menor ordem explicam melhor a variabilidade dos dados. Modelos saturados e com termos de ordem maior além de difícil interpretação, geralmente apresentam maior variabilidade.</p>
<div id="exm-fatunrep1" class="theorem example">
<p><span class="theorem-title"><strong>Exemplo 6.1</strong></span> Um fatorial <span class="math inline">\(2^4\)</span> não replicado foi usado para estudar o tratamento eletroquímico de águas residuais de fabricação de fibra acrílica com eletrodo de diamante dopado com boro. Os fatores considerados foram o tempo de tratamento (1-2 horas), a vazão (400-600 mL/min), intensidade de corrente (0,50-1,00 A) e carga inicial de demanda química de oxigênio (362- 723 mg/L) na eficiência do tratamento.</p>
</div>
<div class="cell">
<div id="tbl-dqoeflu" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-dqoeflu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.1: Planejamento fatorial 2^4 não replicado, tratamento efluentes
</figcaption>
<div aria-describedby="tbl-dqoeflu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 13%">
<col style="width: 20%">
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">ordem</th>
<th style="text-align: right;">Tempo [h]</th>
<th style="text-align: right;">Vazão [mL/min]</th>
<th style="text-align: right;">Corrente [A]</th>
<th style="text-align: right;">DQO [mg/L]</th>
<th style="text-align: right;">Remoção de DQO [%]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">400</td>
<td style="text-align: right;">0,5</td>
<td style="text-align: right;">362</td>
<td style="text-align: right;">43,4</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">400</td>
<td style="text-align: right;">0,5</td>
<td style="text-align: right;">362</td>
<td style="text-align: right;">54,1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">600</td>
<td style="text-align: right;">0,5</td>
<td style="text-align: right;">362</td>
<td style="text-align: right;">48,6</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">600</td>
<td style="text-align: right;">0,5</td>
<td style="text-align: right;">362</td>
<td style="text-align: right;">65,5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">400</td>
<td style="text-align: right;">1,0</td>
<td style="text-align: right;">362</td>
<td style="text-align: right;">59,7</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">400</td>
<td style="text-align: right;">1,0</td>
<td style="text-align: right;">362</td>
<td style="text-align: right;">61,9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">600</td>
<td style="text-align: right;">1,0</td>
<td style="text-align: right;">362</td>
<td style="text-align: right;">56,9</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">600</td>
<td style="text-align: right;">1,0</td>
<td style="text-align: right;">362</td>
<td style="text-align: right;">71,3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">400</td>
<td style="text-align: right;">0,5</td>
<td style="text-align: right;">723</td>
<td style="text-align: right;">47,4</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">400</td>
<td style="text-align: right;">0,5</td>
<td style="text-align: right;">723</td>
<td style="text-align: right;">69,2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">600</td>
<td style="text-align: right;">0,5</td>
<td style="text-align: right;">723</td>
<td style="text-align: right;">38,5</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">600</td>
<td style="text-align: right;">0,5</td>
<td style="text-align: right;">723</td>
<td style="text-align: right;">70,5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">400</td>
<td style="text-align: right;">1,0</td>
<td style="text-align: right;">723</td>
<td style="text-align: right;">55,9</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">400</td>
<td style="text-align: right;">1,0</td>
<td style="text-align: right;">723</td>
<td style="text-align: right;">79,9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">600</td>
<td style="text-align: right;">1,0</td>
<td style="text-align: right;">723</td>
<td style="text-align: right;">65,7</td>
</tr>
<tr class="even">
<td style="text-align: right;">16</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">600</td>
<td style="text-align: right;">1,0</td>
<td style="text-align: right;">723</td>
<td style="text-align: right;">79,3</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Pode-se criar o planejamento utilizando o pacote <code>FrF2</code> do R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando o planejamento</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>plan_eflu <span class="ot">&lt;-</span> <span class="fu">FrF2</span>(<span class="at">nruns =</span> <span class="dv">16</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">nfactors =</span> <span class="dv">4</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">factor.names=</span><span class="fu">list</span>(<span class="at">Tem=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Vaz=</span><span class="fu">c</span>(<span class="dv">400</span>,<span class="dv">600</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Cor=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">DQO=</span><span class="fu">c</span>(<span class="dv">362</span>,<span class="dv">723</span>)),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">replications =</span> <span class="dv">1</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">randomize =</span> F)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Energia em [kJ]</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">43.4</span>, <span class="fl">54.1</span>, <span class="fl">48.6</span>, <span class="fl">65.5</span>, <span class="fl">59.7</span>, <span class="fl">61.9</span>, <span class="fl">56.9</span>, <span class="fl">71.3</span>, <span class="fl">47.4</span>, <span class="fl">69.2</span>, <span class="fl">38.5</span>, <span class="fl">70.5</span>, <span class="fl">55.9</span>, <span class="fl">79.9</span>, <span class="fl">65.7</span>, <span class="fl">79.3</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>plan_eflu <span class="ot">&lt;-</span> <span class="fu">add.response</span>(plan_eflu, y)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(plan_eflu)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
FrF2(nruns = 16, nfactors = 4, factor.names = list(Tem = c(1, 
    2), Vaz = c(400, 600), Cor = c(0.5, 1), DQO = c(362, 723)), 
    replications = 1, randomize = F)

Experimental design of type  full factorial 
16  runs

Factor settings:
  Tem Vaz Cor DQO
1   1 400 0,5 362
2   2 600   1 723

Responses:
[1] y

The design itself:
   Tem Vaz Cor DQO    y
1    1 400 0,5 362 43,4
2    2 400 0,5 362 54,1
3    1 600 0,5 362 48,6
4    2 600 0,5 362 65,5
5    1 400   1 362 59,7
6    2 400   1 362 61,9
7    1 600   1 362 56,9
8    2 600   1 362 71,3
9    1 400 0,5 723 47,4
10   2 400 0,5 723 69,2
11   1 600 0,5 723 38,5
12   2 600 0,5 723 70,5
13   1 400   1 723 55,9
14   2 400   1 723 79,9
15   1 600   1 723 65,7
16   2 600   1 723 79,3
class=design, type= full factorial </code></pre>
</div>
</div>
<p>É possível calcular os efeitos no R conforme segue.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># construindo a matrix X</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>plan2<span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(levels,levels,levels,levels)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(plan2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"x1"</span>,<span class="st">"x2"</span>,<span class="st">"x3"</span>,<span class="st">"x4"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">with</span>(plan2, <span class="fu">cbind</span>(<span class="at">I =</span> <span class="dv">1</span>, x1, x2, x3, x4, <span class="at">x1x2 =</span> x1<span class="sc">*</span>x2, <span class="at">x1x3 =</span> x1<span class="sc">*</span>x3,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">x1x4 =</span> x1<span class="sc">*</span>x4,  <span class="at">x2x3 =</span> x2<span class="sc">*</span>x3, <span class="at">x2x4 =</span> x2<span class="sc">*</span>x4, </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">x3x4 =</span> x3<span class="sc">*</span>x4, <span class="at">x1x2x3 =</span> x1<span class="sc">*</span>x2<span class="sc">*</span>x3, <span class="at">x1x2x4 =</span> x1<span class="sc">*</span>x2<span class="sc">*</span>x4,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">x1x3x4 =</span> x1<span class="sc">*</span>x3<span class="sc">*</span>x4, <span class="at">x2x3x4 =</span> x2<span class="sc">*</span>x3<span class="sc">*</span>x4, </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">x1x2x3x4 =</span> x1<span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4))</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculando os efeitos</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>efeitos <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(X, y)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">*</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(efeitos) <span class="ot">&lt;-</span> <span class="st">"Efeitos"</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>efeitos</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Efeitos
I        120,975
x1        16,950
x2         3,100
x3        11,675
x4         5,625
x1x2       2,275
x1x3      -3,400
x1x4       5,900
x2x3       0,850
x2x4      -2,700
x3x4       2,125
x1x2x3    -1,825
x1x2x4    -2,325
x1x3x4    -0,650
x2x3x4     3,350
x1x2x3x4  -3,325</code></pre>
</div>
</div>
<p>Posteriormente pode-se obter os coeficientes de regressão conforme segue.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo dos coeficientes</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>Coef <span class="ot">&lt;-</span> efeitos<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Coef) <span class="ot">&lt;-</span> <span class="st">"Coeficientes"</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>Coef</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Coeficientes
I             60,4875
x1             8,4750
x2             1,5500
x3             5,8375
x4             2,8125
x1x2           1,1375
x1x3          -1,7000
x1x4           2,9500
x2x3           0,4250
x2x4          -1,3500
x3x4           1,0625
x1x2x3        -0,9125
x1x2x4        -1,1625
x1x3x4        -0,3250
x2x3x4         1,6750
x1x2x3x4      -1,6625</code></pre>
</div>
</div>
<p>Uma vez que <span class="math inline">\(N = 2^4 = 16\)</span> e <span class="math inline">\(r = 16\)</span>, não há graus de liberdade para estimar o erro experimental, pois <span class="math inline">\(DF_E= N - r = 0\)</span>. Deste modo, os métodos tradicionais para testar a significância dos efeitos, isto é, o teste <span class="math inline">\(t\)</span> e a ANOVA não podem ser realizados.</p>
<p>Pode-se testar a significância dos efeitos utilizando o pseudo erro padrão de Lenth. Sejam <span class="math inline">\(E_1\)</span>, <span class="math inline">\(E_2\)</span>…, <span class="math inline">\(E_{N-1}\)</span> os efeitos estimados em um fatorial <span class="math inline">\(2^k\)</span> não replicado. Seja <span class="math inline">\(s_0\)</span>, onde <span class="math inline">\(\widetilde{|E_j|}\)</span> é a mediana dos efeitos padonizados.</p>
<p><span class="math display">\[
s_0 = 1,5\widetilde{|E_j|}
\]</span></p>
<p>Então, o pseudo erro padrão de Lenth (<em>pseudo standard error</em>- PSE) é calculado de forma análoga, porém considerando apenas os efeitos esparsos. Estes efeitos desprezíveis são levados em consideração no cálculo, conforme <a href="#eq-pse" class="quarto-xref">Equação&nbsp;<span>6.1</span></a>, visto que podem representar o erro aleatório do processo em estudo.</p>
<p><span id="eq-pse"><span class="math display">\[
PSE = 1,5\underbrace{\widetilde{|E_j|}}_{|E_j|&lt;2,5s_0}
\tag{6.1}\]</span></span></p>
<p>Define-se um intervalo de 0,95 de confiança para o erro, com o limite denominado de erro marginal, <span class="math inline">\(ME\)</span>, conforme <a href="#eq-me" class="quarto-xref">Equação&nbsp;<span>6.2</span></a>. Pode-se também construir um intervalo de confiança para o i-ésimo efeito como <span class="math inline">\(E_j \pm ME\)</span>.</p>
<p><span id="eq-me"><span class="math display">\[
ME= t_{(0,975;m/3)}PSE
\tag{6.2}\]</span></span></p>
<p>Quando o número de efeitos <span class="math inline">\(N-1\)</span> testados é alto, pode acontecer de efeitos inativos serem significativos. Deste modo, pode-se usar como alternativa a margem de erro simultânea, <span class="math inline">\(SME\)</span>, conforme <a href="#eq-sme" class="quarto-xref">Equação&nbsp;<span>6.3</span></a>, onde <span class="math inline">\(\gamma = (1+0,95^{1/m})/2\)</span>.</p>
<p><span id="eq-sme"><span class="math display">\[
SME= t_{(\gamma;m/3)}PSE
\tag{6.3}\]</span></span></p>
<p>O pacote <code>unrepx</code> do R, de autoria do próprio Lenth, pode ser utilizado para análise da significância dos efeitos considerando o pseudo erro padrão.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># carregando o pacote unrepx</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(unrepx)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Primeiramente, deve-se tomar os efeitos, <span class="math inline">\(E_1\)</span>, …, <span class="math inline">\(E_{N-1}\)</span>. O comando <code>yates</code> do pacote <code>unrepx</code> permite a estimativa dos efeitos sem a necessidade da matriz <span class="math inline">\(\textbf{X}\)</span>, conforme segue.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Efeitos</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>efeitos <span class="ot">&lt;-</span> <span class="fu">yates</span>(y)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>efeitos</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     A      B     AB      C     AC     BC    ABC      D     AD     BD    ABD 
16,950  3,100  2,275 11,675 -3,400  0,850 -1,825  5,625  5,900 -2,700 -2,325 
    CD    ACD    BCD   ABCD 
 2,125 -0,650  3,350 -3,325 
attr(,"mean")
        
60,4875 </code></pre>
</div>
</div>
<p>O chamado <em>half normal plot</em> ou gráfico de Daniel, permite observar os efeitos mais importantes. Neste gráfico, os efeitos são plotados de forma padronizada e ordenada em relação aos quantis da distribuição normal. Quanto maior o desvio da reta onde devem se encontrar os efeitos esparços, mais importante o efeito. Entretanto, ele funciona melhor quando há poucos efeitos influentes entre os <span class="math inline">\(N-1\)</span> estimados. Os efeitos positivos são plotados em vermelho e os negativos em azul. Para o <a href="#exm-fatunrep1" class="quarto-xref">Exemplo&nbsp;<span>6.2</span></a> o <em>half normal plot</em> é apresentado na <a href="#fig-halfeflu" class="quarto-xref">Figura&nbsp;<span>6.1</span></a>. Pode-se concluir que os efeitos A e C são significativos considerando o erro marginal de Lenth.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hnplot</span>(efeitos, <span class="at">half =</span> T, <span class="at">method =</span> <span class="st">"Lenth"</span>, <span class="at">ID =</span> <span class="fu">ME</span>(efeitos))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-halfeflu" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-halfeflu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06-fatunrep_frac_files/figure-html/fig-halfeflu-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-halfeflu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.1: Half normal plot para os efeitos no experimento de tratamento de efluentes
</figcaption>
</figure>
</div>
</div>
</div>
<p>O gráfico de Pareto tem sido comumente utilizado para plotar os efeitos em relação ao erro marginal, <span class="math inline">\(ME\)</span>, e ao erro marginal simultâneo, <span class="math inline">\(SME\)</span>. Para o <a href="#exm-fatunrep1" class="quarto-xref">Exemplo&nbsp;<span>6.2</span></a> o gráfico de Pareto é plotado na <a href="#fig-paretoeflu" class="quarto-xref">Figura&nbsp;<span>6.2</span></a>. Pelo primeiro critério temos a mesma conclusão obtida pelo método gráfico de Daniel, enquanto pelo segundo critério apenas o efeito do fator A é significativo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pareto PSE plot</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">parplot</span>(efeitos, <span class="at">method =</span> <span class="st">"Lenth"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-paretoeflu" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-paretoeflu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06-fatunrep_frac_files/figure-html/fig-paretoeflu-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-paretoeflu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.2: Gráfico de Pareto dos efeitos padronizados para o exemplo
</figcaption>
</figure>
</div>
</div>
</div>
<p>Finalmente, é possível resumir a análise da significância dos efeitos, conforme segue. O valor da estatística calculada <span class="math inline">\(t\)</span> é obtido tomando a razão entre o efeito e o pseudo erro padrão de Lenth, isto é, <span class="math inline">\(t_j = E_j/PSE\)</span>. As conclusões são as mesmas das obtidas graficamente considerando o p-valor para <span class="math inline">\(ME\)</span> e para o <span class="math inline">\(SME\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Análise da significância dos efeitos</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">eff.test</span>(efeitos, <span class="at">method =</span> <span class="st">"Lenth"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     effect Lenth_PSE t.ratio p.value simult.pval
A    16,950      4,05   4,185  0,0054      0,0502
C    11,675      4,05   2,883  0,0193      0,1815
AD    5,900      4,05   1,457  0,1425      0,8350
D     5,625      4,05   1,389  0,1598      0,8759
AC   -3,400      4,05  -0,840  0,3697      1,0000
BCD   3,350      4,05   0,827  0,3772      1,0000
ABCD -3,325      4,05  -0,821  0,3809      1,0000
B     3,100      4,05   0,765  0,4132      1,0000
BD   -2,700      4,05  -0,667  0,5388      1,0000
ABD  -2,325      4,05  -0,574  0,5976      1,0000
AB    2,275      4,05   0,562  0,6057      1,0000
CD    2,125      4,05   0,525  0,6301      1,0000
ABC  -1,825      4,05  -0,451  0,6793      1,0000
BC    0,850      4,05   0,210  0,8480      1,0000
ACD  -0,650      4,05  -0,160  0,8829      1,0000</code></pre>
</div>
</div>
<p>Outra possibilidade em relação ao fatorial <span class="math inline">\(2^k\)</span> não replicado é a estimativa do erro experimental utilizando graus de liberdade dos efeitos esparços desconsiderados. Para proceder desta forma podemos retomar o uso do pacote <code>FrF2</code>. Fazando a análise com o comando <code>lm</code> deste pacote apenas os efeitos de até segunda ordem são estimados. Consequentemente, a soma dos quadrados e os graus de liberdade dos erros são obtidos considerando os efeitos de terceira ordem ou maior. O resultado abaixo expõe o modelo de regressão e o teste t para os coeficientes. Os efeitos significativos foram os do Tempo e da Corrente, os mesmos significativos via <span class="math inline">\(ME\)</span> de Lenth. Caso o experimentador queira continuar a investigação para procurar região de curvatura e um modelo quadrático, pode-se o modelo com interações de até segunda ordem é uma boa opção, além de ser de fácil interpretação.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Análise via FrF2</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>lm_eflu <span class="ot">&lt;-</span> <span class="fu">lm</span>(plan_eflu)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_eflu)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of observations used: 16 
Formula:
y ~ (Tem + Vaz + Cor + DQO)^2

Call:
lm.default(formula = fo, data = model.frame(fo, data = formula))

Residuals:
      1       2       3       4       5       6       7       8       9      10 
-0,9375 -2,4125  1,5875  1,7625  3,2625  0,0875 -3,9125  0,5625  2,7625  0,5875 
     11      12      13      14      15      16 
-3,4125  0,0625 -5,0875  1,7375  5,7375 -2,3875 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   60,487      1,254  48,246 7,23e-08 ***
Tem1           8,475      1,254   6,760  0,00108 ** 
Vaz1           1,550      1,254   1,236  0,27125    
Cor1           5,838      1,254   4,656  0,00555 ** 
DQO1           2,812      1,254   2,243  0,07490 .  
Tem1:Vaz1      1,137      1,254   0,907  0,40586    
Tem1:Cor1     -1,700      1,254  -1,356  0,23314    
Tem1:DQO1      2,950      1,254   2,353  0,06532 .  
Vaz1:Cor1      0,425      1,254   0,339  0,74839    
Vaz1:DQO1     -1,350      1,254  -1,077  0,33076    
Cor1:DQO1      1,062      1,254   0,847  0,43541    
---
Signif. codes:  0 '***' 0,001 '**' 0,01 '*' 0,05 '.' 0,1 ' ' 1

Residual standard error: 5,015 on 5 degrees of freedom
Multiple R-squared:  0,9439,    Adjusted R-squared:  0,8317 
F-statistic: 8,413 on 10 and 5 DF,  p-value: 0,01486</code></pre>
</div>
</div>
<p>Outra possibilidade é utilizar o comando <code>lm</code> para obter um modelo completo e reduzir o modelo. Pode-se também selecionar o modelo considerando a simplicidade na interpretação. Pelas análises realizadas o modelo reduzido com o comando <code>step</code> via opção <code>backward</code> presentou o maior ajuste, com menor AIC e maior coeficiente de determinação múltipla ajustado, <span class="math inline">\(R_{aj}^2 = 0,8464\)</span>. É importante recortdar que antes de aplicar o comando <code>step</code>, devse-se remover um coeficiente manualmente, sempre o de maior ordem.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo completo</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>lm_eflu2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> (Tem <span class="sc">+</span> Vaz <span class="sc">+</span> Cor <span class="sc">+</span> DQO)<span class="sc">^</span><span class="dv">4</span>, <span class="at">data =</span> plan_eflu)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_eflu2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm.default(formula = y ~ (Tem + Vaz + Cor + DQO)^4, data = plan_eflu)

Residuals:
ALL 16 residuals are 0: no residual degrees of freedom!

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)          60,4875        NaN     NaN      NaN
Tem1                  8,4750        NaN     NaN      NaN
Vaz1                  1,5500        NaN     NaN      NaN
Cor1                  5,8375        NaN     NaN      NaN
DQO1                  2,8125        NaN     NaN      NaN
Tem1:Vaz1             1,1375        NaN     NaN      NaN
Tem1:Cor1            -1,7000        NaN     NaN      NaN
Tem1:DQO1             2,9500        NaN     NaN      NaN
Vaz1:Cor1             0,4250        NaN     NaN      NaN
Vaz1:DQO1            -1,3500        NaN     NaN      NaN
Cor1:DQO1             1,0625        NaN     NaN      NaN
Tem1:Vaz1:Cor1       -0,9125        NaN     NaN      NaN
Tem1:Vaz1:DQO1       -1,1625        NaN     NaN      NaN
Tem1:Cor1:DQO1       -0,3250        NaN     NaN      NaN
Vaz1:Cor1:DQO1        1,6750        NaN     NaN      NaN
Tem1:Vaz1:Cor1:DQO1  -1,6625        NaN     NaN      NaN

Residual standard error: NaN on 0 degrees of freedom
Multiple R-squared:      1, Adjusted R-squared:    NaN 
F-statistic:   NaN on 15 and 0 DF,  p-value: NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo de terceira ordem</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>lm_eflu3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> (Tem <span class="sc">+</span> Vaz <span class="sc">+</span> Cor <span class="sc">+</span> DQO)<span class="sc">^</span><span class="dv">3</span>, <span class="at">data =</span> plan_eflu)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_eflu3)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm.default(formula = y ~ (Tem + Vaz + Cor + DQO)^3, data = plan_eflu)

Residuals:
     1      2      3      4      5      6      7      8      9     10     11 
-1,663  1,663  1,663 -1,663  1,663 -1,663 -1,663  1,663  1,663 -1,663 -1,663 
    12     13     14     15     16 
 1,663 -1,663  1,663  1,663 -1,663 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)     60,4875     1,6625  36,383   0,0175 *
Tem1             8,4750     1,6625   5,098   0,1233  
Vaz1             1,5500     1,6625   0,932   0,5223  
Cor1             5,8375     1,6625   3,511   0,1766  
DQO1             2,8125     1,6625   1,692   0,3399  
Tem1:Vaz1        1,1375     1,6625   0,684   0,6180  
Tem1:Cor1       -1,7000     1,6625  -1,023   0,4929  
Tem1:DQO1        2,9500     1,6625   1,774   0,3267  
Vaz1:Cor1        0,4250     1,6625   0,256   0,8407  
Vaz1:DQO1       -1,3500     1,6625  -0,812   0,5658  
Cor1:DQO1        1,0625     1,6625   0,639   0,6380  
Tem1:Vaz1:Cor1  -0,9125     1,6625  -0,549   0,6804  
Tem1:Vaz1:DQO1  -1,1625     1,6625  -0,699   0,6115  
Tem1:Cor1:DQO1  -0,3250     1,6625  -0,195   0,8771  
Vaz1:Cor1:DQO1   1,6750     1,6625   1,008   0,4976  
---
Signif. codes:  0 '***' 0,001 '**' 0,01 '*' 0,05 '.' 0,1 ' ' 1

Residual standard error: 6,65 on 1 degrees of freedom
Multiple R-squared:  0,9803,    Adjusted R-squared:  0,7041 
F-statistic: 3,549 on 14 and 1 DF,  p-value: 0,3961</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo reduzido via backward</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>lm_eflu3_red <span class="ot">&lt;-</span> <span class="fu">step</span>(lm_eflu3, <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">trace=</span><span class="cn">FALSE</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_eflu3_red)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm.default(formula = y ~ Tem + Vaz + Cor + DQO + Tem:Vaz + Tem:Cor + 
    Tem:DQO + Vaz:Cor + Vaz:DQO + Cor:DQO + Tem:Vaz:Cor + Tem:Vaz:DQO + 
    Vaz:Cor:DQO, data = plan_eflu)

Residuals:
     1      2      3      4      5      6      7      8      9     10     11 
-1,338  1,338  1,988 -1,988  1,338 -1,338 -1,988  1,988  1,338 -1,338 -1,988 
    12     13     14     15     16 
 1,988 -1,338  1,338  1,988 -1,988 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     60,4875     1,1978  50,498 0,000392 ***
Tem1             8,4750     1,1978   7,075 0,019396 *  
Vaz1             1,5500     1,1978   1,294 0,324939    
Cor1             5,8375     1,1978   4,873 0,039619 *  
DQO1             2,8125     1,1978   2,348 0,143378    
Tem1:Vaz1        1,1375     1,1978   0,950 0,442525    
Tem1:Cor1       -1,7000     1,1978  -1,419 0,291638    
Tem1:DQO1        2,9500     1,1978   2,463 0,132804    
Vaz1:Cor1        0,4250     1,1978   0,355 0,756652    
Vaz1:DQO1       -1,3500     1,1978  -1,127 0,376763    
Cor1:DQO1        1,0625     1,1978   0,887 0,468646    
Tem1:Vaz1:Cor1  -0,9125     1,1978  -0,762 0,525754    
Tem1:Vaz1:DQO1  -1,1625     1,1978  -0,971 0,434167    
Vaz1:Cor1:DQO1   1,6750     1,1978   1,398 0,296886    
---
Signif. codes:  0 '***' 0,001 '**' 0,01 '*' 0,05 '.' 0,1 ' ' 1

Residual standard error: 4,791 on 2 degrees of freedom
Multiple R-squared:  0,9795,    Adjusted R-squared:  0,8464 
F-statistic: 7,357 on 13 and 2 DF,  p-value: 0,1259</code></pre>
</div>
</div>
<p>A análise dos resíduos pode ser realizada conforme código à seguir. Escolhemos o modelo de segunda ordem como modelo final. Pelo p-valor do teste de Shapiro-Wilk, não há indícios para rejeição da hipótese nula de normalidade dos resíduos. A <a href="#fig-resieflu" class="quarto-xref">Figura&nbsp;<span>6.3</span></a> apresenta os gráficos de resíduos para o modelo de segunda ordem.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  resi_eflu
W = 0,97825, p-value = 0,9482</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-resieflu" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-resieflu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06-fatunrep_frac_files/figure-html/fig-resieflu-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-resieflu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.3: Gráfico de resíduos para experimento do tratamento de efluentes, modelo com termos de até segunda ordem
</figcaption>
</figure>
</div>
</div>
</div>
<p>Pode-se também plotar os efeitos principais significativos graficamente utilizando, por exemplo, o pacote <code>ggplot2</code>, conforme feito no capítulo anterior. A <a href="#fig-maineffelu" class="quarto-xref">Figura&nbsp;<span>6.4</span></a> apresenta os efeitos principais dos fatores significativos Tempo e Corrente. Pode-se observar que ambos apresentaram efeito positivo, de forma que o aumento destes garante o aumento da eficiência do tratamento.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-maineffelu" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-maineffelu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06-fatunrep_frac_files/figure-html/fig-maineffelu-1.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-maineffelu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.4: Gráfico de efeitos principais para Tempo e Corrente para o experimento do tratamento de efluentes
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <a href="#fig-contunrep" class="quarto-xref">Figura&nbsp;<span>6.5</span></a> ilustra o gráfico de contorno para o modelo reduzido. Considerou-se apenas os efeitos mais importantes neste caso. Observa-se maior rendimento com corrente e tempo mais alto.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-contunrep" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-contunrep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06-fatunrep_frac_files/figure-html/fig-contunrep-1.png" class="img-fluid figure-img" width="336">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-contunrep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.5: Gráfico de contorno do tamanho de grão em função de X2 e X3, com X1 = 1000 e X1 = 1150 ºC
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="bloco-e-confundimento-no-fatorial-2k" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="bloco-e-confundimento-no-fatorial-2k"><span class="header-section-number">6.3</span> Bloco e confundimento no fatorial <span class="math inline">\(2^k\)</span></h2>
<p>Em diversas situações não é possível realizar todas os <span class="math inline">\(N\)</span> experimentos em condições homogêneas, mesmo com múltiplos fatores em estudo. Nestes casos deve-se planejar o experimento de forma a evitar que o efeito de fontes de variação adicionais seja confundido com os efeitos dos fatores em avaliação ou inflem o erro experimental. A <em>blocagem</em> pode ser útil também no contexto do fatorial <span class="math inline">\(2^k\)</span>.</p>
<p>A blocagem é um conceito muito útil no fatorial <span class="math inline">\(2^k\)</span> e em outros planejamentos envolvendo multiplos fatores, como alguns de superfície de resposta. Um planejamento pode ser dividido de forma sistemática em dois ou mais blocos, de acordo com o número de níveis da condição heterogênea em avaliação a ser blocada.</p>
<div>
<div id="exm-fatunrep1" class="theorem example">
<p><span class="theorem-title"><strong>Exemplo 6.2</strong></span> Suponha que um fatorial <span class="math inline">\(2^2\)</span> com <span class="math inline">\(n=2\)</span> réplicas será realizado para estudar o efeito do tempo e da temperatura no tratamento térmico de uma liga. Suponha que o experimentador tem quatro corpos de prova de um lote e quatro corpos de prova de outro lote, ambos da mesma liga e fornecidos pelo mesmo fornecedor. Apesar da garantia do fornecedor de homogeneidade entre os lotes, o analista decide blocar os lotes, de forma a evitar que o efeito de uma possível diferença entre estes lotes afete os resultados do experimento. Uma vez que o número de corpos de prova de cada lote corresponde a uma replicação completa, cada bloco, isto é, cada lote da liga pode corresponder a uma replicação. Os dados do exemplo são resumidos na <a href="#tbl-blockrep" class="quarto-xref">Tabela&nbsp;<span>6.2</span></a>.</p>
</div>
</div>
<div class="cell">
<div id="tbl-blockrep" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-blockrep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.2: Planejamento fatorial 2^2, bloco na replicação
</figcaption>
<div aria-describedby="tbl-blockrep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Ordem</th>
<th style="text-align: right;">Blocos</th>
<th style="text-align: right;"><em>x</em><sub>1</sub></th>
<th style="text-align: right;"><em>x</em><sub>2</sub></th>
<th style="text-align: right;">Dureza [HRC]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">48</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">53</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">51</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">54</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">54</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">53</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">57</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A blocagem na replicação pode ser considerada na ANOVA com soma dos quadrados definida conforme <a href="#eq-ssbl" class="quarto-xref">Equação&nbsp;<span>6.4</span></a>, com número de graus de liberdade <span class="math inline">\(DF_{blocos} = n_{blocos}-1\)</span>.</p>
<p><span id="eq-ssbl"><span class="math display">\[
SS_{blocos}= \sum_{i=1}^{n_{blocos}}\frac{B_i^2}{2^k}-\frac{y_{...}^2}{n2^k}
\tag{6.4}\]</span></span></p>
<p>Para gerar este planejamento utilizando o pacote <code>FrF2</code> do R pode-se utilizar o código à seguir.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Planejamento</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>plan_block <span class="ot">&lt;-</span> <span class="fu">FrF2</span>(<span class="at">nruns =</span> <span class="dv">4</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nfactors =</span> <span class="dv">2</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">randomize =</span> F,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">replications =</span> <span class="dv">2</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Resposta</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>dureza <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">48</span>, <span class="dv">53</span>, <span class="dv">51</span>, <span class="dv">54</span>, <span class="dv">50</span>, <span class="dv">54</span>, <span class="dv">53</span>, <span class="dv">57</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>plan_block <span class="ot">&lt;-</span> <span class="fu">add.response</span>(plan_block,dureza)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>plan_block</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  run.no run.no.std.rp  A  B Blocks dureza
1      1           1.1 -1 -1     .1     48
2      2           2.1  1 -1     .1     53
3      3           3.1 -1  1     .1     51
4      4           4.1  1  1     .1     54
5      5           1.2 -1 -1     .2     50
6      6           2.2  1 -1     .2     54
7      7           3.2 -1  1     .2     53
8      8           4.2  1  1     .2     57
class=design, type= full factorial 
NOTE: columns run.no and run.no.std.rp  are annotation, 
 not part of the data frame</code></pre>
</div>
</div>
<p>Pode-se observar que a coluna blocos já é adicionada no planejamento sem necessidade de algum argumento adicional. A análise deve considerar o termo <code>Blocks</code> no modelo, conforme segue. Observando o resultado do modelo linear, o termo <code>Blocks.2</code> refere-se ao segundo nível do bloco, sendo adicionado no modelo a diferença entre médias deste nível e do primeiro na previsão, no caso de se prever os resultados dos ensaios no segundo bloco. Logo, o bloco é tratado segundo uma variável categórica na análise. Para o exemplo esta diferença média entre blocos é igual a 2 HRC. Pode-se concluir que neste caso houve significância do fator blocos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Análise fatorial 2^k com bloco na replicação</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo linear</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>lm_block <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> dureza <span class="sc">~</span> Blocks <span class="sc">+</span> A<span class="sc">*</span>B, </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> plan_block)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_block)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm.default(formula = dureza ~ Blocks + A * B, data = plan_block)

Residuals:
         1          2          3          4          5          6          7 
-1,099e-14  5,000e-01  4,026e-15 -5,000e-01  1,092e-14 -5,000e-01 -3,926e-15 
         8 
 5,000e-01 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  51,5000     0,2887 178,401 3,88e-07 ***
Blocks.2      2,0000     0,4082   4,899  0,01628 *  
A1            2,0000     0,2041   9,798  0,00226 ** 
B1            1,2500     0,2041   6,124  0,00875 ** 
A1:B1        -0,2500     0,2041  -1,225  0,30807    
---
Signif. codes:  0 '***' 0,001 '**' 0,01 '*' 0,05 '.' 0,1 ' ' 1

Residual standard error: 0,5774 on 3 degrees of freedom
Multiple R-squared:  0,9815,    Adjusted R-squared:  0,9568 
F-statistic: 39,75 on 4 and 3 DF,  p-value: 0,00623</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>anova_block <span class="ot">&lt;-</span> <span class="fu">aov</span>(lm_block)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_block)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value  Pr(&gt;F)   
Blocks       1    8,0    8,00    24,0 0,01628 * 
A            1   32,0   32,00    96,0 0,00226 **
B            1   12,5   12,50    37,5 0,00875 **
A:B          1    0,5    0,50     1,5 0,30807   
Residuals    3    1,0    0,33                   
---
Signif. codes:  0 '***' 0,001 '**' 0,01 '*' 0,05 '.' 0,1 ' ' 1</code></pre>
</div>
</div>
<p>A <a href="#fig-dureza" class="quarto-xref">Figura&nbsp;<span>6.6</span></a> apresenta os gráficos de efeitos principais para os fatores A, B e bloco na resposta. O código para obter os gráficos é exposto à seguir. Apesar de não se desejar estudar o efeito do bloco, é importante observar que o bloco 2 apresenta dureza média mais alta em relação ao 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>plan_block<span class="sc">$</span>fit <span class="ot">&lt;-</span> lm_block<span class="sc">$</span>fitted.values</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>plan_dec_x1 <span class="ot">&lt;-</span> plan_block <span class="sc">|&gt;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(A, <span class="at">group=</span><span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">y =</span> <span class="fu">mean</span>(fit)) <span class="sc">|&gt;</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="sc">!</span>y, as.factor))</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>plan_dec_x2 <span class="ot">&lt;-</span> plan_block <span class="sc">|&gt;</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(B, <span class="at">group=</span><span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">y =</span> <span class="fu">mean</span>(fit)) <span class="sc">|&gt;</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="sc">!</span>y, as.factor))</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>plan_dec_bl <span class="ot">&lt;-</span> plan_block <span class="sc">|&gt;</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Blocks, <span class="at">group=</span><span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">y =</span> <span class="fu">mean</span>(fit)) <span class="sc">|&gt;</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="sc">!</span>y, as.factor))</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>range_y <span class="ot">&lt;-</span> (<span class="fu">c</span>(<span class="fu">min</span>(plan_dec_x1<span class="sc">$</span>y,plan_dec_x2<span class="sc">$</span>y, plan_dec_bl<span class="sc">$</span>y),</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>              <span class="fu">max</span>(plan_dec_x1<span class="sc">$</span>y,plan_dec_x2<span class="sc">$</span>y, plan_dec_bl<span class="sc">$</span>y)))</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>px1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plan_dec_x1 , </span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>A, <span class="at">y=</span>y, <span class="at">group=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">col=</span><span class="st">"#00AFBB"</span>,<span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col=</span><span class="st">"#00AFBB"</span>,<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(range_y) <span class="sc">+</span> </span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"A"</span>)</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>px2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plan_dec_x2,</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>B, <span class="at">y=</span>y, <span class="at">group=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">col=</span><span class="st">"#E7B800"</span>,<span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col=</span><span class="st">"#E7B800"</span>,<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(range_y) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"B"</span>)</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>pbl<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plan_dec_bl,</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>Blocks, <span class="at">y=</span>y, <span class="at">group=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">col=</span><span class="st">"#FC4E07"</span>,<span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col=</span><span class="st">"#FC4E07"</span>,<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(range_y) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Bloco"</span>)</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Arranjando os gráficos em um único painel</span></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(px1,px2,pbl, <span class="at">ncol=</span><span class="dv">3</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-dureza" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dureza-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06-fatunrep_frac_files/figure-html/fig-dureza-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dureza-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.6: Efeitos principais para o experimento de tratamento térmico
</figcaption>
</figure>
</div>
</div>
</div>
<p>Caso o experimentador deseje constatar a diferença no modelo quando o bloco não é considerado, basta fazer a análise sem o termo <code>Blocks</code>, conforme resultado abaixo. Pode-se observar que a diferença entre os blocos inflará o erro experimental, mesmo o erro sendo estimado com mais graus de liberdade, dada a significância da variável blocada. Neste sentido, ao desconsiderar a variável blocada no modelo, perde-se qualidade do modelo, conforme pode-se constatar pelas medidas de ajuste.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm.default(formula = dureza ~ A * B, data = plan_block)

Residuals:
   1    2    3    4    5    6    7    8 
-1,0 -0,5 -1,0 -1,5  1,0  0,5  1,0  1,5 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  52,5000     0,5303  98,995 6,24e-08 ***
A1            2,0000     0,5303   3,771   0,0196 *  
B1            1,2500     0,5303   2,357   0,0779 .  
A1:B1        -0,2500     0,5303  -0,471   0,6619    
---
Signif. codes:  0 '***' 0,001 '**' 0,01 '*' 0,05 '.' 0,1 ' ' 1

Residual standard error: 1,5 on 4 degrees of freedom
Multiple R-squared:  0,8333,    Adjusted R-squared:  0,7083 
F-statistic: 6,667 on 3 and 4 DF,  p-value: 0,04909</code></pre>
</div>
</div>
<p>No caso onde deseja-se blocar uma determinada variável em um fatorial com número de níveis da variável a ser blocada maior que o número de réplicas, deve-se utilizar do confundimento. O confundimento é uma técnica para dividir os experimentos do fatorial <span class="math inline">\(2^k\)</span> em blocos de forma menos prejudicial, quando não é possível blocar nas replicações. Neste caso aloca-se uma fração do planejamento em cada bloco. A escolha desta fração acarreta um confundimento com um dos efeitos a ser estimado no fatorial <span class="math inline">\(2^k\)</span>. Respeitando a hierarquia dos efeitos, deve-se sempre alocar os níveis da variável blocada na interação de maior ordem.</p>
<p>A <a href="#fig-fatconf" class="quarto-xref">Figura&nbsp;<span>6.7</span></a> ilustra um fatorial <span class="math inline">\(2^3\)</span> com bloco com confundimento em dois níveis. O princípio de hierarquia dos efeitos garante que os efeitos de ordem mais baixa são os mais importantes. Já pelo princípio da esparcidade dos efeitos na maioria dos estudos poucos efeitos explicam a maior proporção da variabilidade dos dados na resposta de interesse. Portanto, espera-se que poucos efeitos e de menor ordem sejam mais importantes. Neste sentido, para o fatorial <span class="math inline">\(2^3\)</span> não replicado com bloco em dois níveis, o confundimento deve ser alocado na interação de maior ordem, <span class="math inline">\(x_1x_2x_3\)</span>, conforme a <a href="#tbl-23conf" class="quarto-xref">Tabela&nbsp;<span>6.3</span></a>. O bloco destacado em azul na <a href="#fig-fatconf" class="quarto-xref">Figura&nbsp;<span>6.7</span></a> corresponde a <span class="math inline">\(x_1x_2x_3=-1\)</span>, enquanto o amarelo correponde a <span class="math inline">\(x_1x_2x_3=+1\)</span> na <a href="#tbl-23conf" class="quarto-xref">Tabela&nbsp;<span>6.3</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-fatconf" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fatconf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/blockconf.png" style="width:2.5in;height:2in" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fatconf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.7: Fatorial <span class="math inline">\(2^3\)</span> com confundimento em dois níveis
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div id="tbl-23conf" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-23conf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.3: Planejamento fatorial 2^3 com confundimento
</figcaption>
<div aria-describedby="tbl-23conf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Ordem</th>
<th style="text-align: right;">x1</th>
<th style="text-align: right;">x2</th>
<th style="text-align: right;">x3</th>
<th style="text-align: right;">Bloco = x1x2x3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">-1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">-1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>É importante entender além de como alocar blocos com confundimento, como realizar a análise. Seja o <a href="#exm-blockconf" class="quarto-xref">Exemplo&nbsp;<span>6.3</span></a>, à seguir.</p>
<div id="exm-blockconf" class="theorem example">
<p><span class="theorem-title"><strong>Exemplo 6.3</strong></span> Um planejamento fatorial <span class="math inline">\(2^4\)</span> foi utilizado no estudo da síntese por deposição química a vapor de acetileno. Foram estudados os efeitos do tempo de crescimento (45, 60 min), da temperatura de crescimento (700, 750 °C), da vazão de acetileno (150, 190 ml/min) e da vazão de argônio (230, 290 ml/min). O catalisador bimetálico FeCo foi utilizado na síntese. Supondo que o experimentador tinha disponível quantidade suficiente de um primeiro lote do catalisador para oito experimentos e quantidade suficientes de um segundo lote para oito experimentos, ele decidiu blocar esta variável. Deve-se definir o confundimento menos prejudicial de forma a alocar os níveis dos blocos.</p>
</div>
<div class="cell">
<div id="tbl-blockconf" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-blockconf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.4: Planejamento fatorial 2^4, confundimento
</figcaption>
<div aria-describedby="tbl-blockconf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 5%">
<col style="width: 26%">
<col style="width: 25%">
<col style="width: 16%">
<col style="width: 11%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Ordem</th>
<th style="text-align: right;">Fluxo de Acetileno [ml/min]</th>
<th style="text-align: right;">Fluxo de Argônio [ml/min]</th>
<th style="text-align: right;">Temperatura [ºC]</th>
<th style="text-align: right;">Tempo [min]</th>
<th style="text-align: right;">Rendimento [%]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">700</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">48</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">700</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">53</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">230</td>
<td style="text-align: right;">700</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">51</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">230</td>
<td style="text-align: right;">700</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">54</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">750</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">750</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">54</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">230</td>
<td style="text-align: right;">750</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">53</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">230</td>
<td style="text-align: right;">750</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">57</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">700</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">48</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">700</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">53</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">230</td>
<td style="text-align: right;">700</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">51</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">230</td>
<td style="text-align: right;">700</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">54</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">750</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="even">
<td style="text-align: right;">14</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">750</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">54</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15</td>
<td style="text-align: right;">150</td>
<td style="text-align: right;">230</td>
<td style="text-align: right;">750</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">53</td>
</tr>
<tr class="even">
<td style="text-align: right;">16</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">230</td>
<td style="text-align: right;">750</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">57</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Para entender a melhor forma de obter o confundimento neste planejamento, é importante considerar a matriz <span class="math inline">\(X\)</span>. Para obtê-la no R, pode-se utilizar o comando <code>model.matrix</code>, conforme código à seguir. A forma menos prejudicial neste caso é confundir o bloco com a interação de quarta ordem <span class="math inline">\(x_1x_2x_3x_4\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># construindo a matrix X</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>plan2<span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(levels,levels,levels,levels)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(plan2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"x1"</span>,<span class="st">"x2"</span>,<span class="st">"x3"</span>,<span class="st">"x4"</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># matriz do planejamento</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>x1<span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4,<span class="at">data=</span>plan2)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>X</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept) x1 x2 x3 x4 x1:x2 x1:x3 x2:x3 x1:x4 x2:x4 x3:x4 x1:x2:x3
1            1 -1 -1 -1 -1     1     1     1     1     1     1       -1
2            1  1 -1 -1 -1    -1    -1     1    -1     1     1        1
3            1 -1  1 -1 -1    -1     1    -1     1    -1     1        1
4            1  1  1 -1 -1     1    -1    -1    -1    -1     1       -1
5            1 -1 -1  1 -1     1    -1    -1     1     1    -1        1
6            1  1 -1  1 -1    -1     1    -1    -1     1    -1       -1
7            1 -1  1  1 -1    -1    -1     1     1    -1    -1       -1
8            1  1  1  1 -1     1     1     1    -1    -1    -1        1
9            1 -1 -1 -1  1     1     1     1    -1    -1    -1       -1
10           1  1 -1 -1  1    -1    -1     1     1    -1    -1        1
11           1 -1  1 -1  1    -1     1    -1    -1     1    -1        1
12           1  1  1 -1  1     1    -1    -1     1     1    -1       -1
13           1 -1 -1  1  1     1    -1    -1    -1    -1     1        1
14           1  1 -1  1  1    -1     1    -1     1    -1     1       -1
15           1 -1  1  1  1    -1    -1     1    -1     1     1       -1
16           1  1  1  1  1     1     1     1     1     1     1        1
   x1:x2:x4 x1:x3:x4 x2:x3:x4 x1:x2:x3:x4
1        -1       -1       -1           1
2         1        1       -1          -1
3         1       -1        1          -1
4        -1        1        1           1
5        -1        1        1          -1
6         1       -1        1           1
7         1        1       -1           1
8        -1       -1       -1          -1
9         1        1        1          -1
10       -1       -1        1           1
11       -1        1       -1           1
12        1       -1       -1          -1
13        1       -1       -1           1
14       -1        1       -1          -1
15       -1       -1        1          -1
16        1        1        1           1
attr(,"assign")
 [1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15</code></pre>
</div>
</div>
<p>Para gerar um planejamento fatorial <span class="math inline">\(2^k\)</span> com blocagem e confundimento pode-se utilizar o pacote <code>FrF2</code>. Para o <a href="#exm-blockconf" class="quarto-xref">Exemplo&nbsp;<span>6.3</span></a> pode-se utilizar o código à seguir.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Planejamento 2^4 com confundimento</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>plan_conf <span class="ot">&lt;-</span> <span class="fu">FrF2</span>(<span class="at">nruns =</span> <span class="dv">16</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nfactors =</span> <span class="dv">4</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">randomize =</span> F,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">blocks =</span> <span class="dv">2</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Recomenda-se avaliar o planejamento gerado primeiro, </span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># pois o pacote ordena por bloco</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Resposta</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>rend <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">112</span>, <span class="dv">62</span>, <span class="dv">120</span>, <span class="dv">56</span>, <span class="dv">156</span>, <span class="dv">50</span>, <span class="dv">134</span>, <span class="dv">36</span>, <span class="co"># bloco1: x1x2x3x4 = -1</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>          <span class="dv">102</span>, <span class="dv">42</span>, <span class="dv">126</span>, <span class="dv">24</span>, <span class="dv">170</span>, <span class="dv">72</span>, <span class="dv">142</span>, <span class="dv">38</span>) <span class="co"># bloco2: x1x2x3x4 = +1</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>plan_conf <span class="ot">&lt;-</span> <span class="fu">add.response</span>(plan_conf,rend)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>plan_conf</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  run.no run.no.std.rp Blocks  A  B  C  D rend
1      1         2.1.1      1 -1 -1 -1  1  112
2      2         3.1.2      1 -1 -1  1 -1   62
3      3         5.1.3      1 -1  1 -1 -1  120
4      4         8.1.4      1 -1  1  1  1   56
5      5         9.1.5      1  1 -1 -1 -1  156
6      6        12.1.6      1  1 -1  1  1   50
7      7        14.1.7      1  1  1 -1  1  134
8      8        15.1.8      1  1  1  1 -1   36
   run.no run.no.std.rp Blocks  A  B  C  D rend
9       9         1.2.1      2 -1 -1 -1 -1  102
10     10         4.2.2      2 -1 -1  1  1   42
11     11         6.2.3      2 -1  1 -1  1  126
12     12         7.2.4      2 -1  1  1 -1   24
13     13        10.2.5      2  1 -1 -1  1  170
14     14        11.2.6      2  1 -1  1 -1   72
15     15        13.2.7      2  1  1 -1 -1  142
16     16        16.2.8      2  1  1  1  1   38
class=design, type= FrF2.blocked 
NOTE: columns run.no and run.no.std.rp  are annotation, 
 not part of the data frame</code></pre>
</div>
</div>
<p>A soma dos quadrados para a blocagem com confundimento em dois níveis pode ser obtida conforme a <a href="#eq-ssconf" class="quarto-xref">Equação&nbsp;<span>6.5</span></a>.</p>
<p><span id="eq-ssconf"><span class="math display">\[
SS_{blocos}= \frac{(\sum_{bloco=+1}y)^2 - (\sum_{bloco=-1}y)^2}{n2^k/2} - \frac{y_{...}^2}{n2^k}
\tag{6.5}\]</span></span></p>
<p>A análise no R é feita de forma similar à blocagem na replicação, incluindo o fator <code>Blocks</code> no modelo. Portanto, a diferença é na criação do planejamento. No caso da blocagem na replicação não é necessário modificação alguma no planejamento, já na blocagem com confundimento é necessário colocar o argumento <code>blocks</code> com o número de níveis desejado. Logicamente, o número de ensaios <span class="math inline">\(N\)</span> deve ser múltiplo do número de níveis, de forma que as frações alocadas para cada bloco sejam iguais.</p>
<p>Para o <a href="#exm-blockconf" class="quarto-xref">Exemplo&nbsp;<span>6.3</span></a>, a análise é realizada com a sintaxe à seguir. O modelo <code>rend ~ Blocks + (A+B+C+D)^3</code> não contém o termo de quarta ordem, <span class="math inline">\(x_1x_2x_3x_4\)</span>, pois este está confundido com o termo <code>Blocks</code>. De qualquer forma os 16 graus de liberdade foram usados para estimar os efeitos, sem a possibilidade de estimar o erro experimental da forma tradicional.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Análise fatorial 2^k com blocagem e confundimento</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo linear</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>lm_conf <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> rend <span class="sc">~</span> Blocks <span class="sc">+</span> (A<span class="sc">+</span>B<span class="sc">+</span>C<span class="sc">+</span>D)<span class="sc">^</span><span class="dv">3</span>, </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> plan_conf)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_conf)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm.default(formula = rend ~ Blocks + (A + B + C + D)^3, data = plan_conf)

Residuals:
ALL 16 residuals are 0: no residual degrees of freedom!

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   90,125        NaN     NaN      NaN
Blocks1       -0,625        NaN     NaN      NaN
A1             9,625        NaN     NaN      NaN
B1            -5,625        NaN     NaN      NaN
C1           -42,625        NaN     NaN      NaN
D1             0,875        NaN     NaN      NaN
A1:B1         -6,625        NaN     NaN      NaN
A1:C1         -8,125        NaN     NaN      NaN
A1:D1         -2,625        NaN     NaN      NaN
B1:C1         -3,375        NaN     NaN      NaN
B1:D1          3,125        NaN     NaN      NaN
C1:D1         -1,875        NaN     NaN      NaN
A1:B1:C1       3,625        NaN     NaN      NaN
A1:B1:D1      -2,875        NaN     NaN      NaN
A1:C1:D1      -1,375        NaN     NaN      NaN
B1:C1:D1       6,375        NaN     NaN      NaN

Residual standard error: NaN on 0 degrees of freedom
Multiple R-squared:      1, Adjusted R-squared:    NaN 
F-statistic:   NaN on 15 and 0 DF,  p-value: NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># anova_conf &lt;- aov(lm_conf)</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(anova_conf)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Após uma primeira avaliação, pode-se remover alguma interação de ordem maior com efeito menor. Porém, neste estudo, como o bloco não foi significativo, pode-se removê-lo do modelo, conforme segue. Pode-se concluir que os fatores <span class="math inline">\(x_1\)</span> e <span class="math inline">\(x_3\)</span> além da interação entre estes foram significativos. Este modelo também apresentou um excelente ajuste, com <span class="math inline">\(R_{aj}^2 = 0,9973\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Análise fatorial 2^k com blocagem e confundimento</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo linear sem bloco</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>lm_conf3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> rend <span class="sc">~</span> (A<span class="sc">+</span>B<span class="sc">+</span>C<span class="sc">+</span>D)<span class="sc">^</span><span class="dv">3</span>, </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> plan_conf)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_conf3)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm.default(formula = rend ~ (A + B + C + D)^3, data = plan_conf)

Residuals:
     1      2      3      4      5      6      7      8      9     10     11 
 0,625  0,625  0,625  0,625  0,625  0,625  0,625  0,625 -0,625 -0,625 -0,625 
    12     13     14     15     16 
-0,625 -0,625 -0,625 -0,625 -0,625 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)   90,125      0,625   144,2  0,00441 **
A1             9,625      0,625    15,4  0,04128 * 
B1            -5,625      0,625    -9,0  0,07045 . 
C1           -42,625      0,625   -68,2  0,00933 **
D1             0,875      0,625     1,4  0,39486   
A1:B1         -6,625      0,625   -10,6  0,05988 . 
A1:C1         -8,125      0,625   -13,0  0,04887 * 
A1:D1         -2,625      0,625    -4,2  0,14881   
B1:C1         -3,375      0,625    -5,4  0,11657   
B1:D1          3,125      0,625     5,0  0,12567   
C1:D1         -1,875      0,625    -3,0  0,20483   
A1:B1:C1       3,625      0,625     5,8  0,10869   
A1:B1:D1      -2,875      0,625    -4,6  0,13628   
A1:C1:D1      -1,375      0,625    -2,2  0,27160   
B1:C1:D1       6,375      0,625    10,2  0,06221 . 
---
Signif. codes:  0 '***' 0,001 '**' 0,01 '*' 0,05 '.' 0,1 ' ' 1

Residual standard error: 2,5 on 1 degrees of freedom
Multiple R-squared:  0,9998,    Adjusted R-squared:  0,9973 
F-statistic: 392,7 on 14 and 1 DF,  p-value: 0,03954</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># anova_conf3 &lt;- aov(lm_conf3)</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(anova_conf3)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pode-se também utilizar o pacote <code>unrepx</code> para analisar o planejamento fatorial <span class="math inline">\(2^k\)</span> com blocagem e confundimento. Entretano, o analista deve entender em qual interação está alocado o bloco, visto que os resultados deste pacote não especificam. Para o <a href="#exm-blockconf" class="quarto-xref">Exemplo&nbsp;<span>6.3</span></a>, a análise pode ser realizada conforme segue.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resposta na ordem padrão do fatorial</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>rend <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">102</span>, <span class="dv">156</span>, <span class="dv">120</span>, <span class="dv">142</span>, <span class="dv">62</span>, <span class="dv">72</span>, <span class="dv">24</span>, <span class="dv">36</span>, <span class="dv">112</span>, <span class="dv">170</span>, <span class="dv">126</span>, <span class="dv">134</span>, <span class="dv">42</span>, <span class="dv">50</span>, <span class="dv">56</span>, <span class="dv">38</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Efeitos</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>efeitos <span class="ot">&lt;-</span> <span class="fu">yates</span>(rend)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>efeitos</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     A      B     AB      C     AC     BC    ABC      D     AD     BD    ABD 
 19,25 -11,25 -13,25 -85,25 -16,25  -6,75   7,25   1,75  -5,25   6,25  -5,75 
    CD    ACD    BCD   ABCD 
 -3,75  -2,75  12,75  -1,25 
attr(,"mean")
       
90,125 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Análise da significância dos efeitos</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">eff.test</span>(efeitos, <span class="at">method =</span> <span class="st">"Lenth"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     effect Lenth_PSE t.ratio p.value simult.pval
C    -85,25      9,75  -8,744  0,0003      0,0019
A     19,25      9,75   1,974  0,0619      0,4889
AC   -16,25      9,75  -1,667  0,1002      0,6847
AB   -13,25      9,75  -1,359  0,1675      0,8913
BCD   12,75      9,75   1,308  0,1811      0,9108
B    -11,25      9,75  -1,154  0,2294      0,9734
ABC    7,25      9,75   0,744  0,4269      1,0000
BC    -6,75      9,75  -0,692  0,4633      1,0000
BD     6,25      9,75   0,641  0,5558      1,0000
ABD   -5,75      9,75  -0,590  0,5881      1,0000
AD    -5,25      9,75  -0,538  0,6215      1,0000
CD    -3,75      9,75  -0,385  0,7249      1,0000
ACD   -2,75      9,75  -0,282  0,7963      1,0000
D      1,75      9,75   0,179  0,8694      1,0000
ABCD  -1,25      9,75  -0,128  0,9072      1,0000</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-paretoconf" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-paretoconf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06-fatunrep_frac_files/figure-html/fig-paretoconf-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-paretoconf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.8: Gráfico de Pareto para os efeitos no fatorial <span class="math inline">\(2^4\)</span> com confundimento
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="fatorial-fracionado-2k-p" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="fatorial-fracionado-2k-p"><span class="header-section-number">6.4</span> Fatorial fracionado <span class="math inline">\(2^{k-p}\)</span></h2>
<p>Em diversas situações onde o número de fatores de controle é elevado, o custo experimental para executar um planejamento fatorial <span class="math inline">\(2^k\)</span> completo fica elevado, visto que o número de experimentos cresce exponencialmente com o aumento do número de fatores de interesse, <span class="math inline">\(N=2^k\)</span>. Nestes casos pode-se utilizar o planejamento fatorial fracionado <span class="math inline">\(2^{k-p}\)</span> para estudar o processo de interesse. No planejamento fatorial fracionado <span class="math inline">\(2^{k-p}\)</span> apenas uma fração do fatorial <span class="math inline">\(2^k\)</span> é realizada, viabilizando economia na experimentação. Para <span class="math inline">\(p=1\)</span>, tem-se um planejamento com meia fração, já para <span class="math inline">\(p=2\)</span>, tem-se uma fração de um quarto. Apesar da perda de informação decorrente na redução do número de ensaios, há alguns princípios que sustentam o uso do fatorial fracionado <span class="math inline">\(2^{k-p}\)</span>.</p>
<p>Ao realizar apenas uma fração do planejamento, não é possível estimar todos os efeitos do processo em estudo. Entretanto, pelo princípio da hierarquia dos efeitos, os efeitos de menor ordem são mais importantes e devem ser priorizados. Já pelo princípio da esparcidade dos efeitos, geralmente poucos efeitos serão significativos em uma resposta de interesse, enquanto a maior parte dos efeitos será esparça. Logo, considerando estes dois princípios, na maioria dos estudos poucos efeitos e de menor ordem serão significativos na resposta de interesse. A <a href="#fig-esphier" class="quarto-xref">Figura&nbsp;<span>6.9</span></a> ilustra estes princípios.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-esphier" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-esphier-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/espar_hier.png" style="width:5in;height:2.5in" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-esphier-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.9: Princípios da esparcidade e hierarquia dos efeitos
</figcaption>
</figure>
</div>
</div>
</div>
<p>Um conceito fundamental na experimentação que sustenta o uso do planejamento fatorial fracionado é a experimentação sequencial. Geralmente em estudos com muitas variáveis de interesse, torna-se necessário a realização de experimentos inciciais, ditos de varredura (<em>screening experiments</em>). Nestes experimentos deseja-se conhecer os fatores influentes entre muitos existentes. Deste modo, ao realizar o fatorial fracionado <span class="math inline">\(2^{k-p}\)</span> não deseja-se obter resultados conclusivos, mas indícios que demonstrem o caminho a ser seguido nas etapas subsequentes da experimentação. O analista busca com este planejamento reduzir o número de fatores em investigação para depois aplicar outros métodos conclusivos.</p>
<p>Relacionado à questão da experimentação sequencial está a propriedade de projeção. Esta propriedade implica na remoção dos efeitos com menor magnitude do fatorial fracionado <span class="math inline">\(2^{k-p}\)</span>, projetando-o em um fatorial completo <span class="math inline">\(2^k\)</span>. Seja um fatorial fracionado <span class="math inline">\(2^{3-1}\)</span>. Este planejamento contém <span class="math inline">\(k = 3\)</span> fatores, <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span> e <span class="math inline">\(x_3\)</span> e consiste em meia fração do fatorial <span class="math inline">\(2^k\)</span> completo, <span class="math inline">\(p = 1\)</span>. Logo, o número de experimentos realizado é <span class="math inline">\(N=2^{3-1}=4\)</span>. Supondo que após uma primeira análise dos efeitos principais dos três fatores, observa-se que o efeito de um deles, por exemplo de <span class="math inline">\(x_3\)</span>, não é significativo. Sugere-se remover este fator do estudo, projetando o planejamento em um fatorial completo <span class="math inline">\(2^2\)</span>. A <a href="#fig-projecao" class="quarto-xref">Figura&nbsp;<span>6.10</span></a> ilustra a propriedade de projeção.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-projecao" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-projecao-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/projec.png" style="width:5.5in;height:2.5in" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-projecao-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.10: Projeção no fatorial fracionado <span class="math inline">\(2^{k-p}\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Ainda considerando o caso do fatorial fracionado <span class="math inline">\(2^{3-1}\)</span>, com <span class="math inline">\(N = 4\)</span> experimentos, deve-se escolher qual <span class="math inline">\(1/2\)</span> fração menos prejudicial deve ser realizada. Neste caso os níveis do fator <span class="math inline">\(x_3\)</span> devem ser definidos considerando o produto <span class="math inline">\(x_1x_2\)</span>. Isto, logicamente implicará em um confundimento desta interação com o efeito de <span class="math inline">\(x_3\)</span>. A <a href="#tbl-frac31" class="quarto-xref">Tabela&nbsp;<span>6.5</span></a> apresenta este planejamento. Entretanto, há outra possibilidade para o mesmo planejamento fatorial fracionado <span class="math inline">\(2^{3-1}\)</span>, a fração alternativa, definindo o terceiro fator como <span class="math inline">\(x_3=-x_1x_2\)</span>.</p>
<div class="cell">
<div id="tbl-frac31" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-frac31-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.5: Planejamento fatorial fracionado 2^3-1
</figcaption>
<div aria-describedby="tbl-frac31-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">ordem</th>
<th style="text-align: right;"><em>x</em><sub>1</sub></th>
<th style="text-align: right;"><em>x</em><sub>2</sub></th>
<th style="text-align: right;"><em>x</em><sub>3</sub>=<em>x</em><sub>1</sub><em>x</em><sub>2</sub></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">-1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>A <a href="#fig-frac23" class="quarto-xref">Figura&nbsp;<span>6.11</span></a> ilustra a fração principal, <a href="#fig-frac23" class="quarto-xref">Figura&nbsp;<span>6.11</span></a>(a) do planejamento fatorial <span class="math inline">\(2^{3-1}\)</span>, com os experimentos enumerados 5, 2, 3 e 8 correspondentes, respectivamente, aos experimentos 1, 2, 3 e 4 da Tabela <a href="#tbl-frac31" class="quarto-xref">Tabela&nbsp;<span>6.5</span></a>. A <a href="#fig-frac23" class="quarto-xref">Figura&nbsp;<span>6.11</span></a>(b) apresenta a fração alternativa deste planejamento, enquanto a <a href="#fig-frac23" class="quarto-xref">Figura&nbsp;<span>6.11</span></a>(c) apresenta o fatorial completo resultante da composição das duas frações.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-frac23" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-frac23-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/frac23.png" style="width:5in;height:4.5in" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-frac23-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.11: Fatorial fracionado <span class="math inline">\(2^{3-1}\)</span> (a) fração principal; (b) fração alternativa; (fatorial completo <span class="math inline">\(2^3\)</span>)
</figcaption>
</figure>
</div>
</div>
</div>
<p>Considerando ainda o princípio da experimentação sequencial, após realizar <span class="math inline">\(1/2\)</span> fração de um fatorial completo, caso o experimentador constate que todos os efeitos são importantes em magnitude, ele pode completar o planejamento com a outra fração, de forma a obter mais informação acerca dos efeitos em estudo. O experimentador pode neste caso blocar as frações testadas em momentos distintos, para avaliar a significância de uma possível variabilidade entre as estas etapas.</p>
<p>Ao realizar um fatorial fracionado, o analista deve ter em mente que perderá informação em relação aos efeitos possíveis de serem estimados considerando os fatores em análise e suas interações. Tomando o exemplo dos três fatores, no fatorial completo <span class="math inline">\(2^3\)</span> há possibilidade de estimar uma constante, 3 efeitos principais, 3 interações de segunda ordem e uma interação de terceira ordem. Ao realizar um fatorial fracionado <span class="math inline">\(2^{3-1}\)</span>, o analista só poderá estimar <span class="math inline">\(r = 4\)</span> efeitos, uma vez que tem apenas <span class="math inline">\(N=4\)</span> experimentos. Deste modo, o conceito de confundimento está implícito nos fatoriais fracionados, de forma que não é possível estimar um efeito sem este estar confundido com outro de interesse. Deve-se, portanto, avaliar a estrutura de confundimento do planejamento e entender quais as implicações desta estrutura na estimativa dos efeitos.</p>
<p>Seja a estrutura de confundimento do fatorial fracionado <span class="math inline">\(2^{3-1}\)</span>. Sejam os efeitos de <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span> e <span class="math inline">\(x_3\)</span>, A, B e C, respectivamente. Para definir esta estrutura, deve-se considerar a seguinte regra AA = BB = CC = I, onde I é uma constante (não confundir com álgebra matricial). Tomando o gerador C = AB, visto que os níveis de <span class="math inline">\(x_3\)</span> foram gerados considerando a interação <span class="math inline">\(x_1x_2\)</span>, multiplicando ambos os lados por C, tem-se, CC = ABC, resultando em I = ABC. Portanto, I = ABC consiste na relação de definição. A partir desta relação sabe-se que o efeito da constante está confundido com a interação de terceira ordem. Ao multiplicar cada efeito em ambos os lados nesta relação, obtém-se a estrutura de confundimento completa do planejamento fatorial fracionado <span class="math inline">\(2^{3-1}\)</span>, conforme ilustrado na <a href="#fig-estrut" class="quarto-xref">Figura&nbsp;<span>6.12</span></a>. Pode-se constatar que neste planejamento os efeitos principais estão confundidos com as interações de segunda ordem e a constante confundida com a interação de terceira ordem.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-estrut" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-estrut-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/estrconf.png" style="width:4in;height:3in" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-estrut-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.12: Estrutura de confundimento do fatorial fracionado <span class="math inline">\(2^{3-1}\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Outro conceito importante para avaliar o fatorial fracionado <span class="math inline">\(2^{k-p}\)</span> é a resolução. Considerando a estrutura de confundimento do fatorial fracionado <span class="math inline">\(2^{3-1}\)</span> este planejamento é dito de resolução III. Um fatorial fracionado de resolução III não é considerado de boa resolução, uma vez que os efeitos principais estão confundidos com as interações de segunda ordem, sendo a interpretação dos efeitos de baixa ordem imprecindível considerando os objetivos do planejamento fatorial.</p>
<p>Um modelo de regressão do fatorial fracionado <span class="math inline">\(2^{3-1}\)</span> pode ser escrito conforme <a href="07-rsm.html#eq-regfrac" class="quarto-xref">Equação&nbsp;<span>7.3</span></a>. Pode-se observar que não há certeza em relação aos coeficientes, dado o confundimento na estimativa destes. Entretanto, deve-se priorizar os efeitos de menor ordem na interpretação, dado o princípio da hierarquia dos efeitos.</p>
<p><span id="eq-regfrac"><span class="math display">\[
\hat{y}=(\beta_0+\beta_{123}) + (\beta_1+\beta_{23})x_1 + (\beta_2+\beta_{13})x_2 + (\beta_3+\beta_{12})x_3
\tag{6.6}\]</span></span></p>
<div id="exm-frac241" class="theorem example">
<p><span class="theorem-title"><strong>Exemplo 6.4</strong></span> Um planejamento fatorial fracionado <span class="math inline">\(2^{4-1}\)</span> foi utilizado para estudar o processo de metalurgia do pó para fabricação de uma liga biodegradável de Mg−Zn. Foram estudados os efeitos de quatro fatores: o tempo de moagem (2 - 10h), a velocidade de moagem (100 - 300rev/min), a razão mássica bola/pó (5:1 - 15:1) e o teor de Zn (3 - 10%). A resposta estudada foi o módulo de elasticidade em GPa. A <a href="#tbl-fracmetpo" class="quarto-xref">Tabela&nbsp;<span>6.6</span></a> apresenta o planejamento com a resposta.</p>
</div>
<div class="cell">
<div id="tbl-fracmetpo" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-fracmetpo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;6.6: Planejamento fatorial fracionado 2<sup>4-1</sup>, metalurgia do pó da liga de Mg-Zn
</figcaption>
<div aria-describedby="tbl-fracmetpo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">ordem</th>
<th style="text-align: right;">x1</th>
<th style="text-align: right;">x2</th>
<th style="text-align: right;">x3</th>
<th style="text-align: right;">x4=x1x2x3</th>
<th style="text-align: right;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">41,83</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">45,24</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">47,88</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">44,16</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">46,47</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">40,18</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">43,79</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">45,38</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Para gerar este planejamento no R, pode-se utilizar o pacote <code>FrF2</code> com o código à seguir. Ao exibir o planejamento com o comando <code>summary(plan_mgzn)</code>, o analista obtém o planejamento, suas características e a estrutura de confundimento (<em>alias structure</em>). Entretanto, como o padrão deste pacote é a análise do modelo linear com interações de até segunda ordem, a estrutura de confundimento exibida só apresenta os confundimentos dos termos de até segunda ordem.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Planejamento</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>plan_mgzn <span class="ot">&lt;-</span> <span class="fu">FrF2</span>(<span class="at">nruns =</span> <span class="dv">8</span>,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nfactors =</span> <span class="dv">4</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">factor.names =</span> <span class="fu">list</span>(<span class="at">x1=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">10</span>),</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">x2=</span><span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">300</span>),</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">x3=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">15</span>),</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">x4=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">10</span>)),</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">randomize =</span> F)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Módulo de elasticidade</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">41.83</span>, <span class="fl">45.24</span>, <span class="fl">47.88</span>, <span class="fl">44.16</span>, <span class="fl">46.47</span>, <span class="fl">40.18</span>, <span class="fl">43.79</span>, <span class="fl">45.38</span>)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Adicionando resposta ao planejamento</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>plan_mgzn <span class="ot">&lt;-</span> <span class="fu">add.response</span>(plan_mgzn,y)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibindo o planejamento</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(plan_mgzn)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
FrF2(nruns = 8, nfactors = 4, factor.names = list(x1 = c(2, 10), 
    x2 = c(100, 300), x3 = c(5, 15), x4 = c(3, 10)), randomize = F)

Experimental design of type  FrF2 
8  runs

Factor settings (scale ends):
  x1  x2 x3 x4
1  2 100  5  3
2 10 300 15 10

Responses:
[1] y

Design generating information:
$legend
[1] A=x1 B=x2 C=x3 D=x4

$generators
[1] D=ABC


Alias structure:
$fi2
[1] AB=CD AC=BD AD=BC


The design itself:
  x1  x2 x3 x4     y
1  2 100  5  3 41,83
2 10 100  5 10 45,24
3  2 300  5 10 47,88
4 10 300  5  3 44,16
5  2 100 15 10 46,47
6 10 100 15  3 40,18
7  2 300 15  3 43,79
8 10 300 15 10 45,38
class=design, type= FrF2 </code></pre>
</div>
</div>
<p>Para obter a estrutura de confundimento completa utilizando o pacote <code>FrF2</code> deve-se utilizar o comando <code>aliases</code>, com o modelo de interesse, conforme segue. Pelos resultados, pode-se constatar que os termos principais estão confundidos com as interações de terceira ordem, enquanto as interações de segunda ordem estão confundidas entre si. Este planejamento tem resolução IV. O maior problema neste planejamento reside na dificuldade de interpretar as interações de segunda ordem.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estrutura de confundimento com termos de até quarta ordem</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aliases</span>(<span class="fu">lm</span>(y <span class="sc">~</span> (.)<span class="sc">^</span><span class="dv">4</span>, <span class="at">data =</span> plan_mgzn))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              
 x1 = x2:x3:x4
 x2 = x1:x3:x4
 x3 = x1:x2:x4
 x4 = x1:x2:x3
 x1:x2 = x3:x4
 x1:x3 = x2:x4
 x1:x4 = x2:x3</code></pre>
</div>
</div>
<p>Após criar o planejamento pode-se proceder com a análise. Pode-se observar que, ao se obter o modelo de segunda ordem, algumas das interações não são exibidas. Isto ocorre pois, além de não haver graus de liberdade suficiente para estimá-las, deve-se lembrar que estas interações estão confundidas. Deste modo, quando o analista interpreta o efeito da interação <span class="math inline">\(x_1x_2\)</span>, ele deve ter em mente que neste efeito consta também a interação <span class="math inline">\(x_3x_4\)</span>, ou seja, a magnitude do efeito é na verdade o confundimento destes dois efeitos <span class="math inline">\(x_1x_2+x_3x_4\)</span>. O mesmo ocorre para as demais interações de segunda ordem. As interações de terceira ordem, apesar de serem menos importantes estão confundidas com os efeitos de primeira ordem. Entretanto, neste caso, a interpretação deve priorizar os efeitos principais, dado o princípio da hierarquia dos efeitos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo "completo"</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(plan_mgzn)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm1)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of observations used: 8 
Formula:
y ~ (x1 + x2 + x3 + x4)^2

Call:
lm.default(formula = fo, data = model.frame(fo, data = formula))

Residuals:
ALL 8 residuals are 0: no residual degrees of freedom!

Coefficients: (3 not defined because of singularities)
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 44,36625        NaN     NaN      NaN
x11         -0,62625        NaN     NaN      NaN
x21          0,93625        NaN     NaN      NaN
x31         -0,41125        NaN     NaN      NaN
x41          1,87625        NaN     NaN      NaN
x11:x21      0,09375        NaN     NaN      NaN
x11:x31     -0,54875        NaN     NaN      NaN
x11:x41     -0,30625        NaN     NaN      NaN
x21:x31           NA         NA      NA       NA
x21:x41           NA         NA      NA       NA
x31:x41           NA         NA      NA       NA

Residual standard error: NaN on 0 degrees of freedom
Multiple R-squared:      1, Adjusted R-squared:    NaN 
F-statistic:   NaN on 7 and 0 DF,  p-value: NA</code></pre>
</div>
</div>
<p>Ao observar os efeitos, pode-se optar por reduzir o modelo, retirando uma interação com menor magnitude para estimar o erro experimental. Isto pode ser feito utilizando o comando <code>lm</code> base do R, conforme segue. Procedendo desta forma é possível estimar o erro experimental e testar a significância dos efeitos. Neste caso apenas o efeito de <span class="math inline">\(x_4\)</span> foi estatísticamente significativo com <span class="math inline">\(\alpha = 0,05\)</span> de significância. O modelo explica uma proporção de 0,9895 da variabilidade dos dados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo com apenas duas interações</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span>x1 <span class="sc">+</span>x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4 <span class="sc">+</span> x1<span class="sc">:</span>x3 <span class="sc">+</span> x2<span class="sc">:</span>x3,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>            plan_mgzn)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm.default(formula = y ~ x1 + x2 + x3 + x4 + x1:x3 + x2:x3, data = plan_mgzn)

Residuals:
       1        2        3        4        5        6        7        8 
 0,09375 -0,09375 -0,09375  0,09375  0,09375 -0,09375 -0,09375  0,09375 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept) 44,36625    0,09375 473,240  0,00135 **
x11         -0,62625    0,09375  -6,680  0,09460 . 
x21          0,93625    0,09375   9,987  0,06354 . 
x31         -0,41125    0,09375  -4,387  0,14269   
x41          1,87625    0,09375  20,013  0,03178 * 
x11:x31     -0,54875    0,09375  -5,853  0,10772   
x21:x31     -0,30625    0,09375  -3,267  0,18912   
---
Signif. codes:  0 '***' 0,001 '**' 0,01 '*' 0,05 '.' 0,1 ' ' 1

Residual standard error: 0,2652 on 1 degrees of freedom
Multiple R-squared:  0,9984,    Adjusted R-squared:  0,9885 
F-statistic: 101,5 on 6 and 1 DF,  p-value: 0,07583</code></pre>
</div>
</div>
<p>A <a href="#fig-summfrac" class="quarto-xref">Figura&nbsp;<span>6.13</span></a> resume algumas possibilidades para o planejamento fatorial fracionado <span class="math inline">\(2^{k-p}\)</span>. Pode-se observar a resolução do planejamento e os geradores para cada caso. Recomenda-se sempre que possível utilizar planejamentos de resolução V ou superior. Um planejamento de resolução V tem os efeitos principais confundidos com as interações de quarta ordem e as interações de segunda ordem confundidas com as interações de terceira ordem, sendo este tipo de confundimento menos prejudicial.</p>
<div class="cell" data-tbl-cap="Estrtura de confundimento nos fatoriais fracionados $2^{k-p}$">
<div class="cell-output-display">
<div id="fig-summfrac" class="quarto-float quarto-figure quarto-figure-center anchored" height="4in" width="3.5in">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-summfrac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/tabfrac.png" id="fig-summfrac" style="width:3.5in;height:4in" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-summfrac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.13
</figcaption>
</figure>
</div>
</div>
</div>
<p>Utilizando o pacote <code>FrF2</code> é possível gerar um planejamento fatorial fracionado <span class="math inline">\(2^{k-p}\)</span>, definindo o gerador do planejamento. Observando a <a href="#fig-summfrac" class="quarto-xref">Figura&nbsp;<span>6.13</span></a> seja o planejamento <span class="math inline">\(2^{5-1}\)</span> considerando que o analista deseja analisar 5 fatores, mas só tem recursos para 16 ensaios. Este planejamento tem resolução V. Caso o analista queira utilizar a fração alternativa, ele deve considerar o gerador E = -ABCD, colocando o argumento <code>gen = "-ABCD"</code>, conforme segue.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Planejamento 2^(5-1) com fração alternativa</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>planv <span class="ot">&lt;-</span> <span class="fu">FrF2</span>(<span class="at">nruns =</span> <span class="dv">16</span>,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">nfactors =</span> <span class="dv">5</span>, </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">gen =</span> <span class="st">"-ABCD"</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(planv)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
FrF2(nruns = 16, nfactors = 5, gen = "-ABCD")

Experimental design of type  FrF2.generators 
16  runs

Factor settings (scale ends):
   A  B  C  D  E
1 -1 -1 -1 -1 -1
2  1  1  1  1  1

Design generating information:
$legend
[1] A=A B=B C=C D=D E=E

$generators
[1] E=-ABCD


Alias structure:
[[1]]
[1] no aliasing among main effects and 2fis


The design itself:
    A  B  C  D  E
1   1 -1  1  1  1
2  -1  1  1  1  1
3   1  1  1  1 -1
4   1  1 -1  1  1
5  -1 -1 -1  1  1
6  -1  1  1 -1 -1
7  -1  1 -1 -1  1
8   1 -1 -1  1 -1
9  -1 -1  1  1 -1
10  1  1 -1 -1 -1
11 -1 -1  1 -1  1
12  1  1  1 -1  1
13 -1  1 -1  1 -1
14 -1 -1 -1 -1 -1
15  1 -1 -1 -1  1
16  1 -1  1 -1 -1
class=design, type= FrF2.generators </code></pre>
</div>
</div>
<p>Pelos resultados pode-se observar que não há confundimento entre os efeitos principais e as interações de segunda ordem. Caso o analista deseje entender toda a estrutura de confundimento, deve-se utilizar o comando <code>aliases</code> conforme sintaxe abaixo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gerando coluna resposta aleatória </span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co"># apenas para ver confundimento</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">16</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>planv<span class="sc">$</span>y <span class="ot">&lt;-</span> y</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Estrutura de confundimento completa</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="fu">aliases</span>(<span class="fu">lm</span>(y <span class="sc">~</span> (.)<span class="sc">^</span><span class="dv">5</span>, <span class="at">data =</span> planv))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             
 A = -B:C:D:E
 B = -A:C:D:E
 C = -A:B:D:E
 D = -A:B:C:E
 E = -A:B:C:D
 A:B = -C:D:E
 A:C = -B:D:E
 A:D = -B:C:E
 A:E = -B:C:D
 B:C = -A:D:E
 B:D = -A:C:E
 B:E = -A:C:D
 C:D = -A:B:E
 C:E = -A:B:D
 D:E = -A:B:C</code></pre>
</div>
</div>
</section>
<section id="bibliografia" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="bibliografia">Bibliografia</h2>
<p>BOX, G. E. P.; HUNTER, J. Stuart. The 2 k—p Fractional Factorial Designs Part I. <em>Technometrics</em>, v. 42, n.&nbsp;1, p.&nbsp;28-47, 2000.</p>
<p>BOX, George EP; HUNTER, J. S. The 2 k—p Fractional Factorial Designs Part II. <em>Technometrics</em>, v. 3, n.&nbsp;4, p.&nbsp;449-458, 1961.</p>
<p>CHENG, Shao Wei; WU, CF J. Choice of optimal blocking schemes in two-level and three-level designs. <em>Technometrics</em>, v. 44, n.&nbsp;3, p.&nbsp;269-277, 2002.</p>
<p>DANIEL, Cuthbert. Use of half-normal plots in interpreting factorial two-level experiments. <em>Technometrics</em>, v. 1, n.&nbsp;4, p.&nbsp;311-341, 1959.</p>
<p>FISHER, Ronald A. The theory of confounding in factorial experiments in relation to the theory of groups. <em>Annals of Eugenics</em>, v. 11, n.&nbsp;1, p.&nbsp;341-353, 1941.</p>
<p>LENTH, Russell V. Quick and easy analysis of unreplicated factorials. <em>Technometrics</em>, v. 31, n.&nbsp;4, p.&nbsp;469-473, 1989.</p>
<p>SALLEH, Emee Marina; ZUHAILAWATI, Hussain; RAMAKRISHNAN, Sivakumar. Synthesis of biodegradable Mg-Zn alloy by mechanical alloying: Statistical prediction of elastic modulus and mass loss using fractional factorial design. <em>Transactions of Nonferrous Metals Society of China</em>, v. 28, n.&nbsp;4, p.&nbsp;687-699, 2018.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./05-fat2k.html" class="pagination-link" aria-label="Fatorial de dois níveis replicado">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fatorial de dois níveis replicado</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./07-rsm.html" class="pagination-link" aria-label="Metodologia de Superfície de Resposta">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Metodologia de Superfície de Resposta</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>